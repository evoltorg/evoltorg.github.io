---
layout: post
permalink: node/33857
---
<h2>Text Highlighting</h2>\n<p>Websites like google.com have the ability to highlight text on any page based on a search item.<p>\n<p>Previous experiments by <a href="/user/Junglee/20519/index.html" title="Member info">Ashok Hariharan (Junglee)</a> in his article <a href="/article/DHTML_Text_Marker_An_Experiment/17/29028/index.html">DHTML Text Marker An Experiment.</a> were brought to my attention when I found a way of doing just this, using PHP.\n<p>Read on to learn how to highlight any text on a page using a simple PHP script.\n<h2>The Function</h2>\n<p>\nThe following code has come straight off the php.net online manual. The <B>ob_start()</B> function. Basically what it does is buffer any/all page output until you say <B>ob_end_flush();</B> .. and then it outputs the whole page.\n<p>In this example a function called <b>callback</b> has been created, which searches through the entire output, and replaces the word 'apples' with 'oranges'. The 'callback' function is called when ob_end_flush() is initialised. e.g. <b>ob_end_flush("callback");</b>.\n<p>The code is like so:<br></p><p><pre><?php\nfunction callback($buffer) {</p><p>// replace all the apples with oranges\n  return (ereg_replace("apples", "oranges", $buffer));</p><p>}</p><p>ob_start("callback");</p><p>?></p><p><html>\n<body>\n<p>It's like comparing apples to oranges.\n</body>\n</html></p><p><?php</p><p>ob_end_flush();\n?></pre>\n<p>All the output is buffered. Each time an output is detected, it is run through the callback function, which replaces all occurances of 'apples', with 'oranges'.\n<p>At the end of the script, <B>ob_end_flush();</b> outputs the filtered buffer contents.</p><p>\n<h2>Creating Useful Code</h2>\n<p>We want to search through a document, and highlight a specified search item.<br>We already have a search and replace function above. To highlight a word we simply surround the text with a &lt;span class="highlight"&gt; tag. <p>Firstly we need to set up the CSS class:\n<p><code>.highlight {\n<ul>\nbackground: #44AA44<br>\ncolor: white;\n</ul>\n}</code>\n<p>Next the code is altered to search for a specified search criteria, and  when found. surround this text with the &lt;span class="highlight"&gt; tag.<br>\nThe search criteria used is a variable called <code>$searchItem</code>.<br>\nFor the 'callback' function to work <code>$searchItem</code> <i>must</i> be set.<br>\n<b>NB:</b> The line: <code>global $searchItem;</code> - . If you don't know, please see <a href="http://www.php.net/manual/en/language.variables.scope.php">PHP variable scope</a> for details.\n<p>The altered code follows:<br>\n<pre><?php\nif(!isset($searchItem)) { $searchItem = "randomstringset"; }\nfunction callback($buffer) {</p><p>global $searchItem;\n// surround search item items with highlight class\nreturn (ereg_replace($searchItem, "<span class='highlight'>$searchItem</span>", $buffer));</p><p>}</p><p>ob_start("callback");</p><p>?></p><p><html>\n<style>\n.highlight { \n	background: #44AA44;\n	color: white;\n} \n</style>\n<body>\n<p>It's like comparing bannanas to oranges to apples to peaches.\n</body>\n</html></p><p><?php</p><p>ob_end_flush();\n?></pre></p><p><h2>Operator's Guide</h2>\n<p>Now if you send $searchItem=oranges to the script, the word 'oranges' will be highlighted.<br>\ne.g. URL <code>highlight.php?searchItem=oranges</code>\n<p>If you've got PHP, go on.. try it!<br>\nAlso try changing the search item from oranges, to apples, to peaches. etc. and see how it highlights the different words.</p><p><h2>Extending the script</h2>\n<p>Thats the basic principle.. however, you may like to do a improved matching filter, e.g. oranges aren't the same as Oranges.. and maybe the user would prefer orange and Orange and Oranges to be highlighted.<p> Also, theres a small snag, if someone searches for 'p', it messes up the code a tad.</p><p><h2>Comments</h2>\n<p> Please try out the script, and comment on any successes / added features below. If you can think of any <i>faster / better</i> ways of doing this search / replace then please post.</p><p><h2>Reference </h2>\n<p>And for your reference:\n<p>Previous experiments by <a href="/user/Junglee/20519/index.html" title="Member info">Ashok Hariharan (Junglee)</a> in his article <a href="/article/DHTML_Text_Marker_An_Experiment/17/29028/index.html">DHTML Text Marker An Experiment.</a> - A semi inspiration to write this article.\n<p><a href="http://www.php.net">www.php.net</a> - Still the best source for PHP documentation.\n<p><a href="http://www.php.net/manual/en/function.ob-start.php">PHP Function ob_start()</a> - The all important 'buffer output' command.\n<p><a href="http://www.php.net/manual/en/language.variables.scope.php">PHP variable scope</a> - A useful page about variable scope, variables inside functions, and things which aren't obvious to the newer programmer.