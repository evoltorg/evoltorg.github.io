---
layout: post
permalink: node/33857
ratings: 2
avgrate: 4.0000
categories: [Backend]
user: Markavian
real_name: "Markis Brachel"
user_biog: "This author likes building websites, playing around with images, and making things that do something.<br>
Style and functionality are what matter. Make it do something, make it look good, and you\'re on to a winner.
<hr>
- Markavian"
user_since: 08 Jul 2002
avatar: /images/pictures/picture-32816.gif
article_count: 1
excerpt: "A server side PHP version of the DHTML Text Maker (an Experiment). The server side solution to highlighting  user specified search text. (Like google)."
---
<h2>Text Highlighting</h2></p><p>Websites like google.com have the ability to highlight text on any page based on a search item.<p></p><p>Previous experiments by <a href="/user/Junglee/20519/index.html" title="Member info">Ashok Hariharan (Junglee)</a> in his article <a href="/article/DHTML_Text_Marker_An_Experiment/17/29028/index.html">DHTML Text Marker An Experiment.</a> were brought to my attention when I found a way of doing just this, using PHP.</p><p>Read on to learn how to highlight any text on a page using a simple PHP script.</p><h2>The Function</h2></p><p></p>The following code has come straight off the php.net online manual. The <B>ob_start()</B> function. Basically what it does is buffer any/all page output until you say <B>ob_end_flush();</B> .. and then it outputs the whole page.</p><p>In this example a function called <b>callback</b> has been created, which searches through the entire output, and replaces the word 'apples' with 'oranges'. The 'callback' function is called when ob_end_flush() is initialised. e.g. <b>ob_end_flush("callback");</b>.</p><p>The code is like so:<br></p><p><pre></p><p><html></p><body></p><p>It's like comparing apples to oranges.</p></body></p></html></p><p></pre></p><p>All the output is buffered. Each time an output is detected, it is run through the callback function, which replaces all occurances of 'apples', with 'oranges'.</p><p>At the end of the script, <B>ob_end_flush();</b> outputs the filtered buffer contents.</p><p></p><h2>Creating Useful Code</h2></p><p>We want to search through a document, and highlight a specified search item.<br>We already have a search and replace function above. To highlight a word we simply surround the text with a &lt;span class="highlight"&gt; tag. <p>Firstly we need to set up the CSS class:</p><p><code>.highlight {</p><ul></p>background: #44AA44<br></p>color: white;</p></ul></p>}</code></p><p>Next the code is altered to search for a specified search criteria, and  when found. surround this text with the &lt;span class="highlight"&gt; tag.<br></p>The search criteria used is a variable called <code>$searchItem</code>.<br></p>For the 'callback' function to work <code>$searchItem</code> <i>must</i> be set.<br></p><b>NB:</b> The line: <code>global $searchItem;</code> - . If you don't know, please see <a href="http://www.php.net/manual/en/language.variables.scope.php">PHP variable scope</a> for details.</p><p>The altered code follows:<br></p><pre></p><p><html></p><style></p>.highlight { </p>	background: #44AA44;</p>	color: white;</p>} </p></style></p><body></p><p>It's like comparing bannanas to oranges to apples to peaches.</p></body></p></html></p><p></pre></p><p><h2>Operator's Guide</h2></p><p>Now if you send $searchItem=oranges to the script, the word 'oranges' will be highlighted.<br></p>e.g. URL <code>highlight.php?searchItem=oranges</code></p><p>If you've got PHP, go on.. try it!<br></p>Also try changing the search item from oranges, to apples, to peaches. etc. and see how it highlights the different words.</p><p><h2>Extending the script</h2></p><p>Thats the basic principle.. however, you may like to do a improved matching filter, e.g. oranges aren't the same as Oranges.. and maybe the user would prefer orange and Orange and Oranges to be highlighted.<p> Also, theres a small snag, if someone searches for 'p', it messes up the code a tad.</p><p><h2>Comments</h2></p><p> Please try out the script, and comment on any successes / added features below. If you can think of any <i>faster / better</i> ways of doing this search / replace then please post.</p><p><h2>Reference </h2></p><p>And for your reference:</p><p>Previous experiments by <a href="/user/Junglee/20519/index.html" title="Member info">Ashok Hariharan (Junglee)</a> in his article <a href="/article/DHTML_Text_Marker_An_Experiment/17/29028/index.html">DHTML Text Marker An Experiment.</a> - A semi inspiration to write this article.</p><p><a href="http://www.php.net">www.php.net</a> - Still the best source for PHP documentation.</p><p><a href="http://www.php.net/manual/en/function.ob-start.php">PHP Function ob_start()</a> - The all important 'buffer output' command.</p><p><a href="http://www.php.net/manual/en/language.variables.scope.php">PHP variable scope</a> - A useful page about variable scope, variables inside functions, and things which aren't obvious to the newer programmer.