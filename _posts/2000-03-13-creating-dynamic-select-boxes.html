---
layout: post
permalink: node/1324
---
<h3>Using ColdFusion, JavaScript and WDDX to Create a Dynamic Select Box.</h3>\n<p>\nI will discuss the use of ColdFusion, JavaScript and a new (and increasingly useful)\ntechnology WDDX (Web Distributed Data Exchange <a href="http://www.wddx.org/" target="_new" title="Web Distributed Data Exchange (opens in new window)">wddx.org</a>) \nto create the dynamic select box.\n</p>\n<p>\nI will use the following example to illustrate my point.  My first select box contains\ntwo options: &quot;atlantic&quot; and &quot;central&quot; (these are two divisions within the Eastern \nConference of the NBA).  If the user selects &quot;atlantic&quot; he/she will see only the teams \nthat belong to the Atlantic division.  If the user selects "central" he/she will only \nsee the teams that belong to the Central division.\n</p>\n<p>\nFirst of all, we need information in our database. In this example we are using \nOracle, but you can use any database you feel comfortable with. In this example\nI have set up two tables: \n</p>\n<code>\n<pre></p><p>    Table: atlantic                       Table: central\n    ID     NUMBER                         ID     NUMBER\n    NAME   VARCHAR2(20)                   NAME   VARCHAR2(20)\n    \n        **(You will need to use this to reference the column names!)\n</pre>\n</code>\n<p>    \nNow, we need to include the correct javascript functions. It is really not necessary to \nunderstand how this works, but that you understand what is returned from these functions.\n(The following scripts come with ColdFusion so you can view the functions if you so desire).\n</p>\n<p>\n<pre>&lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;/CFIDE/scripts/wddx.js&quot;&gt;\n&lt;/script&gt;</pre>\n</p>\n<p>\nI will use the following example to illustrate my point.  I have one select box that contains atlantic as one option and central as another option (these are two divisions within the Eastern Conference in the NBA).  If the user selects the atlantic choice, only the teams that are in the atlantic division will be choices in the second select box.  Ditto for the central option.  Now, on with the explanation?\n</p>\n<p>\nNext, we want to query the database?keep track of the names of the queries.\n<code>\n<pre>\n &lt;cfquery name=&quot;atlantic&quot; datasource=&quot;xxxx&quot;&gt;\n        select *\n        from atlantic\n &lt;/cfquery&gt;</p><p> &lt;cfquery name=&quot;central&quot; datasource=&quot;xxxx&quot;&gt;\n        select * \n        from central\n &lt;/cfquery&gt;\n</pre>\n</code>\n</p>\n<p>\nBelow is how we serialize from ColdFusion to Javascript.  Make certain that there \nis not a space between the beginning and ending wddx tags!\n</p>\n<p>\nSerialize the atlantic query:\n</p>\n<p>\n<pre>&lt;cfwddx action=&quot;cfml2js&quot; input=&quot;#atlantic#&quot; toplevelvariable=&quot;jsatlTLV&quot; output=&quot;jsatlantic&quot;&gt;\n&lt;/cfwddx&gt;</pre>\n</p>\n<p>\nSerialize the central query:\n</p>\n<p><pre>&lt;cfwddx action=&quot;cfml2js&quot; input=&quot;#central#&quot; toplevelvariable=&quot;jscentTLV&quot; output=&quot;jscentral&quot;&gt;\n&lt;/cfwddx&gt;</pre></p>\n<p>\nNOTE: Make certain there are no spaces between the beginning and end wddx tags.\n</p>\n<p>\nNow we are going to process the info from the two serializations above.  I put output\ntags here so that it would print out the results of the serialization so that you could\nview the source and see what is actually happening.\n</p>\n<p>\nIn the function populate() you can see what is happening.  It is checking to see what\nwas selected in the first select box (named Eastern).\n</p>\n<p>\nYou can reference these options by using the selectedIndex property.  If the first option \nis selected the selectedIndex would = 0 (it is always n-1).\n</p></p><p><pre>\n&lt;script language= &quot;javascript&quot;&gt; &lt;cfoutput&gt;#jsatlantic# #jscentral# &lt;/cfoutput&gt;\n    function populate()\n    {\n        document.DynamicForm.DynamicSelect.length=0;    //need this to set number of options to zero\n        if (document.DynamicForm.Eastern.selectedIndex == 1)\n        {\n           for (var i=  0;i &lt;  &quot;jsatlTLV.id.length&quot; ;i++) &lt;--no quotes here     \n           {\n               NewOpt =  new Option;    //same as the HTML option &gt; tag \n               NewOpt.value = jsatlTLV.id[i];   //same as option value=[id]&gt;\n               NewOpt.text = jsatlTLV.name[i]; //now we have optionvalue=[id]&gt;[name]\n               document.DynamicForm.DynamicSelect.options[i] =  NewOpt; //put the new option in the select box\n            }\n            document.DynamicForm.DynamicSelect.options[0].selected = true;    //make the first option selected\n        }</p><p>      if (document.DynamicForm.Eastern.selectedIndex == 2)\n      {\n         for (var i=  0;i&lt;  &quot;jscentTLV.id.length&quot;;i++)   &gt;--no quotes here     \n         {\n              NewOpt = new Option;        //same as the HTML option; tag\n              NewOpt.value = jscentTLV.id[i];    //same as option value=[id]\n              NewOpt.text = jscentTLV.name[i]; //now we have optionvalue=[id]&gt;[name]\n              document.DynamicForm.DynamicSelect.options[i] =  NewOpt; //put the new option in the select box\n         }\n         document.DynamicForm.DynamicSelect.options[0].selected = true; //make the first option selected\n      }\n   }\n&lt;/script&gt;\n</pre>