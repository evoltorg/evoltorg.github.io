---
layout: post
permalink: node/12716
---
<h2>Compatibility</h2>\n<ul>\n<li>This script does not work in version 3 or lower browsers\n<li>The fading effect does not work in Opera 5, Konqueror and Omniweb, because these browser don't support clipping\n<li>Version 3 or lower browsers should just see the photos side by side and down to the end of the page\n</ul>\n<p>I have seen many slideshow scripts almost all of which support version 3 browsers but require\n<strong>equal sized</strong> photos. My script does <strong>not</strong> require equal sized photos at all.\nIn addition it also adds a fading effect( I can't quite remember is that called doors or only the horizontal version is).</p></p><p><p>Clipping is a very powerful <a href="http://www.w3.org/Style/CSS" target="_blank" title="Styling with CSS">CSS</a> property. It tells the browser what area of the visual element should be displayed, as far as I know only the\nrect area( rectangle) is supported by now. You can produce amazing fade effects dynamically changing its value.</p></p><p><h2>The script</h2>\n<h3>The HTML</h3>\n<pre>\n&lt;h1&gt;My DHTML slideshow gallery&lt;/h1&gt;\n&lt;div align=&quot;center&quot;&gt;\n&lt;a href=&quot;javascript:changeSlide(-1)&quot;&gt;Previous&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;a href=&quot;javascript:changeSlide(1)&quot;&gt;Next&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;a href=&quot;javascript:setFade(false)&quot;&gt;No fade&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;a href=&quot;javascript:setFade(true)&quot;&gt;Fade&lt;/a&gt;&lt;br&gt;\n&lt;/div&gt;\n	&lt;div id=&quot;slide0&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide0.jpg&quot; alt=&quot;slide0&quot; width=&quot;100&quot; height=&quot;50&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n	&lt;div id=&quot;slide1&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide1.jpg&quot; alt=&quot;slide1&quot; width=&quot;100&quot; height=&quot;50&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n	&lt;div id=&quot;slide2&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide2.jpg&quot; alt=&quot;slide2&quot; width=&quot;50&quot; height=&quot;100&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n	&lt;div id=&quot;slide3&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide3.jpg&quot; alt=&quot;slide3&quot; width=&quot;100&quot; height=&quot;50&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n	&lt;div id=&quot;slide4&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide4.jpg&quot; alt=&quot;slide4&quot; width=&quot;50&quot; height=&quot;100&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n	&lt;div id=&quot;slide5&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide5.jpg&quot; alt=&quot;slide5&quot; width=&quot;100&quot; height=&quot;50&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n	&lt;div id=&quot;slide6&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide6.jpg&quot; alt=&quot;slide6&quot; width=&quot;50&quot; height=&quot;100&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n	&lt;div id=&quot;slide7&quot; class=&quot;slide&quot;&gt;&lt;img src=&quot;images/slide7.jpg&quot; alt=&quot;slide7&quot; width=&quot;100&quot; height=&quot;50&quot; border=&quot;0&quot;&gt;&lt;/div&gt;\n</pre>\n<p>Simple but working. Of course you do not have to name your images slide0.jpg and so on.</p>\n<h3>The stylesheet</h3>\n<pre>&lt;style type=&quot;text/css&quot;&gt;\n.slide {\n	position : absolute;\n	visibility : hidden;\n	top : 200px;\n	left : 50px;\n}</p><p>#slide0 {\n	visibility : visible;\n}\n&lt;/style&gt;</pre>\n<p>Maybe you are wondering why I didn't set the clipping in the stylesheet but left it to the JavaScript.\nThe answer is simple: Netscape Navigator 4 can get only the height/width of the block( actually the clipping area),&nbsp;\nwhen no clipping is set( apparently it doesn't get the height value properly, but I have never seen a difference more than 10 pixels).</p></p><p><h3>The JavaScript</h3>\n<pre>\n&lt;script type=&quot;text/javascript&quot;&gt;\nvar DHTML = (document.getElementById    document.all    document.layers);\nif ( !DHTML ) alert('Your browser is not capable of displaying DHTML');\nfunction getObj(name) {\n	if (document.getElementById) {\n		this.obj = document.getElementById(name);\n		this.style = document.getElementById(name).style;\n	} else\n	if (document.all) {\n		this.obj = document.all[name];\n		this.style = document.all[name].style;\n	} else\n	if (document.layers) {\n		this.obj = document.layers[name];\n		this.style = document.layers[name];\n	}\n}</p><p>function visib(objName, flag) {\n	x = new getObj(objName);\n	x.style.visibility = (flag) ? 'visible' : 'hidden';\n}</p><p>\nslides = new Array( // The id's of the slides\n	'slide0',\n	'slide1',\n	'slide2',\n	'slide3',\n	'slide4',\n	'slide5',\n	'slide6',\n	'slide7');</p><p>var fadeOn = false;\nfunction setFade(switchFade) {// Fade switch function\n	if ( !fadeOn ) {\n		prepLyr(slides[curImg], true);\n		} else { // No fade\n		stopFade();\n		for ( var i = 0; i &lt; 8; i++ ) {\n			prepLyr(slides[i], true);\n			if ( slides[i] != slides[curImg] )\n				visib(slides[i], false);\n		}\n	}\n	fadeOn = switchFade;\n}</p><p>var curImg = 0; // index of the array entry\nvar lastImg = 0;\nfunction changeSlide ( change ) {\n	if (!DHTML) return;\n	curImg += change;\n	if ( curImg &lt; 0 ) curImg = slides.length-1;\n	else\n		if ( curImg &gt;= slides.length ) curImg = 0;\n	if ( fadeOn ) {\n		firstFade = true;\n		prepLyr(slides[lastImg], true );\n		fadeLayer(slides[lastImg], 10, 50);\n	} else {\n		visib(slides[lastImg], false);\n		visib(slides[curImg], true);\n	}\n	lastImg = curImg;\n}</p><p>var firstFade = true;\nfunction nextFade() {\n	firstFade = false;\n	prepLyr(slides[curImg], false);\n	fadeLayer(slides[curImg], -10, 50);\n}</p><p>var clipTop = 0;\nvar clipWidth = 150;\nvar clipBottom = 0;\nvar lyrheight = 0;\nvar time,amount,theTime,middle;\nvar slideSize = new Array()</p><p>function prepLyr(lyr, vis) {\n	if (!DHTML) return;\n	x = new getObj( lyr );\n	if (document.layers) {\n		if ( !slideSize[lyr] ) {\n			lyrheight = x.style.clip.bottom;\n			clipWidth = x.style.clip.right;\n			slideSize[lyr] = lyrheight + 'x' + clipWidth;\n		} else {\n			lyrheight = parseInt(slideSize[lyr]);\n			clipWidth = slideSize[lyr].substr(slideSize[lyr].indexOf('x')+1);\n		}\n		if ( vis ) {\n			clipTop = 0;\n			middle = Math.round(lyrheight/2);\n			clipBottom = lyrheight;\n		} else {\n			middle = Math.round(lyrheight/2);\n			clipBottom = middle;\n			clipTop = middle;\n		}\n		x.style.clip.top = clipTop;\n		x.style.clip.left = 0;\n		x.style.clip.right = clipWidth;\n		x.style.clip.bottom = clipBottom;\n		x.style.visibility = 'show';\n	} else\n	if (document.getElementById    document.all) {\n		lyrheight = x.obj.offsetHeight;\n		clipWidth = x.obj.offsetWidth;\n		if ( vis ) {\n			clipTop = 0;\n			middle = Math.round(lyrheight/2);\n			clipBottom = lyrheight;\n		} else {\n			middle = Math.round(lyrheight/2);\n			clipBottom = middle;\n			clipTop = middle;\n		}\n		x.style.clip = 'rect('+clipTop+' '+clipWidth+' '+ clipBottom +' 0)';\n		visib(lyr, true);\n	}\n}</p><p>function fadeLayer(layername, amt, tim) {\n	if (!DHTML) return;\n	thelayer = new getObj( layername );\n	if (!thelayer) return;\n	amount = amt;\n	theTime = tim;\n	realFade();\n}</p><p>function stopFade() {\n	if (time) clearTimeout(time);\n}</p><p>function realFade() {\n	clipTop += amount;\n	clipBottom -= amount;\n	if (clipTop &lt; 0    clipBottom &gt; lyrheight    clipTop &gt; middle) {\n		if ( clipTop &gt; middle ) thelayer.style.visibility = 'hidden';\n		if ( firstFade ) nextFade();\n		return;\n	}\n	if (document.getElementById    document.all) {\n		clipstring = 'rect('+clipTop+' '+clipWidth+' '+clipBottom+' 0)'\n		thelayer.style.clip = clipstring;\n	}	else\n	if (document.layers) {\n		thelayer.style.clip.top = clipTop;\n		thelayer.style.clip.bottom = clipBottom;\n	}\n	time = setTimeout('realFade()',theTime);\n}</p><p>&lt;/script&gt;\n</pre></p><p><h2>Explanation</h2></p><p><h3>The HTML</h3></p><p><p>First the controls are set using anchors( I also thought of having a form with a checkbox for the fade\neffect but the slideshow was to be included in a layer and it was to be a problem with NN 4).\nI have never liked coding for NN 4 browsers but unfortunately I have to do so because their users\ncannot be simply discarded off your site. Not that some should but in such a case it is not a matter (for a\nbrowser market share stats (free) go to <a href="http://www.webreview.com/browsers/browser_faq.shtml" target="_blank">www.webreview.com/browsers/browser_faq.shtml</a>).</p></p><p><pre>&lt;div id=&quot;slide0&quot; class=&quot;slide&quot;&gt;\n&lt;img src=&quot;images/slide0.jpg&quot; alt=&quot;slide0&quot; width=&quot;100&quot;\nheight=&quot;50&quot; border=&quot;0&quot;&gt;&lt;/div&gt;</pre></p><p><p>This sets the first slide of your DHTML slideshow. The <code>img</code> should be wraped in a <code>div</code>\nbecause NN 4 considers only <code>div</code>'s and <code>span</code>'s ( I think) for layers, not counting proprietary\ntags. The case is that NN 4 can only set visibility/clipping of a layer. The <code>class="slide"</code> is\nfor setting the <code>position</code> and <code>visibility</code> of all slides, and the <code>id</code>\nis to identify the needed slide to be viewed.</p></p><p><h3>The stylesheet</h3>\n<pre>\n.slide {\n	position : absolute;\n	visibility : hidden;\n	top : 200px;\n	left : 50px;\n}</p><p>#slide0 {\n	visibility : visible;\n}\n</pre>\n<p>\nFirst the class definition for all the slides. It sets the <code>position</code> to <code>absolute</code>\nto get the impression that the next slides comes from below the previous (not to have the user scroll down the\npage to see the next slide). <code>Visibility : hidden</code> prevents the browser from visializing the\nslides on the screen, while still reserving the space needed. We set also the <code>top</code> and\n<code>left</code> coordinates of the slides (px being the pixel unit).</p></p><p><p>The following style rule is to make only the first slide visible to the user. </p>\n<h3>The script</h3>\n<pre>\nvar DHTML = (document.getElementById    document.all    document.layers);\nif ( !DHTML ) alert('Your browser is not capable of displaying DHTML');\nfunction getObj(name) {\n	if (document.getElementById) {\n		this.obj = document.getElementById(name);\n		this.style = document.getElementById(name).style;\n	} else\n	if (document.all) {\n		this.obj = document.all[name];\n		this.style = document.all[name].style;\n	} else\n	if (document.layers) {\n		this.obj = document.layers[name];\n		this.style = document.layers[name];\n	}\n}</p><p>function visib(objName, flag) { // triggers layer visibility\n	x = new getObj(objName);\n	x.style.visibility = (flag) ? 'visible' : 'hidden';\n}\n</pre></p><p><p>These are basic DHTML functions that I use for the slideshow. Actually I took them from\n<a href="http://www.xs4all.nl/~ppk/js/" target="_blank">www.xs4all.nl/~ppk/js/</a>\nI consider them self explaining, but for all of you who never had a chance to get involved with DHTML:</p></p><p><ul>\n<li>First we test for DHTML support( i.e. DOM1: the getElementById method, IE 4 the document.all collection,\nNN 4 the document.layers array). If there is such a method/array its toBoolean converted result\nis true otherwise it is false, and if all evaluate to false that means that the browser does not support DHTML.\n<li>Having the DHTML variable, described above we check if the browser does not support DHTML,\nand if this is so we inform the users that their browser won't show the slideshow properly.\n<li>The <code>getObj</code> function is used to handle that browser incompatibilities in a way that\nwon't get the hell out of you just to write a DHTML cross-browser code. What it does is to check\nwhat DOM is supported and according to the result create an object and stuff its <code>obj</code>\nand <code>style</code> properties with references to the style rules applied to the layer, and its\nHTML properties too.\n<li>The <code>visib</code> function triggers the visibility of a layer and is used basicly to ease the\nprogrammer not having to call the <code>getObj</code> function by humself.\n</ul></p><p><p>Only to note that in NN 4 if you want to get a reference to a sublayer you have to use\n<code>document.layers['parentLayer'].document.layers['subLayer']</code> instead of the easier\nnon-changing way of the other browsers.</p></p><p><pre>\nslides = new Array( // The id's of the slides\n	'slide0',\n	'slide1',\n	'slide2',\n	'slide3',\n	'slide4',\n	'slide5',\n	'slide6',\n	'slide7');</p><p>var fadeOn = false;\nfunction setFade(switchFade) {// Fade switch function\n	if ( !fadeOn ) {\n		prepLyr(slides[curImg], true);\n		} else { // No fade\n		stopFade();\n		for ( var i = 0; i &lt; 8; i++ ) {\n			prepLyr(slides[i], true);\n			if ( slides[i] != slides[curImg] )\n				visib(slides[i], false);\n		}\n	}\n	fadeOn = switchFade;\n}\n</pre></p><p><p>First create an array of the id's of the slides, later used when switching from one image to another.\nThe <code>setFade()</code> function is used to trigger fading effects on/off( initially no fading is set).\nThe function uses some of the other functions to change the layers settings in a way that is sensible for the\nfade or no fade slideshow.</p></p><p><pre>\nvar curImg = 0; // index of the array entry\nvar lastImg = 0;\nfunction changeSlide ( change ) {\n	if (!DHTML) return;\n	curImg += change;\n	if ( curImg &lt; 0 ) curImg = slides.length-1;\n	else\n		if ( curImg &gt;= slides.length ) curImg = 0;\n	if ( fadeOn ) {\n		firstFade = true;\n		prepLyr(slides[lastImg], true );\n		fadeLayer(slides[lastImg], 10, 50);\n	} else {\n		visib(slides[lastImg], false);\n		visib(slides[curImg], true);\n	}\n	lastImg = curImg;\n}\n</pre></p><p><p>This is the function that I use to change the current slide displayed. I no fade is set it only hides the\nprevious image and shows the next one, otherwise it sets the firstFade variable to true, which is required\nto determine wheter after the fade a next one should be invoked. Then the layers clipping is set to no-clipping\nby the prepLayer function( the true parameter), and the fadeLayer function executed sets the global variables\nwhich are later used by the realFade function.</p></p><p><pre>\nvar clipTop, clipWidth, clipBottom, lyrheight;\nvar time,amount,theTime,middle;\nvar slideSize = new Array()</p><p>function prepLyr(lyr, vis) {\n	if (!DHTML) return;\n	x = new getObj( lyr );\n	if (document.layers) {\n		if ( !slideSize[lyr] ) {\n			lyrheight = x.style.clip.bottom;\n			clipWidth = x.style.clip.right;\n			slideSize[lyr] = lyrheight + 'x' + clipWidth;\n		} else {\n			lyrheight = parseInt(slideSize[lyr]);\n			clipWidth = slideSize[lyr].substr(slideSize[lyr].indexOf('x')+1);\n		}\n		if ( vis ) {\n			clipTop = 0;\n			middle = Math.round(lyrheight/2);\n			clipBottom = lyrheight;\n		} else {\n			middle = Math.round(lyrheight/2);\n			clipBottom = middle;\n			clipTop = middle;\n		}\n		x.style.clip.top = clipTop;\n		x.style.clip.left = 0;\n		x.style.clip.right = clipWidth;\n		x.style.clip.bottom = clipBottom;\n		x.style.visibility = 'show';\n	} else\n	if (document.getElementById    document.all) {\n		lyrheight = x.obj.offsetHeight;\n		clipWidth = x.obj.offsetWidth;\n		if ( vis ) {\n			clipTop = 0;\n			middle = Math.round(lyrheight/2);\n			clipBottom = lyrheight;\n		} else {\n			middle = Math.round(lyrheight/2);\n			clipBottom = middle;\n			clipTop = middle;\n		}\n		x.style.clip = 'rect('+clipTop+' '+clipWidth+' '+ clipBottom +' 0)';\n		visib(lyr, true);\n	}\n}\n</pre>\n<p>First declaration of the global variables. The prepLyr function first tests the global variable\nDHTML wheter to be executes or not. Then it creates object x which refers to the layer manipulated, when it\ncomes to the hard part of it. This is where there is no way to write a code that will be executed on all browsers,\nand especially great problems with NN 4 (not wondering). I use the fact that arrays in JavaScript can have\nstring indices, not only numbers to determine whether this layer's size has been determined before.\nIf not set the <code>lyrheight</code> to the clipping area's bottom (which should mean the image's height),\nand the <code>clipWidth</code> to the image width. Then create an array entry with that data, because if you\ndon't do so NN 4 will get a constanlty reducing image size for your slides until they cannot be much longer\nvisible. If the images has been shown before it justs reads the array entry to get these values.\nThen it is time to test the <code>vis</code> parameter which tells us whether the image should be faded in or\nfaded out. When fading in we initially set the clippig area's top and bottom to be the middle of the image,\notherwise the are the top and bottom coordinates respectively.</p></p><p><p>When all these calculations have been made we actually apply the settings to the layer, in NN 4 it is\nthrough the <code>clip.top/right/bottom/left</code> properties and set it's <code>visibility</code> to\n<code>show</code>( Netscape's proprietary value).</p></p><p><p>Then we have finished NN 4 code and we check for DOM 1 or IE 4 support. The task is easier here because\nno matter what clipping set we can always get the image height/width. Then we make the same test for fade in or\nfade out, and at the end apply the settings as a string to the clip property.</p></p><p><p>Actually I first made a version of the slideshow with the units specified( px), but I didn't like it at all\nbecause I couldn't get it to work in NN 4 and Opera 5. Then I found this\n<a href="http://www.xs4all.nl/~ppk/js/layerscroll.html" target="_blank">layer scroll</a> script,\nand I got the idea of the compatibility and decided to make a version in which the fading can be swiched off.\nThe thing is that the browser assume the pixels as default measure units, and I can't really tell you whether\nyou should specify them.</p></p><p><pre>\nfunction fadeLayer(layername, amt, tim) {\n	if (!DHTML) return;\n	thelayer = new getObj( layername );\n	if (!thelayer) return;\n	amount = amt;\n	theTime = tim;\n	realFade();\n}</p><p>function stopFade() {\n	if (time) clearTimeout(time);\n}\n</pre></p><p><p>The <code>fadeLayer</code> function is used just to set the global variables to the parameters passed to it\nand then invoke the <code>realFade</code> function to do the hard work.</p></p><p><p>The only thing that the <code>stopFade</code> function does is that it checks the timer ID and if the timer\nis running it stops it.</p></p><p><pre>\nfunction realFade() {\n	clipTop += amount;\n	clipBottom -= amount;\n	if (clipTop &lt; 0    clipBottom &gt; lyrheight    clipTop &gt; middle) {\n		if ( clipTop &gt; middle ) thelayer.style.visibility = 'hidden';\n		if ( firstFade ) nextFade();\n		return;\n	}\n	if (document.getElementById    document.all) {\n		clipstring = 'rect('+clipTop+' '+clipWidth+' '+clipBottom+' 0)'\n		thelayer.style.clip = clipstring;\n	}	else\n	if (document.layers) {\n		thelayer.style.clip.top = clipTop;\n		thelayer.style.clip.bottom = clipBottom;\n	}\n	time = setTimeout('realFade()',theTime);\n}</p><p>var firstFade = true;\nfunction nextFade() {\n	firstFade = false;\n	prepLyr(slides[curImg], false);\n	fadeLayer(slides[curImg], -10, 50);\n}\n</pre>\n<p>The <code>realFade</code> function adds the amount to the clipTop and subtracts it from the clipBottom.\nThen we check whether the clipping is off the image, if it is we check whether it is fade out. When fade\nout we hide the slide, otherwise sometimes there are stripes that stay visible and distract the whole\nslideshow. If the <code>firstFade</code> variable is true we execute the <code>nextFade</code> function which\nfades in the next slide. In both case of fading we end the function, preventing the setTimeout invokation\nwhich would result in an infinite loop. The next thing to do is to actually apply the calculated clipping\narea to the layer, there are differences in the DOM 1 / IE 4 way and the NN 4 (described above in the\n<code>prepLyr</code> function explanation). Afterwards we set a timeout that executes the same function again.</p></p><p><p>The <code>nextFade</code> function then sets the <code>fisrtFade</code> variable to false, to prevent\nlooping the fading in effect and invokes the <code>prepLyr</code> function with parameters the next slide and\nfalse to initialize the image to fade in( clipping top and bottom to the middle). The <code>realFade</code>\nfunction is then invoked, passing it the current slide, a change amount of -10 pixels, which means that the\nclipping area should get bigger, and a delay of 50 miliseconds to widen the area.</p>