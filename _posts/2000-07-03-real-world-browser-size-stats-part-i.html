---
layout: post
permalink: node/2295
---
<p>\nEverybody has their own take on what resolution their users have.  Sometimes that target resolution is based on hard data, sometimes it's a best-guess, and sometimes it's just based on the designer's own personal preferences.\n</p></p><p><p>\nOne thing this ignores, however, is the <strong>window</strong> size of the user.  Not all users at 1,024 x 768 resolution surf at full screen, so designing a page at 1,000 pixels wide would not be a good idea.  Some of you may recall my article "<a href="http://www.evolt.org/article/640_x_480_Isn_t_Dead_Just_Yet/22/275/index.html" title="evolt.org Article">640 x 480 Isn't Dead Just Yet</a>."  This article offers a way to determine if that's true for your site.\n</p></p><p><p>\nInstead of just guessing what resolution users of my company's site have, I decided to test it for myself.  In addition, I wanted to know each user's window size and each user's bit-depth.  This article will describe my methods.  In <a href="http://www.evolt.org/article/Real_World_Browser_Size_Stats_Part_II/20/2297/index.html" title="Part 2, duh">Part 2</a>, I'll discuss my results.\n</p></p><p><h2>The Methodology</h2></p><p><p>\nIn order to capture the screen resolution, browser size, and bit-depth, you have to use client-side script.  Unfortunately, both Internet Explorer and Netscape Navigator can report these numbers a bit differently.  Netscape Navigator will tell you the size of the user's screen <em>after</em> it subtracts the Windows Task Bar, as well as the Microsoft Office Bar, or any other tool bars.  This means a screen set to 800 x 600 could report itself to Netscape Navigator as 720 x 560, depending on the tool bars and the user's windows settings for icon and text size.  Internet Explorer will report the full 800 x 600, however.\n</p></p><p><p>\nAlso of note is that the script used to gather this information works only on the 4.x+ browsers.  So you immediately have skewed data in case your site is hit by a lot of 3.x and older browsers.  One could reasonably assume that a 3.x user has a smaller screen resolution and lower bit-depth, but there is no way to verify that using this method.  As such, keep in mind that you are still only capturing data on a sub-set of your visitors, unless you have 100% 4.x users.\n</p></p><p><p>\nFinally, keep in mind that the web is a moving target in general.  The information you collect is really only valid for the time it was collected.  Newer systems and browsers are always coming out, so if you are relying on this information a year from now, you may be doing yourself a dis-service.\n</p></p><p>\n<h3>The Client-Side Script</h3></p><p><p>\nIt is important to know that you cannot write the screen and window information to the server via JavaScript.  To prevent requiring the user to submit a page, and to prevent writing all the data to the URL, I opted to set cookies with the data.  Please note that I attempted to name the cookies close to plain English so users who have cookie warning enabled will know just what I am trying to write to their machine.  By writing to a cookie, the next page the user visits on my site can execute server-side script to pull the values from those cookies and write that data to somewhere on the server.\n</p></p><p><p>\nTo prevent capturing a user's information over and over I coupled this script with my splash page, which already has code to prevent a user from seeing it more than once a month.  You can get information on how to do that from the tutorial, "<a href="http://www.evolt.org/article/Let_the_User_Skip_the_Splash_Page/20/416/index.html" title="evolt.org Article">Let the User Skip the Splash Page</a>."  In this case, I use the ASP (server-side) version, reducing the load on the client to manage the cookie reading and page reloading.  If you do not use any method to capture and write the data once per user, then you will have to manually pull all records with duplicate IP addresses, potentially removing different people from behind one firewall.  Also keep in mind that an AOL user could get recorded many times under multiple IP addresses thanks to AOL's proxy methods.  If the user does not accept cookies, then you have nothing to worry about, you just won't get any data from that user.\n</p></p><p><p>\nBelow is the script I used to capture the information.  I had this script in the <code>&lt;body&gt;</code> tag, after all the content.  You'll note that I am not concerned with the browser window size, but instead with the viewable area within the window.  Every user can have a different combination of browser chrome settings, tool bars, button bars, etc., taking up space.  So, instead of trying to guess who has what tool bars open, I just find the viewable area.\n</p></p><p><pre>&lt;script language=&quot;JavaScript&quot;&gt;&lt;!--\nvar wHeight, wWidth, sHeight, sWidth, bitDepth;</p><p>if (document.all)\n	{	wHeight = document.body.clientHeight;\n		wWidth = document.body.clientWidth;\n		sHeight = screen.height;\n		sWidth = screen.width;\n		bitDepth = screen.colorDepth; }\nelse if (document.layers)\n	{	wHeight = window.innerHeight;\n		wWidth = window.innerWidth;\n		sHeight = screen.height;\n		sWidth = screen.width;\n		bitDepth = screen.colorDepth; }</p><p>document.cookie = &quot;wHeight=&quot; + wHeight + &quot;;&quot;;\ndocument.cookie = &quot;wWidth=&quot; + wWidth + &quot;;&quot;;\ndocument.cookie = &quot;sHeight=&quot; + sHeight + &quot;;&quot;;\ndocument.cookie = &quot;sWidth=&quot; + sWidth + &quot;;&quot;;\ndocument.cookie = &quot;bitDepth=&quot; + bitDepth + &quot;;&quot;;\n// --&gt;\n&lt;/script&gt;</pre></p><p>\n<h3>The Server-Side Script</h3></p><p><p>\nSince our site uses Active Server Pages, the following code is VBScript.  However, it's very basic code, so if you can read cookies, concatenate strings, and write to a file or database on the server in your server-side code, you'll be all set.\n</p></p><p><p>\nYou may wish to modify how I write the data.  In the script below, I write the x-value, the letter 'x', and then the y-value.  You're probably better off not concatenating them, and instead, given my example, using a pipe ( ) instead of an 'x' to create two fields instead of one.  It's hard to crunch numbers that aren't numbers.\n</p></p><p><p>\nYou'll note I also write the date, the time, the browser, and the IP address.  These fields are handy to prevent duplicates, and to see which browsers are giving you trouble with the script.  I also write another cookie just to make sure I don't log a user's information more than once per month - in case that user gets by my splash page script.\n</p></p><p><pre>&lt;%\n'## Screen Resolution Logging</p><p>strBrowser = Request.ServerVariables(&quot;HTTP_USER_AGENT&quot;)\nstrIP = Request.ServerVariables(&quot;REMOTE_ADDR&quot;)\nstrNowTime = FormatDateTime(Now,vbShortTime)\nstrNowDate = FormatDateTime(Now,vbShortDate)</p><p>IF\n NOT Request.Cookies(&quot;ScreenRes&quot;) = &quot;TRUE&quot;\nAND\n NOT Request.Cookies(&quot;bitDepth&quot;) = &quot;&quot;\nTHEN</p><p>	wHeight = Request.Cookies(&quot;wHeight&quot;)\n	wWidth = Request.Cookies(&quot;wWidth&quot;)\n	sHeight = Request.Cookies(&quot;sHeight&quot;)\n	sWidth = Request.Cookies(&quot;sWidth&quot;)\n	bitDepth = Request.Cookies(&quot;bitDepth&quot;)</p><p>	TextRecord = sWidth & &quot;x&quot; & sHeight & &quot; &quot;\n	TextRecord = TextRecord & wWidth & &quot;x&quot; & wHeight & &quot; &quot;\n	TextRecord = TextRecord & bitDepth & &quot;-bit &quot;\n	TextRecord = TextRecord & strNowDate & &quot; &quot;\n	TextRecord = TextRecord & strNowTime& &quot; &quot;\n	TextRecord = TextRecord & strBrowser & &quot; &quot;\n	TextRecord = TextRecord & strIP</p><p>	'## OPEN TEXT FILE\n	Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)\n	Set objNewFile = objFSO.OpenTextFile(&quot;X:/XXX/scrlog.txt&quot;, 8)</p><p>	'## WRITE TO TEXT FILE\n	objNewFile.WriteLine TextRecord</p><p>	'## CLOSE TEXT FILE\n	objNewFile.Close</p><p>'## Cookie Setting</p><p>	'## Adds 1 month onto current date\n	'## so cookie will expire 1 month from now\n	strNowDate = FormatDateTime(Now,vbGeneralDate)\n	NewDate = DateAdd(&quot;w&quot;,1,strNowDate)</p><p>	'## This sets the cookie so that\n	'## the next time the user comes back\n	'## they will skip the splash page\n	Response.Cookies(&quot;ScreenRes&quot;) = &quot;TRUE&quot;\n	Response.Cookies(&quot;ScreenRes&quot;).expires = cdate(NewDate)</p><p>END IF\n%&gt;</pre></p><p>\n<h3>Reporting</h3></p><p><p>\nOnce you have this in place, you can sit back and watch the data roll in.  You should designate a time-frame or target date in advance.  My goal was 1,000 entries, which for our site was three months.  From there it's just a matter of importing the data to a spreadsheet or database and sifting through the data to find the numbers.\n</p></p><p><h3>Results</h3></p><p><p>\nThis article has shown you a method to write your own screen resolution, browser size, and bit-depth tracking.  <a href="http://www.evolt.org/article/Real_World_Browser_Size_Stats_Part_II/20/2297/index.html" title="Part 2">Part 2</a> will show you the results from my site, <a href="http://algonquinstudios.com/" target="_new" title="Algonquin Studios">http://algonquinstudios.com/</a>\n</p>