---
layout: post
permalink: node/2295
ratings: 9
avgrate: 4.3333
category: Code
user: aardvark
real_name: "Adrian Roselli"
user_biog: "<p style=\"text-align:justify;\">
A founder of evolt.org, Adrian Roselli (aardvark) is the Senior Usability Engineer at <a href=\"http://algonquinstudios.com/\" rel=\"nofollow\" target=\"_blank\" title=\"Visit Algonquin Studios - Opens New Window\">Algonquin Studios</a>, located in Buffalo, New York.
</p>

<p style=\"text-align:justify;\">
Adrian has years of experience in graphic design, web design and multimedia design, as well as extensive experience in internet commerce and interface design and usability. He has been developing for the World Wide Web since its inception, and working the design field since 1993.  Adrian is a founding member, board member, and writer to evolt.org. In addition, Adrian  sits on the Digital Media Advisory Committee for a local SUNY college and a local private college, as well as the board for a local charter school.
</p>

<p style=\"text-align:justify;\">
You can see his brand-spanking-new blog at <a href=\"http://blog.adrianroselli.com/\" rel=\"\">http://blog.adrianroselli.com/</a> as well as his new web site to promote his writing and speaking at <a href=\"http://adrianroselli.com/\" rel=\"\">AdrianRoselli.com</a>
</p>

<p style=\"text-align:justify;\">
Adrian authored the usability case study for evolt.org in <a href=\"http://www.amazon.com/exec/obidos/ASIN/1904151035/ref=nosim/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Amazon, for one, is selling it; opens in new window.\"><em>Usability: The Site Speaks for Itself</em></a>, published by glasshaus. He has written three chapters for the book <a href=\"http://www.amazon.com/exec/obidos/ASIN/1590591712/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Amazon, for one, is selling it; opens in new window.\"><em>Professional Web Graphics for Non Designers</em></a>, also published by glasshaus. Adrian also managed to get a couple chapters written (and published) for <a href=\"http://www.amazon.com/exec/obidos/ASIN/159059200X/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Opens in new window.\"><em>The Web Professional\'s Handbook</em></a> before glasshaus went under. They were really quite good. You should have bought more of the books.
</p>"
user_since: 14 Dec 1998
avatar: /images/pictures/picture-88.gif
article_count: 85
excerpt: "Everybody has their own take on what resolution their users have.  Sometimes that target resolution is based on hard data, sometimes it\'s a best-guess, and sometimes it\'s just based on the designer\'s own personal preferences."
---
<p></p>Everybody has their own take on what resolution their users have.  Sometimes that target resolution is based on hard data, sometimes it's a best-guess, and sometimes it's just based on the designer's own personal preferences.</p></p></p><p><p></p>One thing this ignores, however, is the <strong>window</strong> size of the user.  Not all users at 1,024 x 768 resolution surf at full screen, so designing a page at 1,000 pixels wide would not be a good idea.  Some of you may recall my article "<a href="http://www.evolt.org/article/640_x_480_Isn_t_Dead_Just_Yet/22/275/index.html" title="evolt.org Article">640 x 480 Isn't Dead Just Yet</a>."  This article offers a way to determine if that's true for your site.</p></p></p><p><p></p>Instead of just guessing what resolution users of my company's site have, I decided to test it for myself.  In addition, I wanted to know each user's window size and each user's bit-depth.  This article will describe my methods.  In <a href="http://www.evolt.org/article/Real_World_Browser_Size_Stats_Part_II/20/2297/index.html" title="Part 2, duh">Part 2</a>, I'll discuss my results.</p></p></p><p><h2>The Methodology</h2></p><p><p></p>In order to capture the screen resolution, browser size, and bit-depth, you have to use client-side script.  Unfortunately, both Internet Explorer and Netscape Navigator can report these numbers a bit differently.  Netscape Navigator will tell you the size of the user's screen <em>after</em> it subtracts the Windows Task Bar, as well as the Microsoft Office Bar, or any other tool bars.  This means a screen set to 800 x 600 could report itself to Netscape Navigator as 720 x 560, depending on the tool bars and the user's windows settings for icon and text size.  Internet Explorer will report the full 800 x 600, however.</p></p></p><p><p></p>Also of note is that the script used to gather this information works only on the 4.x+ browsers.  So you immediately have skewed data in case your site is hit by a lot of 3.x and older browsers.  One could reasonably assume that a 3.x user has a smaller screen resolution and lower bit-depth, but there is no way to verify that using this method.  As such, keep in mind that you are still only capturing data on a sub-set of your visitors, unless you have 100% 4.x users.</p></p></p><p><p></p>Finally, keep in mind that the web is a moving target in general.  The information you collect is really only valid for the time it was collected.  Newer systems and browsers are always coming out, so if you are relying on this information a year from now, you may be doing yourself a dis-service.</p></p></p><p></p><h3>The Client-Side Script</h3></p><p><p></p>It is important to know that you cannot write the screen and window information to the server via JavaScript.  To prevent requiring the user to submit a page, and to prevent writing all the data to the URL, I opted to set cookies with the data.  Please note that I attempted to name the cookies close to plain English so users who have cookie warning enabled will know just what I am trying to write to their machine.  By writing to a cookie, the next page the user visits on my site can execute server-side script to pull the values from those cookies and write that data to somewhere on the server.</p></p></p><p><p></p>To prevent capturing a user's information over and over I coupled this script with my splash page, which already has code to prevent a user from seeing it more than once a month.  You can get information on how to do that from the tutorial, "<a href="http://www.evolt.org/article/Let_the_User_Skip_the_Splash_Page/20/416/index.html" title="evolt.org Article">Let the User Skip the Splash Page</a>."  In this case, I use the ASP (server-side) version, reducing the load on the client to manage the cookie reading and page reloading.  If you do not use any method to capture and write the data once per user, then you will have to manually pull all records with duplicate IP addresses, potentially removing different people from behind one firewall.  Also keep in mind that an AOL user could get recorded many times under multiple IP addresses thanks to AOL's proxy methods.  If the user does not accept cookies, then you have nothing to worry about, you just won't get any data from that user.</p></p></p><p><p></p>Below is the script I used to capture the information.  I had this script in the <code>&lt;body&gt;</code> tag, after all the content.  You'll note that I am not concerned with the browser window size, but instead with the viewable area within the window.  Every user can have a different combination of browser chrome settings, tool bars, button bars, etc., taking up space.  So, instead of trying to guess who has what tool bars open, I just find the viewable area.</p></p></p><p><pre>&lt;script language=&quot;JavaScript&quot;&gt;&lt;!--</p>var wHeight, wWidth, sHeight, sWidth, bitDepth;</p><p>if (document.all)</p>	{	wHeight = document.body.clientHeight;</p>		wWidth = document.body.clientWidth;</p>		sHeight = screen.height;</p>		sWidth = screen.width;</p>		bitDepth = screen.colorDepth; }</p>else if (document.layers)</p>	{	wHeight = window.innerHeight;</p>		wWidth = window.innerWidth;</p>		sHeight = screen.height;</p>		sWidth = screen.width;</p>		bitDepth = screen.colorDepth; }</p><p>document.cookie = &quot;wHeight=&quot; + wHeight + &quot;;&quot;;</p>document.cookie = &quot;wWidth=&quot; + wWidth + &quot;;&quot;;</p>document.cookie = &quot;sHeight=&quot; + sHeight + &quot;;&quot;;</p>document.cookie = &quot;sWidth=&quot; + sWidth + &quot;;&quot;;</p>document.cookie = &quot;bitDepth=&quot; + bitDepth + &quot;;&quot;;</p>// --&gt;</p>&lt;/script&gt;</pre></p><p></p><h3>The Server-Side Script</h3></p><p><p></p>Since our site uses Active Server Pages, the following code is VBScript.  However, it's very basic code, so if you can read cookies, concatenate strings, and write to a file or database on the server in your server-side code, you'll be all set.</p></p></p><p><p></p>You may wish to modify how I write the data.  In the script below, I write the x-value, the letter 'x', and then the y-value.  You're probably better off not concatenating them, and instead, given my example, using a pipe ( ) instead of an 'x' to create two fields instead of one.  It's hard to crunch numbers that aren't numbers.</p></p></p><p><p></p>You'll note I also write the date, the time, the browser, and the IP address.  These fields are handy to prevent duplicates, and to see which browsers are giving you trouble with the script.  I also write another cookie just to make sure I don't log a user's information more than once per month - in case that user gets by my splash page script.</p></p></p><p><pre>&lt;%</p>'## Screen Resolution Logging</p><p>strBrowser = Request.ServerVariables(&quot;HTTP_USER_AGENT&quot;)</p>strIP = Request.ServerVariables(&quot;REMOTE_ADDR&quot;)</p>strNowTime = FormatDateTime(Now,vbShortTime)</p>strNowDate = FormatDateTime(Now,vbShortDate)</p><p>IF</p> NOT Request.Cookies(&quot;ScreenRes&quot;) = &quot;TRUE&quot;</p>AND</p> NOT Request.Cookies(&quot;bitDepth&quot;) = &quot;&quot;</p>THEN</p><p>	wHeight = Request.Cookies(&quot;wHeight&quot;)</p>	wWidth = Request.Cookies(&quot;wWidth&quot;)</p>	sHeight = Request.Cookies(&quot;sHeight&quot;)</p>	sWidth = Request.Cookies(&quot;sWidth&quot;)</p>	bitDepth = Request.Cookies(&quot;bitDepth&quot;)</p><p>	TextRecord = sWidth & &quot;x&quot; & sHeight & &quot; &quot;</p>	TextRecord = TextRecord & wWidth & &quot;x&quot; & wHeight & &quot; &quot;</p>	TextRecord = TextRecord & bitDepth & &quot;-bit &quot;</p>	TextRecord = TextRecord & strNowDate & &quot; &quot;</p>	TextRecord = TextRecord & strNowTime& &quot; &quot;</p>	TextRecord = TextRecord & strBrowser & &quot; &quot;</p>	TextRecord = TextRecord & strIP</p><p>	'## OPEN TEXT FILE</p>	Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</p>	Set objNewFile = objFSO.OpenTextFile(&quot;X:/XXX/scrlog.txt&quot;, 8)</p><p>	'## WRITE TO TEXT FILE</p>	objNewFile.WriteLine TextRecord</p><p>	'## CLOSE TEXT FILE</p>	objNewFile.Close</p><p>'## Cookie Setting</p><p>	'## Adds 1 month onto current date</p>	'## so cookie will expire 1 month from now</p>	strNowDate = FormatDateTime(Now,vbGeneralDate)</p>	NewDate = DateAdd(&quot;w&quot;,1,strNowDate)</p><p>	'## This sets the cookie so that</p>	'## the next time the user comes back</p>	'## they will skip the splash page</p>	Response.Cookies(&quot;ScreenRes&quot;) = &quot;TRUE&quot;</p>	Response.Cookies(&quot;ScreenRes&quot;).expires = cdate(NewDate)</p><p>END IF</p>%&gt;</pre></p><p></p><h3>Reporting</h3></p><p><p></p>Once you have this in place, you can sit back and watch the data roll in.  You should designate a time-frame or target date in advance.  My goal was 1,000 entries, which for our site was three months.  From there it's just a matter of importing the data to a spreadsheet or database and sifting through the data to find the numbers.</p></p></p><p><h3>Results</h3></p><p><p></p>This article has shown you a method to write your own screen resolution, browser size, and bit-depth tracking.  <a href="http://www.evolt.org/article/Real_World_Browser_Size_Stats_Part_II/20/2297/index.html" title="Part 2">Part 2</a> will show you the results from my site, <a href="http://algonquinstudios.com/" target="_new" title="Algonquin Studios">http://algonquinstudios.com/</a></p></p>