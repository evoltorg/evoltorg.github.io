---
layout: post
permalink: working-with-fractions-in-css-and-php
ratings: 1
avgrate: 5.0000
categories: [Code]
user: bpeh
real_name: "Bernard Peh"
user_biog: "Bernard Peh is the IT project lead at CPM. He loves philosophy and is passionate about open source technologies. During his free time, he maintains his <a href=\"http://web-developer.sitecritic.net\" rel=\"nofollow\">Think LAMP</a> blog."
user_since: 15 Oct 2006
avatar: 
article_count: 2
excerpt: "<p>Most of us are uncomfortable with using fractions when writting programs. If we encounter a fraction, we will first convert it into a floating point number (with decimals) and proceed from there. Most programming languages would prefer to use 0.5 as opposed to 1/2 because the later conf..."
---
<p></p>  Most of us are uncomfortable with using fractions when writting programs. </p>  If we encounter a fraction, we will first convert it into a floating point </p>  number (with decimals) and proceed from there. Most programming languages </p>  would prefer to use 0.5 as opposed to 1/2 because the later might conflict </p>  with the syntax of the languages. In this article, I will discuss my attempt </p>  to work with fractions in one of the PHP projects that I have done.</p></p></p><h2>Displaying Fractions In HTML</h2></p><p></p>  There are a few ways to display fractions in the web. The most common way is </p>  just to add a slash between 2 numbers, like so "1/2". There are also special </p>  HTML characters that we can make fractions look more professional. Eg. to display </p>  1/2, we can use the HTML code <code>&frac12;</code>. However, not many fractions </p>  are supported by HTML. So, you may be in trouble if you want to display 2/9 in HTML. </p></p></p><p></p>  A better way to display a fraction is probably to use the superscript and </p>  subscript tags. Using <code><sup></code> and <code><sub></code> tags, my 2/9 will </p>  look a bit better. We can also use a "special slash" <code>&#8260;</code> between </p>  2 numbers instead of a normal slash ( / ). Still not satisfied? With CSS, we can </p>  push the limit further. </p><p></p>  If we define a css like this:</p></p></p><code></p>  .fracNum, .fracDen { </p>         font-size: 70%; </p>  } </p>  .fracNum { vertical-align: 0.5em; } </p>  .fracDen { vertical-align: -0.5em; }</p></code></p><p></p>  and when implemented with the 'sup' and 'sub' tags, The fraction will look even </p>  better. The code will be something like:</p></p></p><code></p>  <sup class="fracNum">2</sup>&#8260;<sub class="fracDen">9</sub></p></code></p><p><h2>Converting Decimals To Fraction - A Real Example</h2></p><p></p>  I wrote a program that let people frame their pictures online. When I was </p>  halfway through, I was told that the program should support imperial </p>  measurements (inches). The problem with working in inches is that very few </p>  people would say my picture is 6.34 inch width by 9.82 inch height; Most </p>  people would say 6 and 3/8 inch by 9 and 3/8 height for example. </p></p></p><p></p>  The biggest problem now is that the framing engine calculates everything in </p>  mm. Instead of rewritting the whole engine, I figured out that what I need </p>  is just an interface to convert mm to inches. So, if I pass 300mm into a </p>  function, it should return me 11 and 3/4 as the answer. Dividing 300mm by 1 </p>  inch (25.4mm) will leave me with a long decimal. It would be silly to try </p>  and display a fraction for a decimal like 0.1111. The function should be </p>  intelligent enough to round off the decimal to something that can be easily </p>  displayed as a fraction. For example, if I round off 0.1111 to 0.125, I can </p>  display the fraction as 1/8 instead of 1111/100000. Time is running short </p>  and I need a simple and sweet solution.</p></p></p><p><h2>Implementation</h2></p><p></p>  I would like to go through snipplets of code with explaination first before </p>  revealing everything. Feel free to jump to the end of the page and copy </p>  the whole function if you just want to implement it in your website. </p>  The code is written in PHP. </p></p></p><p><h3>Part 1: Extracting the decimal in inches. </h3></p><p><?php</p>  define(INCH_TO_MM, 25.4);</p>  // 1 inch equals to 25.4mm</p>  $inch = $mm / INCH_TO_MM; </p>  $pWhole = explode('.',$inch); </p>  $pWhole = $pWhole[0];</p>  $pDecimal = $val-$pWhole; </p>?></p><p></p>  The measurement in mm is first converted to inches(with decimal). </p>  The decimal is then isolated from the whole number and stored in a </p>  <code>var</code> called <code>$pDecimal</code>. Now, I need to store a </p>  list of all possible fractions with their mm equivalent in an array. </p>  I use intervals of 1/8 for the sake of simplicity.</p></p></p><h3>Part 2: Rounding off to the closest inch interval.</h3></p><?php</p>  $fractionOption = array();</p>  $fractionOption['0/8’] = 0;</p>  $fractionOption['1/8’] = 0.125;</p>  $fractionOption['1/4’] = 0.25;</p>  $fractionOption['3/8’] = 0.375;</p>  $fractionOption['1/2’] = 0.5; </p>  $fractionOption['5/8’] = 0.625; </p>  $fractionOption['3/4’] = 0.75; </p>  $fractionOption['7/8’] = 0.875; </p>  $fractionOption['8/8’] = 1;</p>  </p>  foreach ($fractionOption as $k => $v) {</p>         // Converted $pDecimal back to mm to perform calculation </p>         $tmpV[$k] = abs($pDecimal - $v);</p>  }</p>  </p>  asort($tmpV,SORT_NUMERIC);</p>  </p>  list($inch, $mm) = each($tmpV);</p>?></p><p></p>  This is the most important step in the whole conversion process. The </p>  foreach loop creates a new array called <code>$tmpV</code> which stores </p>  the inch fraction as the key and the inch difference as the value. </p>  We will now sort <code>$tmpV</code> with the minimum 'mm' value at the top</p>  and the maximum 'mm' value at the bottom using the <code>asort</code> </p>  function. We are extracting the first entry in the array because it stores </p>  the minimum 'mm' difference. As you can see, what we are trying to do here </p>  is to round <code>$pDecimal</code> off to the closest decimal value in the </p>  <code>$fractionOption</code> array (ie, 0.125, 0.25, 0.375..etc). </p></p></p><p></p>  We can now safely extract the first key-value pair in $tmpV using the </p>  <code>list</code> function. The <code>$inch</code> var stores the inch </p>  representation that we want.</p></p></p><p><h3>Part 3: Cleaning Up </h3></p><?php</p>  $inch = ($inch == '0/8') ? '': $inch;</p>  // round off to nearest whole number if 8/8</p>  if ($inch == '8/8') {</p>      $inch = '';</p>      $pWhole++;</p>  }</p>?></p><p></p>  We do not want to display the fraction if it is ‘0/8’ or ‘8/8’ because it </p>  is pretty much meaningless. However, if the fraction is ‘8/8’, we have </p>  to increase the whole number by 1.</p></p></p><p><h3>Part 4: Adding some CSS </h3></p><?php</p>  if ($inch != '') {</p>      $tFrac = explode('/',$inch);</p>      // again please replace [] with the real html tags</p>      $fraction = "[sup class='fracNum']$tFrac[0][/sup]&#8260;[sub class='fracDen']$tFrac[1][/sub]";</p>  }</p>  else { </p>      $fraction = ''; </p>  } </p>  return "$pWhole $fraction";</p>?></p><p></p>  Remember that we eliminated any fractions that are '0/8' or '8/8'? </p>  So we only need to process any fraction that falls within the range of </p>  '1/8' to '7/8'. By splitting the fractions into numerators and denominators, </p>  we can now apply our CSS technique mentioned above.</p><p></p><p><h2>The Whole Thing </h2></p><p></p>  As promised, the full code is displayed below:</p></p></p><p><?php</p><p>function mmToInch ($val) {</p><p>       $fractionOption = array();</p>       $fractionOption['0/8'] = 0;</p>       $fractionOption['1/8'] = 0.125;</p>       $fractionOption['1/4'] = 0.25;</p>       $fractionOption['3/8'] = 0.375;</p>       $fractionOption['1/2'] = 0.5;</p>       $fractionOption['5/8'] = 0.625;</p>       $fractionOption['3/4'] = 0.75;</p>       $fractionOption['7/8'] = 0.875;</p>       $fractionOption['8/8'] = 1;</p>       define(INCH_TO_MM, 25.4);</p><p>       $val = $val/INCH_TO_MM;</p>       $pWhole = explode('.',$val);</p>       $pWhole = $pWhole[0];</p>       $pDecimal = $val-$pWhole;</p>              </p>       foreach ($fractionOption as $k => $v) {</p>              $tmpV[$k] = abs($pDecimal - $v);</p>       }</p>       </p>       asort($tmpV,SORT_NUMERIC);</p>       list($inch, $mm) = each($tmpV);</p><p>       // nullify pWhole and pFraction</p>       $pWhole = ($pWhole == 0) ? '': $pWhole;</p>       $inch = ($inch == '0/8') ? '': $inch;</p><p></p>       // round off to nearest whole number if 8/8</p>       if ($inch == '8/8') {</p>              $inch = '';</p>              $pWhole++;</p>       }</p>       </p>       // strip inch and return fraction formatted in css</p>      if ($inch != '') { </p>             $tFrac = explode('/',$inch);</p>              $fraction = "<sup class='fracNum'>$tFrac[0]</sup>&#8260;<sub class='fracDen'>$tFrac[1]</sub>";</p>       }</p>       else {</p>              $fraction = ''; </p>       }</p>       return $pWhole.' '.$fraction;   </p>}</p><p>// testing </p>echo "67.885 mm is equivalent to ".mmToInch(66.885)." inches";</p><p>?></p><p></p>  The sourcecode can be dowloaded at http://web-developer.sitecritic.net/mmToInch_function.txt</p></p></p><h2>Conclusion</h2></p><p></p>  I hope that the decimal to fraction conversion solution shown in this </p>  tutorial is straight forward and easy to implement. The script rounds </p>  off any decimal value to the closest one-eighth of an inch. If you want </p>  more accuracy, you can make your fraction interval smaller, for example </p>  1/16 or 1/32...and so on. The logic used in this example can be easily </p>  applied to other programming languages. Feel free to try the online framing </p>  program at http://www.clubframeco.com/smartFramer.html. Make sure you select </p>  the inch option to see fractions in action.</p></p>