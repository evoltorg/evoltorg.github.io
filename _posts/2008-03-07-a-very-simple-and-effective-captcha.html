---
layout: post
permalink: node/60926
---
<p>I have a very simple anti bot-spam technique that works extremely well. It requires no javascript, cookies, hidden fields or complicated server weirdness, has  negligible overhead, is fully accessible, has a high usability factor and takes just a moment or two to implement.</p></p><p><p>It requires that the user fill out one field with a number, so it's good for <em>anti-bot</em> but will not prevent human spammers. In three years, I have yet to receive <em>any</em> bot spam on any of the many sites that I have installed this on. Sites that were being bombarded with hundreds of spams daily suddenly became quiet and good emails get though. I recommend that this core technique be implemented with your own creative additions and variations. I use it almost as-is, and as I've previously mentioned have (so far) had a 100% anti spam-bot effectiveness rate over three years and some 20 odd sites. </p></p><p><p><strong>All you are doing is this:</strong></p></p><p><ul>\n	<li>Generating a random number</li>\n	<li>Setting it to a session variable</li>\n	<li>Displaying the number (session.variable) next to a field in the form, getting the user to copy it over into the field.</li>\n	<li>On submission, verify that the form.value matches the session.random number</li>\n	<li>On pass you allow the submission</li>\n	<li>On fail you abort, exit, show a message, do as you wish.</li>\n</ul>\n</p></p><p>\n<p><strong>Here is the very bare bones version</strong>.</p>\n<pre>\n&lt;!--- Generate a random number (I use 4 digits) before your form ---&gt;\n&lt;cfscript&gt;\n   // Delete previous random number variables if they exist (no re-use of a cached number)\n   if(isDefined(&quot;session.chk_rand&quot;)) {\n      StructDelete(session, &quot;chk_rand&quot;);\n   }\n   // Assign a new random number\n   session.chk_rand = NumberFormat(RandRange(0, 9999),'0000');\n&lt;/cfscript&gt;</p><p>\n&lt;!--- Place this text input field in the form, near the submit button ---&gt;\n   #session.chk_rand# enter this number here -&amp;gt; &lt;input name=&quot;spmchck&quot; type=&quot;text&quot; size=&quot;4&quot; maxlength=&quot;4&quot;/&gt;</p><p>&lt;!--- Before your form processing code (the send and/or insert function) ---&gt;\n&lt;cfparam name=&quot;form.spmchck&quot; default=&quot;&quot;&gt;\n&lt;cfif form.spmchck NEQ session.chk_rand&gt;\n   ...Some human readable validation message (or other validation function) &quot;Sorry, you need to fill in the following fields...&quot;\n   &lt;!--- Delete the random number that was just used ---&gt;\n   &lt;cfscript&gt;StructDelete(session, &quot;chk_rand&quot;);&lt;/cfscript&gt;\n   &lt;cfexit&gt;\n&lt;/cfif&gt;\n</pre></p><p><p><strong>Explanation</strong></p>\n<p>If the form.value is equal to the session.random number, then it passes and you process normally, if not, the session.value with the random number is deleted (and thus the next attempt gives you a new random number), then the template is exited. One could, if one were so inclined add logging, honey pot link or email, or use some sort of function to count how many submissions were made by the ip in a small time period to figure out if you want to ban them for 24 hours or not. One could extend this to use alpha characters and so on. Additions to this technique are limited only by your creativity. </p>\n<p>Most bots (any?) won't won't be able to recognize the system because the random number is plain old page text. The user has only a very simple task to perform, and it changes every time the form is accessed, so even if the spammer submits manually, it's labour intensive to keep re-entering a random number. It would be even more so when combined with techniques such as permitting only one submission every 30 seconds. Those with javascript enabled will never see the server side error, and those without it (such as braille readers) will still get a meaningful message.</p></p><p>Even if the spammers catch up with this notion, a simple response such as randomizing the &quot;put this number here&quot; message or location of the message (before the field, after the field, above or below it, in a randomly selected &lt;p&gt;, &lt;span&gt; or &lt;div&gt;, radio button or select menu ). If you wanted to get all fancy about it, you could even randomise the name of the field as a session var. It's just a LOT of work for a spammer to come up with a parser that can handle all the variations.\n<p>You can be more sophisticated about it. This is basically a low-tech, high effectiveness version of captcha.</p></p><p><p>It's as simple a concept as it gets, and it works well. Let me know how it works for you, or additional variations that you might come up with.</p>\n