---
layout: post
permalink: node/9279
---
<p>\nIf you've spent a decent amount of time in the Web development field, chances are you've had to send out a 'mass mailing' of some sort\nat one time or another. When done manually, this can be an extremelly tedious task. Creating 'groups' of email addresses\nwithin your email client is one solution, but what if a co-worker wanted to send an email out\nto the group of people as well? Obviously, this is a process which is screaming for automation. In the first section of\nthis three-part article, we'll discuss the foundation for a simple mass mailer.\n</p></p><p><p>\n<h2>Spelling out our goals.</h2>\n</p>\n<p></p><p>Now, what we're creating here is going to be an *extremely* simple mass emailer that will allow\nus to send a single email to many many people through a simple web form. This isn't to be confused with\na full fledged mailing list manager(MLM) such as Mailman or Majordomo which would facilitate replies, digests, archives, etc. We're here\nto do one(albeit simple) thing and do it well. However, we will build our application so that if\nthe need arises for more features in the future, they won't be difficult to integrate into\nwhat we'll have already built. The first part of this article will deal with setting up the database structure, and talking\nabout some of the high level goals we'll be trying to achieve. The continuation of this article will give examples in Cold\nFusion and PHP. Perhaps someone would like to also write ASP or JSP versions of the code using the strucutre we'll\nbe explaining today as a jumping point.\n</p></p><p><p>\n<h2>The database architecture.</h2>\n</p></p><p><p>\nFirst off, let's get the database structure defined. We have three tables in our application; one for messages,\none to keep track of users, and one to define lists. Here's the SQL and a basic description of each:</p>\n<p>\n<pre>\n## Created in MySQL, adjust to taste.\nCREATE TABLE lists (\nlist_id int(3) DEFAULT '1' NOT NULL,\nlist_email varchar(50) NOT NULL,\nlist_admin_id int(11) DEFAULT '0' NOT NULL,\nlist_desc text NOT NULL,\nlist_name varchar(50) NOT NULL,\nlist_passwd varchar(50) NOT NULL,\nlist_footer varchar(250) NOT NULL,\nUNIQUE list_id (list_id)\n);\n</pre>\n</p>\n<p>\nSo, our <strong>lists</strong> table has 6 values:\n<ul>\n<li><strong>list_id </strong> each list has unique numeric value, its our primary key(PK).</li>\n<li><strong>list_email</strong> holds the value of what our list will show in the From: header of the email.</li>\n<li><strong>list_admin_id</strong> is just a placeholder for future use and won't be used here.</li>\n<li><strong>list_desc</strong> is a short description of our list.</li>\n<li><strong>list_name</strong> is the name of our list, and what we'll use to authenticate administrators.</li>\n<li><strong>list_passwd</strong> is the password used to gain access to the functions of our list.</li>\n<li><strong>list_footer</strong> is a message that will get appended to each message sent out with information about our list.</li>\n</ul>\n</p>\n<p></p><p><pre>\n# Table structure for table 'members'</p><p>CREATE TABLE members (\nmember_id int(1) DEFAULT '1' NOT NULL,\nmember_fname varchar(50),\nmember_lname varchar(50),\nmember_email varchar(50) NOT NULL,\nmember_level int(11) DEFAULT '0' NOT NULL,\nmember_subscribed tinyint(1) DEFAULT '0' NOT NULL,\nmember_created datetime NOT NULL,\nmember_subscribedto int(11) DEFAULT '0' NOT NULL,\nUNIQUE member_id (member_id)\n);\n</pre>\n</p>\n<p>\nA description of the <strong>members</strong> table:\n<ul>\n<li><strong>member_id</strong> assign each member a unique id, our PK.</li>\n<li><strong>member_fname</strong> first name of the member.</li>\n<li><strong>member_lname</strong> last name of the member.</li>\n<li><strong>member_email</strong> email address of the member.</li>\n<li><strong>member_level</strong> placeholder for future features and won't be used here.</li>\n<li><strong>member_subscribed</strong> 0/1 value to tell us if the member is subscribed or unsubscribed.</li>\n<li><strong>member_created</strong> just a date/time stamp to see how long they've been subscribed.</li>\n<li><strong>member_subscribedto</strong> id of the list they're subscribed to.</li>\n</ul>\n</p></p><p><p></p><p><pre>\n# Table structure for table 'messages'</p><p>CREATE TABLE messages (\nmsg_id int(1) DEFAULT '1' NOT NULL,\nmsg_from_id int(11) DEFAULT '0' NOT NULL,\nmsg_body text NOT NULL,\nmsg_date datetime NOT NULL,\nmsg_list_id int(11) DEFAULT '0' NOT NULL,\nmsg_subject text,\nUNIQUE msg_id (msg_id)\n);\n</pre>\n</p>\n<p>\nA description of the <strong>messages</strong> table:\n<ul>\n<li><strong>msg_id</strong> a unique value for each message that is sent, our PK.</li>\n<li><strong>msg_from_id</strong> placeholder for future features that won't be used here.</li>\n<li><strong>msg_body</strong> the body of the email thats being sent out.</li>\n<li><strong>msg_date</strong> a date/time stamp recording when the message was sent.</li>\n<li><strong>msg_list_id</strong> a number that corresponds to a list_id in our lists table to track which message belongs to which list.</li>\n<li><strong>msg_subject</strong> the subject of the email being sent.</li>\n</ul>\n</p>\n<p>\nAs you can see, pretty much everything ties into together. We're planning on making this somewhat 'scaleable' in that we can have more than\none list, and that each list we define has a seperate set of subscribers and messages associated with that particular list. Likewise, every\nmember and message is associated with a list_id. Other than that, it's pretty self-explanatory.\n</p>\n<p>Now that we've got the database foundation nailed down we'll continue with the Cold Fusion end of our application will look like in the next installation of this article. In following installments, we'll show how to provide the same functionality in PHP that uses the same foundation we've layed today. Hopefully, someone will also follow up with ASP and/or JSP versions of the code too. Stay tuned!</p>