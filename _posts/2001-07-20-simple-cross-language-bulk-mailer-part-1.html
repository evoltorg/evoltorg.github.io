---
layout: post
permalink: node/9279
ratings: 6
avgrate: 4.3333
category: Backend
user: djc
real_name: "Daniel Cody"
user_biog: "<p>Dan lives a quiet life in the bustling city of Milwaukee, WI. Although he founded what would become evolt.org in 1998, he\'s since moved on to other projects and is now the owner of <a href=\"http://hostprogressive.com/\" title=\"Zimbra hosting, web hosting for Wisconsin\" rel=\"nofollow\">Progressive Networks, a Zimbra hosting</a> company based in Milwaukee.</p><p> His personal site can be found at <a href=\"http://dancody.org/\" title=\"Dan Cody\" rel=\"nofollow\">http://dancody.org/</a></p>"
user_since: 14 Dec 1998
avatar: 
article_count: 146
excerpt: "If you\'ve spent a decent amount of time in the Web development field, chances are you\'ve had to send out a \'mass mailing\' of some sort</p>at one time or another. When done manually, this can be an extremelly tedious task. Creating \'groups\' of email address\'</p>within your email clie..."
---
<p></p>If you've spent a decent amount of time in the Web development field, chances are you've had to send out a 'mass mailing' of some sort</p>at one time or another. When done manually, this can be an extremelly tedious task. Creating 'groups' of email addresses</p>within your email client is one solution, but what if a co-worker wanted to send an email out</p>to the group of people as well? Obviously, this is a process which is screaming for automation. In the first section of</p>this three-part article, we'll discuss the foundation for a simple mass mailer.</p></p></p><p><p></p><h2>Spelling out our goals.</h2></p></p></p><p></p><p>Now, what we're creating here is going to be an *extremely* simple mass emailer that will allow</p>us to send a single email to many many people through a simple web form. This isn't to be confused with</p>a full fledged mailing list manager(MLM) such as Mailman or Majordomo which would facilitate replies, digests, archives, etc. We're here</p>to do one(albeit simple) thing and do it well. However, we will build our application so that if</p>the need arises for more features in the future, they won't be difficult to integrate into</p>what we'll have already built. The first part of this article will deal with setting up the database structure, and talking</p>about some of the high level goals we'll be trying to achieve. The continuation of this article will give examples in Cold</p>Fusion and PHP. Perhaps someone would like to also write ASP or JSP versions of the code using the strucutre we'll</p>be explaining today as a jumping point.</p></p></p><p><p></p><h2>The database architecture.</h2></p></p></p><p><p></p>First off, let's get the database structure defined. We have three tables in our application; one for messages,</p>one to keep track of users, and one to define lists. Here's the SQL and a basic description of each:</p></p><p></p><pre></p>## Created in MySQL, adjust to taste.</p>CREATE TABLE lists (</p>list_id int(3) DEFAULT '1' NOT NULL,</p>list_email varchar(50) NOT NULL,</p>list_admin_id int(11) DEFAULT '0' NOT NULL,</p>list_desc text NOT NULL,</p>list_name varchar(50) NOT NULL,</p>list_passwd varchar(50) NOT NULL,</p>list_footer varchar(250) NOT NULL,</p>UNIQUE list_id (list_id)</p>);</p></pre></p></p></p><p></p>So, our <strong>lists</strong> table has 6 values:</p><ul></p><li><strong>list_id </strong> each list has unique numeric value, its our primary key(PK).</li></p><li><strong>list_email</strong> holds the value of what our list will show in the From: header of the email.</li></p><li><strong>list_admin_id</strong> is just a placeholder for future use and won't be used here.</li></p><li><strong>list_desc</strong> is a short description of our list.</li></p><li><strong>list_name</strong> is the name of our list, and what we'll use to authenticate administrators.</li></p><li><strong>list_passwd</strong> is the password used to gain access to the functions of our list.</li></p><li><strong>list_footer</strong> is a message that will get appended to each message sent out with information about our list.</li></p></ul></p></p></p><p></p><p><pre></p># Table structure for table 'members'</p><p>CREATE TABLE members (</p>member_id int(1) DEFAULT '1' NOT NULL,</p>member_fname varchar(50),</p>member_lname varchar(50),</p>member_email varchar(50) NOT NULL,</p>member_level int(11) DEFAULT '0' NOT NULL,</p>member_subscribed tinyint(1) DEFAULT '0' NOT NULL,</p>member_created datetime NOT NULL,</p>member_subscribedto int(11) DEFAULT '0' NOT NULL,</p>UNIQUE member_id (member_id)</p>);</p></pre></p></p></p><p></p>A description of the <strong>members</strong> table:</p><ul></p><li><strong>member_id</strong> assign each member a unique id, our PK.</li></p><li><strong>member_fname</strong> first name of the member.</li></p><li><strong>member_lname</strong> last name of the member.</li></p><li><strong>member_email</strong> email address of the member.</li></p><li><strong>member_level</strong> placeholder for future features and won't be used here.</li></p><li><strong>member_subscribed</strong> 0/1 value to tell us if the member is subscribed or unsubscribed.</li></p><li><strong>member_created</strong> just a date/time stamp to see how long they've been subscribed.</li></p><li><strong>member_subscribedto</strong> id of the list they're subscribed to.</li></p></ul></p></p></p><p><p></p><p><pre></p># Table structure for table 'messages'</p><p>CREATE TABLE messages (</p>msg_id int(1) DEFAULT '1' NOT NULL,</p>msg_from_id int(11) DEFAULT '0' NOT NULL,</p>msg_body text NOT NULL,</p>msg_date datetime NOT NULL,</p>msg_list_id int(11) DEFAULT '0' NOT NULL,</p>msg_subject text,</p>UNIQUE msg_id (msg_id)</p>);</p></pre></p></p></p><p></p>A description of the <strong>messages</strong> table:</p><ul></p><li><strong>msg_id</strong> a unique value for each message that is sent, our PK.</li></p><li><strong>msg_from_id</strong> placeholder for future features that won't be used here.</li></p><li><strong>msg_body</strong> the body of the email thats being sent out.</li></p><li><strong>msg_date</strong> a date/time stamp recording when the message was sent.</li></p><li><strong>msg_list_id</strong> a number that corresponds to a list_id in our lists table to track which message belongs to which list.</li></p><li><strong>msg_subject</strong> the subject of the email being sent.</li></p></ul></p></p></p><p></p>As you can see, pretty much everything ties into together. We're planning on making this somewhat 'scaleable' in that we can have more than</p>one list, and that each list we define has a seperate set of subscribers and messages associated with that particular list. Likewise, every</p>member and message is associated with a list_id. Other than that, it's pretty self-explanatory.</p></p></p><p>Now that we've got the database foundation nailed down we'll continue with the Cold Fusion end of our application will look like in the next installation of this article. In following installments, we'll show how to provide the same functionality in PHP that uses the same foundation we've layed today. Hopefully, someone will also follow up with ASP and/or JSP versions of the code too. Stay tuned!</p>