---
layout: post
permalink: asp_coding_tricks
---
<p>This article will expose a few tricks that can be used to speed up the ASP development process. The focus of this article is not performance, even though some tricks will actually improve load time and server stress.</p></p><p><h2>With Response</h2></p><p><p>If I ever see With used in an ASP script, it's usually dealing with a server object. Let it be known that it is not against the law to use With on ASP's objects. Do you get tired of typing "Response.Write" every line? (Because you wouldn't dare switch between &lt;%&nbsp;&nbsp;%&gt; just to add content to the HTML stream, right?) Well, would you rather simply type ".Write"? Then you might want to try this:</p></p><p><pre>&lt;%\n	' Begin the With\n	With Response\n		.Write &quot;this &quot;\n		.Write &quot;is &quot;\n		.Write &quot;the &quot;\n		.Write &quot;same &quot;\n		.Write &quot;as &quot;\n		.Write &quot;Response.Write&quot;\n	' End the With\n	End With\n%&gt;</pre></p><p><p>With statements have the syntax of:</p></p><p><code>With Object<br>&nbsp;&nbsp;&nbsp;&nbsp;.method<br>&nbsp;&nbsp;&nbsp;&nbsp;.property = value<br>End With</code></p><p><p>Of course, each method or property does not have to be the same. The above '.Write' example was just one use (and not a very good one at that -- the usefulness would be more apparent if there was more text/code).</p></p><p><h2>P("print this")</h2></p><p><p>What's that, you say? Not good enough for you? Well, how about creating a custom subroutine:</p></p><p><pre>\n&lt;%\nSUB P(string)\n	Response.Write Replace(string, vbtab, &quot;&quot;)\nEND SUB</p><p>P(&quot;&lt;table&gt;&quot;)\nP(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&quot;)\nP(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&quot;)\n' and so on...\n%&gt;\n</pre></p><p><p>And you could even edit the subroutine to add HTML-debugging aids. Here's my favorite:</p></p><p><pre>\nSUB P(string)\n	Response.Write string & vbCrLf\nEND SUB\n</pre></p><p><p>This adds a newline character so that the HTML is easier to read.</p></p><p><h2><a name="stuffing">Stuffing</a></h2></p><p><p>No, this has nothing to do with that delicious Thanksgiving side dish. It has to do with stuffing certain values from collections into local variables. For instance, rather than using:</p></p><p><pre>\nIF trim(request(&quot;formfield&quot;)) &lt;&gt; &quot;&quot; THEN\n	Response.Write trim(request(&quot;formfield&quot;))\nEND IF\n</pre></p><p><p>use this:</p></p><p><pre>\nstrFormfield = trim(request(&quot;formfield&quot;))\nIF strFormfield &lt;&gt; &quot;&quot; THEN\n	Response.Write strFormfield\nEND IF\n</pre></p><p><p>This is also quite resource-friendly. Not only is grabbing the same value from collections resource expensive, but using the same function multiple times is not necessary and also spends resources. Besides, it wastes valuable keystrokes... and we're lazy, right?</p></p><p><h2>Included Files</h2></p><p><p>You probably think I'm going to say something obvious like: Use include file to reuse code. Well, I am. Included files allow for easy updates and maintenance of frequently-used code. It also helps with debugging. Also, put the code in subroutines and functions. This way, you can put all of your included files at the top of the script in one place. Then, call the functions where they need to be called. This eases management of files, especially when you have a 2,000-line script.</p></p><p><h2>For more information...</h2></p><p><a href="http://msdn.microsoft.com/" target="_new">msdn.microsoft.com</a><br><a href="http://www.4guysfromrolla.com/" target="_new">4guysfromrolla.com</a><br><a href="http://www.15seconds.com" target="_new">15seconds.com</a><br><a href="http://www.learnasp.com/" target="_new">www.learnASP.com</a><br>