---
layout: post
permalink: node/621
ratings: 1
avgrate: 4.0000
user: mwarden
real_name: "Matt Warden"
user_since: 18 May 1999
avatar: "/images/pictures/picture-65.gif"
article_count: 7
excerpt: "For those looking to speed up certain semi-static ASP pages (or even semi-static PARTS of ASP pages), the tool you need is Application-level caching."
---
<p></p>Today, I received this email in my otherwise barren Inbox:</p></p></p><p><blockquote></p><i>Hey I saw this post and thought "this could work on my site". </p>Basically I have an ASP which queries an Access database.. but this wouldn't change much. How can I implement this into my page? The design will stay the same.. </i></p></blockquote></p><p><p></p>My original post was why a certain list member shouldn't rule out ASP and CF. Chris was responding to my comments about ASP. The following was my reply to him:</p></p></p><p><blockquote></p>Well, Chris, you'll probably find it quite trivial and redundant work, but to prepare your scripts to be able to use Application-level page caching, you should convert all <code>Response.Write</code>'s to variable stuffs. For instance:</p></blockquote></p><p> <pre></p> Response.Write &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;&quot;</p> Response.Write &quot;&lt;body bgcolor=&quot;&quot;#ffffff&quot;&quot; text=&quot;&quot;#000000&quot;&quot; link=&quot;&quot;#0000ff&quot;&quot;&gt;&quot;</p> Response.Write &quot;&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;&quot;</p> Response.Write &quot;&lt;/body&gt;&quot;</p> Response.Write &quot;&lt;/html&gt;&quot;</p> </pre></p><p> <blockquote></p>Would need to become...</p></blockquote></p><p><pre></p> Dim HTML  'As String</p> HTML = "&lt;html&gt;"</p> HTML = HTML & "&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;"</p> HTML = HTML & "&lt;body bgcolor=""#ffffff"" text=""#000000"" link=""#0000ff""&gt;"</p> HTML = HTML & "&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;"</p> HTML = HTML & "&lt;/body&gt;&lt;/html&gt;"</p> Response.Write HTML</p> </pre></p><p><blockquote></p>These two code snipplets do EXACTLY the same thing. Note that the latter is also quicker and less resource intensive because you are only writing to the response object once, rather than multiple times. So, to set up the actual page caching, you would use this code:</p></blockquote> </p><p><pre></p> &lt;%</p> Dim thisPageID, thisPageHTML</p>  ' find the value o thisPageID</p>  ' this will have to correspond with the naming convension you choose</p> </p>  ' stuff the value of Application(thisPageID) into a variable</p>  ' because otherwise, you will be accessing it multiple times</p>  ' which is unnecessarily resource intensive</p> thisPageHTML = Application(thisPageID)</p> </p> IF NOT thisPageHTML=&quot;&quot; THEN</p>     Response.Write thisPageHTML</p> ELSE</p>     HTML = &quot;&lt;html&gt;&quot;</p>     HTML = HTML & &quot;&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;&quot;</p>     HTML = HTML & &quot;&lt;body bgcolor=&quot;&quot;#ffffff&quot;&quot; text=&quot;&quot;#000000&quot;&quot; link=&quot;&quot;#0000ff&quot;&quot;&gt;&quot;</p>     HTML = HTML & &quot;&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;&quot;</p>     HTML = HTML & &quot;&lt;/body&gt;&lt;/html&gt;&quot;</p>     Response.Write HTML</p>     Application(thisPageID) = HTML</p> END IF</p> %&gt;</p> </pre></p><p><blockquote></p>Of course, stick you access query(ies) in anywhere you want.</p></blockquote></p><p><blockquote></p>Now, all you have to do is force a reconstruction of the page whenever the database is modified.</p></blockquote></p><p><blockquote></p>I've found that the best way to do this is to create a function/sub called <code>ResetVars()</code> or whatever in an include file and include it on all pages. This file will hold all the page caching variables and code for setting them to "". Then, when you update the database, just call <code>ResetVars()</code>. Make sure that you keep this file updated, though.</p></blockquote></p><p><blockquote></p>Well, say that you need to use <code>Response.Flush</code> some time to let the user know that the page hasn't just hung up. Just change the HTML <code>var</code> segment to this:</p></blockquote> </p><p> <pre></p> Dim HTML  'As String</p> HTML = &quot;&lt;html&gt;&quot;</p> HTML = HTML & &quot;&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;&quot;</p> HTML = HTML & &quot;&lt;body bgcolor=&quot;&quot;#ffffff&quot;&quot; text=&quot;&quot;#000000&quot;&quot; link=&quot;&quot;#0000ff&quot;&quot;&gt;&quot;</p> Response.Write HTML</p> Response.Flush</p> HTML2 = HTML2 & &quot;&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;&quot;</p> HTML2 = HTML2 & &quot;&lt;/body&gt;&lt;/html&gt;&quot;</p> Response.Write HTML2</p> Application(thisPageID) = HTML & HTML2</p> </pre></p><p><blockquote></p>Get the idea? Hope this has cleared things up. Let me know if it hasn't.</p></blockquote></p><p><p></p>Now, what I neglected to mention to Chris is that you can also cache certain things that will almost never change. How many of you have an ASP script which populates a select box with state names? Hmmmm... how often have you had to update the database for this state box? Well, then. Store it in an application-level variable. Best thing is that this can be used for <strong>all</strong> ASP pages (in that Application scope) that need it. Think about it <br> Contact: <a href="mailto:evolt_article@mattwarden.com">evolt_article@mattwarden.com</a></p></p>