---
layout: post
permalink: node/9054
ratings: 6
avgrate: 4.3333
categories: [Code]
user: jaylard
real_name: "James Aylard"
user_biog: ""
user_since: 18 Nov 1999
avatar: /images/pictures/picture-569.gif
article_count: 7
excerpt: "Legacy browsers that support only JavaScript 1.0 (such as Netscape Navigator 2 or Internet Explorer 3) do not understand external script files, and will throw a fit of errors when your page tries to access a variable or call a function that is stored in one. Here are two easy workarounds t..."
---
<script type="text/javascript"></p><!--</p>function fnMouseOver2() {}</p>function fnMouseOut2() {}</p>function fnMouseClick2() {</p>  alert("Your browser does not support external script files.</p>Sorry!") ;</p>}</p>// --></p></script></p><script type="text/javascript" src="http://members.evolt.org/jaylard/dev/scripts/js_ExternalJavascriptSupport.js"></p><!--</p>function fnMouseOver1() {}</p>function fnMouseOut1() {}</p>function fnMouseClick1() {</p>  alert("Your browser does not support external script files.</p>Sorry!") ;</p>}</p>// --></p></script></p><p>There are several benefits to using external JavaScript files, and among them are more-compact HTML pages and the caching and sharing of script files among multiple web pages. Most legacy browsers, meaning those that support only JavaScript version 1 (such as Netscape 2 and Internet Explorer 3), however, do not support external script files. When a web page tries to call a function or access a variable that is stored in an external script file, first-generation JavaScript-enabled browsers will throw a fit of errors.</p></p><p>Rather than dismiss this pitfall as part of the price of using a legacy browser, there are steps that developers can take to prevent errors in older browsers while preserving the benefits of external script files for everyone else. Here are two of them:</p></p><h2>Method 1</h2></p><p>In this first example, the code for legacy browsers is contained <em>between</em> the opening and closing <code>&lt;script&gt;</code> tags that also reference the external script file through the <code>src</code> attribute:<br><br></p><em>Example:</em><br></p><pre>&lt;script type=&quot;text/javascript&quot; src=&quot;scripts/js_ExternalJavascriptSupport.js&quot;&gt;</p>  &lt;--</p>    function fnMouseOver1() {}</p>    function fnMouseOut1() {}</p>    function fnMouseClick1() {</p>      alert(&quot;Your browser does not support external script files.</p>Sorry!&quot;) ;</p>    }</p>  // --&gt;</p>&lt;/script&gt;</pre><br><br></p>Partial source of <code>js_ExternalJavascriptSupport.js</code>:<br><br></p><pre>function fnMouseOver1() {</p>  if (document.images) {</p>    document.images[&quot;Smiley1&quot;].src = &quot;images/SmileyOver.gif&quot; ;</p>  }</p>}</p><p>function fnMouseOut1() {</p>  if (document.images) {</p>    document.images[&quot;Smiley1&quot;].src = &quot;images/Smiley.gif&quot; ;</p>  }</p>}</p><p>function fnMouseClick1() {</p>  alert(&quot;Your browser does support external script files.</p>Awesome!&quot;) ;</p>}</pre><br><br></p><em>Try it:</em><br><br></p><a href="JavaScript://" onmouseover="fnMouseOver1();" onmouseout="fnMouseOut1();" onclick="fnMouseClick1(); return false"><img name="Smiley1" src="http://members.evolt.org/jaylard/dev/images/Smiley.gif" border="0" alt="Smiley Face"></a></p><ul><li><strong>Mouse over the image above.</strong> If you are using a legacy browser you should see no change in the image -- but you will also <em>not</em> receive a scripting error. If you are using a newer browser that understands external script files, the mouseover image will change (assuming that your browser also supports the images collection).</li></p><li><strong>Click on the image above.</strong> You will receive an alert that confirms whether or not your browser understands external script files. Browsers that do should execute the function in the external file, while browsers that don't should execute the function contained within the embedded script element.</li></ul><br><br></p><strong>Benefits:</strong></p><ul><li>With minimal code, this method prevents errors in legacy browsers that do not understand external script files.</li></p><li>It takes advantage of the designed intent of the <code>&lt;script&gt;</code> element: browsers that understand the <code>src</code> attribute should ignore any content contained between the opening and closing <code>&lt;script&gt;</code> tags, while browsers that don't understand it will execute that code while ignoring the external file.</li></p><li>It works with functions <em>and</em> variables.</li></ul><br><br></p><strong>Drawbacks:</strong><br><br></p><ul><li>A very small number of known browsers -- all of which are extremely minor makes and models -- are capable of handling external script files while also executing code contained within <code>&lt;script&gt;</code> elements that include a <code>src</code> attribute. This number is far smaller than the number of legacy browsers that will handle this method correctly, but it is still a consideration, however small.</li></ul><br></p></p><h2>Method 2</h2></p><p>The second method was developed by <a href="http://www.evolt.org/">Evolt</a>'s <a href="http://www.evolt.org/user/jeff/15/index.html">Jeff Howden</a>, and offers a benefit or two that the previous method does not. This method involves the use of two <code>&lt;script&gt;</code> elements: one that lacks a <code>src</code> attribute to accommodate legacy browsers, and one that includes a <code>src</code> attribute to handle newer browsers. The secret of this method is that if there are two versions of a function, the second version takes precedence (much like style declaration precedence for those familiar with <acronym title="Cascading Style Sheets">CSS</acronym>). So, by declaring the legacy version of the function first, and then  the more-robust version of the function in an external script file, newer browsers that understand external script files will execute the second version, while legacy browsers that don't understand them will execute the first.<br><br></p><em>Example:</em><br></p><pre>&lt;script type=&quot;text/javascript&quot;&gt;</p>  &lt;--</p>    function fnMouseOver2() {}</p>    function fnMouseOut2() {}</p>    function fnMouseClick2() {</p>      alert(&quot;Your browser does not support external script files.</p>Sorry!&quot;) ;</p>    }</p>  // --&gt;</p>&lt;/script&gt;</p>&lt;script type=&quot;text/javascript&quot; src=&quot;scripts/js_ExternalJavascriptSupport.js&quot;&gt;&lt;/script&gt;</pre><br><br></p>Partial source of <code>js_ExternalJavascriptSupport.js</code>:<br><br></p><pre>function fnMouseOver2() {</p>  if (document.images) {</p>    document.images[&quot;Smiley2&quot;].src = &quot;images/SmileyOver.gif&quot; ;</p>  }</p>}</p><p>function fnMouseOut2() {</p>  if (document.images) {</p>    document.images[&quot;Smiley2&quot;].src = &quot;images/Smiley.gif&quot; ;</p>  }</p>}</p><p>function fnMouseClick2() {</p>  alert(&quot;Your browser does support external script files.</p>Awesome!&quot;) ;</p>}</pre><br><br></p><em>Try it:</em><br><br></p><a href="JavaScript://" onmouseover="fnMouseOver2();" onmouseout="fnMouseOut2();" onclick="fnMouseClick2(); return false"><img name="Smiley2" src="http://members.evolt.org/jaylard/dev/images/Smiley.gif" border="0" alt="Smiley Face"></a></p><ul><li><strong>Mouse over the image above.</strong> As with the first example, if you are using a legacy browser you should see no change in the image -- but you also should <em>not</em> receive a scripting error. If you are using a newer browser that understands external script files, the mouseover image will change (assuming that your browser also supports the images collection) because your browser supersedes the first function with the second.</li></p><li><strong>Click on the image above.</strong> You will receive an alert that confirms whether or not your browser understands external script files. Browsers that do should execute the function in the external file, while browsers that don't should execute the function contained within the embedded script element.</li></ul><br><br></p><strong>Benefits:</strong><br><br></p><ul><li>With only slightly more code than required by the first example,this method prevents errors in legacy browsers that do not understand external script files.</li></p><li>When the browser is unable to locate the external script file, this method has a beneficial side-effect that prevents script errors even in newer browsers. Because the newer browsers recognize the first <code>&lt;script&gt;</code> element, they will use it in those rare cases when the content of the second <code>&lt;script&gt;</code> element is unavailable to replace that of the first. This is a very powerful benefit.</li></ul><br><br></p><strong>Drawbacks:</strong><br><br></p><ul><li>None currently known.</li></ul><br></p></p><p>Whichever method you choose to use is up to you. Also, if you discover quirks or breakdowns in either of these approaches, please either post the details below or email me at <a href="jaylard@members.evolt.org">jaylard@members.evolt.org</a>. Happy coding!</p>