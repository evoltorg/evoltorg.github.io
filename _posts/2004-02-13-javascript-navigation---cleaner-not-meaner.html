---
layout: post
permalink: javascript_navigation_cleaner_not_meaner
---
<p>It is common practise to enhance the user experience of an HTML document by\nadding interactivity via Javascript. DHTML drop downs, tabs, layer navigations, \nimage slide shows and so on and so forth are scattered all over the web.</p> \n<h2>The times are changing</h2>\n<p>In the days of the wild wild web, when browsers sported fours in their navigator \nstring many a bloated script was developed to make the pages come alive. Developers\nfollowed the dark path of browser detection and implemented several different \n<acronym title="Document Object Model">DOM</acronym> solutions in parallel to support\nevery dodgy brower that claimed to understand CSS and Javascript.\nFurthermore, they did the nasty by making the navigation <strong>dependent</strong> on\nJavascript, rather than enhanced through it.</p>\n<p>The times have changed, the browsers have matured and so should we. Accessibility \nguidelines and <acronym title="Search engine optimisation">SEO</acronym> practises tell us\nnot to rely on Javascript, but neither do they forbid us to use it.</p>\n<p>The trick is to use it wisely.</p>\n<p>This article is not showing off any special javascript navigation treat, all it does is\nto show a small trick that helps us keep our markup as clean as possible.</p>\n<h2>The HTML structure</h2>\n<p>Every Javascript enhanced navigation should provide a real link, to avoid dead links \nshould Javascript be turned off (if this is still news to you and you wonder why, read the superb <a href="http://www.evolt.org/links_javascript/">Links &#38; JavaScript Living Together in Harmony</a> article). Normally, this is achieved thus:</p>\n<pre>\n&#60;a href=&#34;#target&#34; \nonclick=&#34;myfunction(myparameters);return false&#34;&#62;Link&#60;/a&#62;\n</pre>\n<p>If you want to ensure that your links are also usable for people without a mouse, add \nan onkeypress handler.</p>\n<pre>\n&#60;a href=&#34;#target&#34; \nonclick=&#34;myfunction(myparameters);return false&#34;  \nonkeypress=&#34;myfunction(myparameters);return false&#34;&#62;Link&#60;/a&#62;\n</pre>\n<p>In most navigation scripts, <strong>myparameters</strong> is some sort of ID. The \nscript does something with that, and, should javascript be disabled, the browser simply\ntakes the user to the target the link points to.</p>\n<p>Easy and fully accessible &#8212; but bloated.</p>\n<h2>Leaner but not meaner</h2>\n<p>Let's be greedy. All we want to appear in our HTML is this:</p>\n<pre>&lt;a href="#target"&gt;Link&lt;/a&gt;</pre>\n<p>Impossible? No, actually it is rather easy. We need a helper, who adds the onclick and \nonkeypress handlers and we need to find the right ID somehow.</p>\n<p>Adding the event handlers is rather easy. Let's take this navigation for example:</p>\n<pre>\n&#60;ul id=&#34;mainnav&#34;&#62;\n	&#60;li&#62;&#60;a href=&#34;#why&#34;&#62;Why&#60;/a&#62;&#60;/li&#62;\n	&#60;li&#62;&#60;a href=&#34;#now&#34;&#62;Now&#60;/a&#62;&#60;/li&#62;\n	&#60;li&#62;&#60;a href=&#34;#brown&#34;&#62;Brown&#60;/a&#62;&#60;/li&#62;\n	&#60;li&#62;&#60;a href=&#34;#cow&#34;&#62;Cow&#60;/a&#62;&#60;/li&#62;\n&#60;/ul&#62;\n</pre>\n<p>To add the handlers to this one, we need to execute the following after the page\nhas loaded:</p>\n<pre>\n1  function init()\n2  {\n3   	if(document.getElementById &#38;&#38; document.createTextNode)\n4		{\n5			var mn=document.getElementById('mainnav');\n6			var as=mn.getElementsByTagName('a');\n7			for (var i=0;i&#60;as.length;i++)\n8			{\n9				as[i].onclick=function(){show(this);return false}\n10				as[i].onkeypress=function(){show(this);return false}\n11			}		\n12		}\n13 }\n</pre>\n<p>First, we check if the browser is capable of handling the <acronym title="World Wide Web\nConsortium">W3C</acronym> <acronym title="Document Object Model">DOM</acronym>(line 3). \nThen we grab the element with the ID <em>mainnav</em> (line 5) and get all the elements with \nthe name <em>A</em> that are inside this element &#8212; our links(line 6).</p>\n<p>Then we loop through these links (line 7 to 11) and add an <em>onclick</em> \n(line 8) and an <em>onkeypress</em> (line 9) handler to them, assigning both these \nhandlers a function that calls the function <em>show()</em> with the link object itself as \nthe parameter and ending with a <em>return false</em> to prevent the browser from jumping\nto the anchors after the script was executed. (line 8 and 9)</p>\n<p>After this loop is executed, all links in the navigation will call the function \n<em>show()</em> with the link object as the parameter.</p>\n<h2>Clickable, but what about the parameter?</h2>\n<p>The <em>this</em> we send onclick and onkeypress is a mighty tool. We can read \nall the attributes of the link from it. In our case, we need the url value of the link.\nThis means our function show() should do the following</p>\n<pre>\nfunction show(l){\n	var urldata=l.href;\n}\n</pre>\n<p>to retrieve the url data. Now, the only remaining issue, is that the url sent from\nthe browser is the complete one, whereas all we need is the last bit, the name of the \nID we'd like to manipulate.</p>\n<p>Regular Expressions help us there:</p>\n<pre>\nfunction show(l){\n	var urldata=l.href.match(/#(\w.+)/)[1];\n}\n</pre>\n<p>The variable <em>urldata</em> now contains the id that we want to manipulate (we checked\nthe url data for the hash character and matched the following word).</p>\n<h2>Ok, nice, but what then?</h2>\n<p>This is it, we turned the UL with the links into a javascript enhanced navigation, \nthat executes the function show() onclick and onkeypress. What we want to do with it, \nis ours to explore.</p><p>One quick example? OK:</p>\n<pre>\n&#60;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34; \n&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&#62;\n&#60;html dir=&#34;ltr&#34; xml:lang=&#34;en&#34; lang=&#34;en&#34;&#62;\n&#60;head&#62;\n	&#60;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=iso-8859-1&#34; /&#62; \n	&#60;title&#62;Showme hideme&#60;/title&#62;\n	&#60;script type=&#34;text/javascript&#34;&#62;\n		function init()\n		{\n			if(document.getElementById &#38;&#38; document.createTextNode)\n			{\n				var mn=document.getElementById('mainnav');\n				var as=mn.getElementsByTagName('a');\n				for (var i=0;i&#60;as.length;i++)\n				{\n					as[i].onclick=function(){show(this);return false}\n					as[i].onkeypress=function(){show(this);return false}\n				}		\n				hidem();\n			}\n		}  \n		function show(l)\n		{\n			hidem();\n			var id=l.href.match(/#(\w.+)/)[1];\n			document.getElementById(id).style.display='block';\n		}\n		function hidem()\n		{\n			for (var i=0;i&#60;document.getElementsByTagName('div').length;i++)\n			{\n				document.getElementsByTagName('div')[i].style.display='none';\n			}\n		}\n		window.onload=init;  \n	 &#60;/script&#62;\n&#60;/head&#62;\n&#60;body&#62;\n&#60;ul id=&#34;mainnav&#34;&#62;\n	&#60;li&#62;&#60;a href=&#34;#why&#34;&#62;Why&#60;/a&#62;&#60;/li&#62;\n	&#60;li&#62;&#60;a href=&#34;#now&#34;&#62;Now&#60;/a&#62;&#60;/li&#62;\n	&#60;li&#62;&#60;a href=&#34;#brown&#34;&#62;Brown&#60;/a&#62;&#60;/li&#62;\n	&#60;li&#62;&#60;a href=&#34;#cow&#34;&#62;Cow&#60;/a&#62;&#60;/li&#62;\n&#60;/ul&#62;\n&#60;div id=&#34;why&#34;&#62;...why data...&#60;/div&#62;\n&#60;div id=&#34;now&#34;&#62;...now data...&#60;/div&#62;\n&#60;div id=&#34;brown&#34;&#62;...brown data...&#60;/div&#62;\n&#60;div id=&#34;cow&#34;&#62;...cow data...&#60;/div&#62;\n&#60;/body&#62;\n&#60;/html&#62;\n</pre>\n<p>We added a new function called <em>hidem()</em> Which hides all the DIV elements \nin the document (granted, a crude approach, as you might want to use other DIVs).\nWe call this function in the <em>init()</em> function to hide all texts our navigation\npoints to (this could have been done in CSS, too, but that'll mean the page is not \naccessible, as it needs Javascript to show the text!). Then we call it again\nin our <em>show()</em> function to hide the last shown text (we could use a global \nvariable for that and spare us the looping, knock yourselves out). Then we retrieve \nthe ID via the regular expression, and show the DIV with this ID.</p>