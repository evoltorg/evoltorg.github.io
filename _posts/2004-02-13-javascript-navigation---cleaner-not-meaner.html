---
layout: post
permalink: javascript_navigation_cleaner_not_meaner
ratings: 11
avgrate: 4.3636
user: codepo8
real_name: "Chris Heilmann"
user_since: 29 Jul 2002
avatar: "/images/pictures/picture-35456.jpg"
article_count: 17
excerpt: "Javascript makes HTML more interactive and can increase usability. It can also mess up the markup code with loads of event handlers. Which is not at all necessary, as this example explains."
---
<p>It is common practise to enhance the user experience of an HTML document by</p>adding interactivity via Javascript. DHTML drop downs, tabs, layer navigations, </p>image slide shows and so on and so forth are scattered all over the web.</p> </p><h2>The times are changing</h2></p><p>In the days of the wild wild web, when browsers sported fours in their navigator </p>string many a bloated script was developed to make the pages come alive. Developers</p>followed the dark path of browser detection and implemented several different </p><acronym title="Document Object Model">DOM</acronym> solutions in parallel to support</p>every dodgy brower that claimed to understand CSS and Javascript.</p>Furthermore, they did the nasty by making the navigation <strong>dependent</strong> on</p>Javascript, rather than enhanced through it.</p></p><p>The times have changed, the browsers have matured and so should we. Accessibility </p>guidelines and <acronym title="Search engine optimisation">SEO</acronym> practises tell us</p>not to rely on Javascript, but neither do they forbid us to use it.</p></p><p>The trick is to use it wisely.</p></p><p>This article is not showing off any special javascript navigation treat, all it does is</p>to show a small trick that helps us keep our markup as clean as possible.</p></p><h2>The HTML structure</h2></p><p>Every Javascript enhanced navigation should provide a real link, to avoid dead links </p>should Javascript be turned off (if this is still news to you and you wonder why, read the superb <a href="http://www.evolt.org/links_javascript/">Links &#38; JavaScript Living Together in Harmony</a> article). Normally, this is achieved thus:</p></p><pre></p>&#60;a href=&#34;#target&#34; </p>onclick=&#34;myfunction(myparameters);return false&#34;&#62;Link&#60;/a&#62;</p></pre></p><p>If you want to ensure that your links are also usable for people without a mouse, add </p>an onkeypress handler.</p></p><pre></p>&#60;a href=&#34;#target&#34; </p>onclick=&#34;myfunction(myparameters);return false&#34;  </p>onkeypress=&#34;myfunction(myparameters);return false&#34;&#62;Link&#60;/a&#62;</p></pre></p><p>In most navigation scripts, <strong>myparameters</strong> is some sort of ID. The </p>script does something with that, and, should javascript be disabled, the browser simply</p>takes the user to the target the link points to.</p></p><p>Easy and fully accessible &#8212; but bloated.</p></p><h2>Leaner but not meaner</h2></p><p>Let's be greedy. All we want to appear in our HTML is this:</p></p><pre>&lt;a href="#target"&gt;Link&lt;/a&gt;</pre></p><p>Impossible? No, actually it is rather easy. We need a helper, who adds the onclick and </p>onkeypress handlers and we need to find the right ID somehow.</p></p><p>Adding the event handlers is rather easy. Let's take this navigation for example:</p></p><pre></p>&#60;ul id=&#34;mainnav&#34;&#62;</p>	&#60;li&#62;&#60;a href=&#34;#why&#34;&#62;Why&#60;/a&#62;&#60;/li&#62;</p>	&#60;li&#62;&#60;a href=&#34;#now&#34;&#62;Now&#60;/a&#62;&#60;/li&#62;</p>	&#60;li&#62;&#60;a href=&#34;#brown&#34;&#62;Brown&#60;/a&#62;&#60;/li&#62;</p>	&#60;li&#62;&#60;a href=&#34;#cow&#34;&#62;Cow&#60;/a&#62;&#60;/li&#62;</p>&#60;/ul&#62;</p></pre></p><p>To add the handlers to this one, we need to execute the following after the page</p>has loaded:</p></p><pre></p>1  function init()</p>2  {</p>3   	if(document.getElementById &#38;&#38; document.createTextNode)</p>4		{</p>5			var mn=document.getElementById('mainnav');</p>6			var as=mn.getElementsByTagName('a');</p>7			for (var i=0;i&#60;as.length;i++)</p>8			{</p>9				as[i].onclick=function(){show(this);return false}</p>10				as[i].onkeypress=function(){show(this);return false}</p>11			}		</p>12		}</p>13 }</p></pre></p><p>First, we check if the browser is capable of handling the <acronym title="World Wide Web</p>Consortium">W3C</acronym> <acronym title="Document Object Model">DOM</acronym>(line 3). </p>Then we grab the element with the ID <em>mainnav</em> (line 5) and get all the elements with </p>the name <em>A</em> that are inside this element &#8212; our links(line 6).</p></p><p>Then we loop through these links (line 7 to 11) and add an <em>onclick</em> </p>(line 8) and an <em>onkeypress</em> (line 9) handler to them, assigning both these </p>handlers a function that calls the function <em>show()</em> with the link object itself as </p>the parameter and ending with a <em>return false</em> to prevent the browser from jumping</p>to the anchors after the script was executed. (line 8 and 9)</p></p><p>After this loop is executed, all links in the navigation will call the function </p><em>show()</em> with the link object as the parameter.</p></p><h2>Clickable, but what about the parameter?</h2></p><p>The <em>this</em> we send onclick and onkeypress is a mighty tool. We can read </p>all the attributes of the link from it. In our case, we need the url value of the link.</p>This means our function show() should do the following</p></p><pre></p>function show(l){</p>	var urldata=l.href;</p>}</p></pre></p><p>to retrieve the url data. Now, the only remaining issue, is that the url sent from</p>the browser is the complete one, whereas all we need is the last bit, the name of the </p>ID we'd like to manipulate.</p></p><p>Regular Expressions help us there:</p></p><pre></p>function show(l){</p>	var urldata=l.href.match(/#(\w.+)/)[1];</p>}</p></pre></p><p>The variable <em>urldata</em> now contains the id that we want to manipulate (we checked</p>the url data for the hash character and matched the following word).</p></p><h2>Ok, nice, but what then?</h2></p><p>This is it, we turned the UL with the links into a javascript enhanced navigation, </p>that executes the function show() onclick and onkeypress. What we want to do with it, </p>is ours to explore.</p><p>One quick example? OK:</p></p><pre></p>&#60;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34; </p>&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&#62;</p>&#60;html dir=&#34;ltr&#34; xml:lang=&#34;en&#34; lang=&#34;en&#34;&#62;</p>&#60;head&#62;</p>	&#60;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=iso-8859-1&#34; /&#62; </p>	&#60;title&#62;Showme hideme&#60;/title&#62;</p>	&#60;script type=&#34;text/javascript&#34;&#62;</p>		function init()</p>		{</p>			if(document.getElementById &#38;&#38; document.createTextNode)</p>			{</p>				var mn=document.getElementById('mainnav');</p>				var as=mn.getElementsByTagName('a');</p>				for (var i=0;i&#60;as.length;i++)</p>				{</p>					as[i].onclick=function(){show(this);return false}</p>					as[i].onkeypress=function(){show(this);return false}</p>				}		</p>				hidem();</p>			}</p>		}  </p>		function show(l)</p>		{</p>			hidem();</p>			var id=l.href.match(/#(\w.+)/)[1];</p>			document.getElementById(id).style.display='block';</p>		}</p>		function hidem()</p>		{</p>			for (var i=0;i&#60;document.getElementsByTagName('div').length;i++)</p>			{</p>				document.getElementsByTagName('div')[i].style.display='none';</p>			}</p>		}</p>		window.onload=init;  </p>	 &#60;/script&#62;</p>&#60;/head&#62;</p>&#60;body&#62;</p>&#60;ul id=&#34;mainnav&#34;&#62;</p>	&#60;li&#62;&#60;a href=&#34;#why&#34;&#62;Why&#60;/a&#62;&#60;/li&#62;</p>	&#60;li&#62;&#60;a href=&#34;#now&#34;&#62;Now&#60;/a&#62;&#60;/li&#62;</p>	&#60;li&#62;&#60;a href=&#34;#brown&#34;&#62;Brown&#60;/a&#62;&#60;/li&#62;</p>	&#60;li&#62;&#60;a href=&#34;#cow&#34;&#62;Cow&#60;/a&#62;&#60;/li&#62;</p>&#60;/ul&#62;</p>&#60;div id=&#34;why&#34;&#62;...why data...&#60;/div&#62;</p>&#60;div id=&#34;now&#34;&#62;...now data...&#60;/div&#62;</p>&#60;div id=&#34;brown&#34;&#62;...brown data...&#60;/div&#62;</p>&#60;div id=&#34;cow&#34;&#62;...cow data...&#60;/div&#62;</p>&#60;/body&#62;</p>&#60;/html&#62;</p></pre></p><p>We added a new function called <em>hidem()</em> Which hides all the DIV elements </p>in the document (granted, a crude approach, as you might want to use other DIVs).</p>We call this function in the <em>init()</em> function to hide all texts our navigation</p>points to (this could have been done in CSS, too, but that'll mean the page is not </p>accessible, as it needs Javascript to show the text!). Then we call it again</p>in our <em>show()</em> function to hide the last shown text (we could use a global </p>variable for that and spare us the looping, knock yourselves out). Then we retrieve </p>the ID via the regular expression, and show the DIV with this ID.</p>