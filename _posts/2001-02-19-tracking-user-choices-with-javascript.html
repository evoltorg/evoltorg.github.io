---
layout: post
permalink: node/5768
---
<p>I'm a JavaScript newbie.</p></p><p><p>Sure, I've read the tutorials at <a href="http://www.webmonkey.com" target="_blank">webmonkey</a>, and followed along through thread after thread on the mailing lists about 'how can I get my function to <em>insert task here</em>. But I never really <em>got it</em>. Up until last week, the most complex thing I'd ever done with JS was copying other people's scripts and adapting them ever so slightly to work on my page. I was beginning to become very discouraged, but ran into a problem that was just begging to be solved with JavaScript.</p></p><p><p>I live on Maui, and work as a freelancer running my own very small web-design studio. Most of my work is for local small businesses who are usually under-represented on the web and who typically lack both the resources and understanding to make full use of the internet in their business. My biggest challenge as a designer is making enough money to survive, working on projects with a shoestring budget. My other biggest challenge is pleasing clients, who feel like they are paying WAY TOO MUCH. From talking to other designers and having worked in a local web design company for a year, I know that my rates are incredibly reasonable and that this challenge will always be there when I work with local clients.</p></p><p><p><strong>Note:</strong> I am extremely open to working as a freelance designer/coder for other companies either here or on the mainland :)</p></p><p><p>Anyway, this amounts to fancy server side solutions (which I would just LOVE \n  to get into) being generally beyond the reach of many of the projects I am involved \n  with. I have a hard enough time selling clients on the fact that they need a \n  new website, much less needing to spend $20/month for PHP or ASP hosting. So, \n  I usually have to find a way to solve problems that is probably not the best \n  solution, but one that serves the purpose and does so cheaply and quickly and \n  requiring a minimum investment. Bummer, but don't feel to sorry for me...I have \n  it pretty good. :)</p></p><p><h2>The Problem I needed to solve...</h2>\n<p>Over the course of the past few months, I've been working on a site for a windsurfing company...<a href="http://www.simmerhawaii.com" target="_blank">Simmer Hawaii</a>. This has been a great job, because I somehow managed to talk the client into letting me do whatever I want with their site. When I proposed that the best way for them to be successful on the web is to continually add to the content of the site: they believed me. That means I get to work on this on an ongoing basis, earning pretty good $$ and getting fat discounts on new wave sails and beachwear every now and then.</p></p><p><p>One of the ideas we had was to add a <a href="http://www.simmerhawaii.com/travel" target="_blank">travel section</a> to the website. Part of \n  Simmer's business is renting windsurfing gear to vacationing windsurfers. If \n  you come to Maui to sail, you want to stay on the north shore, because that's \n  where all the sailing is. There aren't any resorts, there aren't any hotels, \n  there aren't any condos. On the north shore, you stay in private homes that \n  are maintained by their owners as vacation rentals. So, this accommodations \n  reality necessitated featuring many different vacation rental properties on \n  the website. We also figured there would be a great deal of value in adding \n  more keyword rich pages of content to the site.</p></p><p><p>The structure called for a hierarchy of pages, 'site &gt;&gt;  travel section &gt;&gt;  neighborhood \n  &gt;&gt; property/unit'. That's how we'd done it in the rest of the site, so we continued \n  to structure information that way. <a href="http://www.windsurfari.com" target="_blank">My \n  wife's company</a>, which specializes in vacation accommodations for windsurfers \n  on Maui's north shore agreed to provide content and handle the inquiries generated. \n  I have to mention this, because its another thing about the web that I'ma huge \n  advocate of: using the internet to bring unique businesses together to better \n  serve the customer public. In this arrangement, Simmer Hawaii gets a) more content \n  for their website, b) another service that they can offer their customers, c) \n  a small commission on each sale of a vacation. My wife's company gets a) exposure \n  for her product/company in another venue, b) more inquiries and an expanded \n  customer base, c) a small commission on each gear rental sale made, d) the chance \n  to show her vendors, 'look, I'm marketing you here too'. It's a win/win situation \n  and a model that I will continue to explore for my customers. But back to the \n  problem...</p></p><p><p>The idea behind presenting many options for vacation accommodations in the \n  travel section was to give visitors to the site as many choices as we can. Each \n  neighborhood features a number of properties representing a range of price, \n  size and level of luxury. Trouble is, visitors to the site are likely to want \n  to inquire about more than one property. I mean, sure that one-bedroom on the \n  beach at Sprecks might be good...but the studio in Paia is the same price and \n  closer to town. So, the problem was to provide a mechanism by which users could \n  add different properties to the list of those that they would inquire about, \n  and only make them fill out one form to inquire about them all. The limitations \n  were that the form gets submitted by CGI-email, because that's the only script \n  available through the <a href="http://www.maui.net/home" target="_blank">cheap-ass \n  web host</a></p></p><p><h2>The solution I came up with...</h2>\n<p>So, how to get those choices about different properties into the CGI-Email \n  form...I thought about listing each property/unit on the form with a checkbox \n  beside it and a link back to that property/unit so users could go back for reference. \n  That seemed a little cumbersome and less than elegant. What I really wanted \n  was a sort of 'shopping cart', to allow users to choose their properties <em>as \n  they browsed</em>. So, I figured if I could 1) put checkboxes next to each property \n  choice, 2) get the checkboxes to store a value, 3) retrieve the stored values \n  at the form, 4) use the stored values to print the user's choices into the \n  form as display text <em>and</em> form input...I'd be looking good. So, how \n  could I do it?</p></p><p><p>Because I'm a newbie, this seemed like a really complex thing to do. But it \n  turned out to be a really perfect 'first software development project'. The \n  first step is above...<em>define each step of what your script has to do.</em> \n  How can you write a function or anything until you know what you have to do \n  at each step? Since my first step called for checkboxes beside each property, \n  I started by building the property pages for each property/unit. I figured whatever \n  I came up with function-wise for step two would be the same for each page, and \n  just a matter of copy &amp; paste.</p></p><p><p>Step two required a way to store the values for the checked forms. Since most \n  people are terrified of cookies (and since writing 22 or so values into a cookie \n  seemed really daunting) I wanted to avoid them. Sort of overkill anyway, \n  since the state only needs to be remembered until they fill out the form. So, \n  I chose to split the travel section into frames...one frame for displaying the \n  content, one for storing the values of the checkboxes. My frameset code (index.html \n  in the /travel directory) looks like this:</p></p><p><pre>&lt;frameset rows=&quot;0,*&quot; cols=&quot;*&quot; framespacing=&quot;0&quot; \n    frameborder=&quot;0&quot;&gt;\n    &lt;frame src=&quot;frm_hidden_var_storage.html&quot; name=&quot;topFrame&quot; \n    id=&quot;topFrame&quot; frameborder=&quot;0&quot; scrolling=&quot;No&quot; \n    noresize marginwidth=&quot;0&quot; marginheight=&quot;0&quot;&gt;\n    &lt;frame src=&quot;travel.html&quot; name=&quot;mainFrame&quot; id=&quot;mainframe&quot; \n    frameborder=&quot;0&quot; scrolling=&quot;Auto&quot; noresize marginwidth=&quot;0&quot; \n    marginheight=&quot;0&quot;&gt;\n    \n    &lt;/frameset&gt;\n    &lt;noframes&gt;\n    &lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot; topmargin=&quot;0&quot; \n    marginheight=&quot;0&quot;&gt;\n    Sorry, you can't see frames...this site wasn't built for you.\n    &lt;/body&gt;\n    &lt;/noframes&gt;</pre></p><p><p>Note: The framset puts the page where the values are stored <em>on top</em>. This \n  is imperative. Otherwise, the page in the bottom of the frameset is trying to \n  access objects that don't exist yet. You'll see what I'm talking about when \n  I get into the functions that make it work...</p></p><p><p>All that's on the page 'frm_hidden_var_storage.html' is a form with 22 &lt;input \n  type="hidden" name="[name that corresponds with a property/unit]" \n  value="false"&gt;. When a user checks a checkbox, a function changes \n  the value of that property/unit's &lt;input type="hidden"... to true. \n  Like this:</p></p><p><pre>   function updateValue(propName) { \n    var hideyElement = eval('parent.topFrame.document.form1.' + propName.name);\n    hideyElement.value = propName.checked;\n    }</pre></p><p><p>This function is called by the onClick event handler on the checkbox...onClick="updateValue(this);". \n  In the first line, I make a variable called hideyElement. Now, I had help with \n  this part from Erik Mattheis. I don't really understand why I have to eval the \n  string 'parent.topFrame.document.form1.' before concatenating the argument.name \n  to it, but it didn't' work when I did it the other way...var hideyElement = \n  parent.topFrame.document.form1.propName.name;...I got an error telling me that \n  ' parent.topFrame.document.form1.propName' is null or not an object. The conceptual \n  difference between what JS thinks of as an object, and what it thinks of as \n  a string is more than I can currently grasp. But thanks to <a href="http://lists.evolt.org/mailman/listinfo/thelist" target="_blank" title="Thelist info, opens in a new window">thelist</a>, I was able \n  to get beyond this point in spite of my limited understanding. The argument \n  passed to the function is a reference to the checkbox itself. It is important \n  to note that each checkbox in the site has a name attribute that is exactly \n  the same as the name attribute for it's corresponding &lt;input type="hidden"... \n  in the hidden frame. That way, my function can just plug the name value from \n  the checkbox into the variable that references the hidden input on the other \n  page and change that objects value attribute to the checked value of the checkbox. \n  Following? Since 'true' is the value of the checkbox when its checked, I can \n  change the value of the hidden input to the checked value of the checkbox, and \n  it evaluates to changing the hidden inputs' value to 'true'.</p></p><p><p>That was easy enough...now to get those values printed on the page in a useful \n  format...</p></p><p><p>One of the very first lessons in my JavaScript tutorials in Danny Goodman's \n  'JavaScript Bible' (a resource I highly recommend to any newbie wanting to get \n  their feet wet in JS) deals with looping through an array. Since that intuitively \n  seemed like the way to get all the values from my hidden inputs, and then do \n  something based on those values, I started by making an array to loop through:</p></p><p><pre> var AllProperties = new Array(22);\n    AllProperties[0] = parent.topFrame.document.form1.tavares_bay_home;\n    AllProperties[1] = parent.topFrame.document.form1.tropical_hideaway;\n    AllProperties[2] = parent.topFrame.document.form1.rays_hanawi;\n    AllProperties[3] = parent.topFrame.document.form1.rays_mauna;\n    AllProperties[4] = parent.topFrame.document.form1.rays_lua_pele;\n    AllProperties[5] = parent.topFrame.document.form1.paia_studio;\n    AllProperties[6] = parent.topFrame.document.form1.kehau;\n    AllProperties[7] = parent.topFrame.document.form1.kai_hale;\n    AllProperties[8] = parent.topFrame.document.form1.hookipa_bayview;\n    AllProperties[9] = parent.topFrame.document.form1.hale_lea_lea1;\n    AllProperties[10] = parent.topFrame.document.form1.hale_lea_lea2;\n    AllProperties[11] = parent.topFrame.document.form1.hale_lea_lea3;\n    AllProperties[12] = parent.topFrame.document.form1.hale_kulani1;\n    AllProperties[13] = parent.topFrame.document.form1.hale_kulani2;\n    AllProperties[14] = parent.topFrame.document.form1.hale_kulani3;\n    AllProperties[15] = parent.topFrame.document.form1.hale_kulani4;\n    AllProperties[16] = parent.topFrame.document.form1.hale_kulani5;\n    AllProperties[17] = parent.topFrame.document.form1.aqua_terra1;\n    AllProperties[18] = parent.topFrame.document.form1.aqua_terra2;\n    AllProperties[19] = parent.topFrame.document.form1.aqua_terra3;\n    AllProperties[20] = parent.topFrame.document.form1.aina_lani1;\n    AllProperties[21] = parent.topFrame.document.form1.aina_lani2;</pre></p><p><p>This array is just a list of all of the &lt;input type="hidden"... \n  objects on the other, hidden page in the frameset. These objects are the objects \n  whose values were changed from their default (false) to true in the checkbox \n  updateValue(propName) function. So now that I have them in an array, I can loop \n  through that array and find all of the values that are true, like this:</p></p><p><pre> for (var i = 0; i &lt; AllProperties.length ; i++){\n    if (AllProperties[i].value == &quot;true&quot;){...</pre></p><p><p>This is one of the most basic constructs in any programming language, what \n  it does is to make a variable (i), set it to 0. Then it compares the variable \n  to some other statement, in this case, the length of the AllProperties array \n  (AllProperties.length), and increments the variable 'i' by one. So, the loop \n  will run as many times as i &lt; the length of the AllProperties array. And \n  the value of 'i' always corresponds with an index number of a 22 item array. \n  Every time it runs, it does something:</p></p><p><pre> var linkStr = &quot;&lt;a href=\&quot;&quot; + PropLinks[i] + &quot;.html\&quot; \n    target=\&quot;_self\&quot;&gt;&quot;\n    document.write(linkStr + PageProperties[i] + &quot;&lt;/a&gt;&lt;br&gt;&quot;)\n    }</pre></p><p><p>It makes a variable that contains a string ( "&lt;a href=\""), \n  since I wanted my selected properties to display on the page not merely as text, \n  but as links back to that properties page in the site. That calls for another \n  array item, PropLinks[i]. PropLinks[i] is another array I made to serve as a \n  sort of lookup table for the first array. Its like the AllProperties array, \n  except that instead of holding a list of objects, it holds a list of strings \n  that when inserted into this function are included in the output string. So \n  basically, &lt;a href=\"" + PropLinks[i] + ".html\" target=\"_self\"&gt;\n  comes out as "&lt;a href=" + "prop_apagesname" + ".html \n  target="self"&gt;". That way, I can write a link back to the \n  associated, chosen property as I write that chosen property into the page for \n  display, which happens in the 2nd line. That takes carefully canceling out the \n  right quotation marks, so my attributes in the <a> tag are properly quoted. \n  The variable linkStr (which is constructed by pulling items out of an array \n  of link values) builds the opening &lt;a&gt; tag. Another array's value (with \n  the same index, 'i' as the other arrays) gets written in next, then the link \n  tag is closed and a line break inserted by adding"&lt;/a&gt;&lt;br&gt;".</p>\n<p>This gets done for each 'true' value in the hidden inputs on the hidden frame \n  page. Cool, so that's how I get the list of links back to the selected properties.</p>\n<p>But I also needed to get those values into my CGI-email form...</p>\n<p>So, I made another array that contained the values that I want to pass to CGIemails \n  text template. It's just another array of strings called PageProperties. It's \n  values get inserted into the page like this:</p></p><p><pre>&lt;script&gt;\n    &lt;!--\n    for (var i = 0; i &lt; AllProperties.length ; i++){\n    if (AllProperties[i].value == &quot;true&quot;){\n    var inputStr1 = &quot;&lt;input type=\&quot;hidden\&quot; value=\&quot;&quot;\n    var inputStr2 = &quot;\&quot; name=\&quot;&quot;\n    document.write(inputStr1 +\n    PageProperties[i] + \n    inputStr2 + \n    AllProperties[i].name + \n    &quot;\&quot;&gt;&quot;)\n    }\n    }\n    //--&gt;\n    &lt;/script&gt;</pre></p><p><p>This is really no different than the other output loop, except that it creates \n  hidden input fields in the form to pass the dynamically generated values to \n  CGI-Email's text template. Each time through the loop, the function creates \n  a ' &lt;input type="hidden" name="AllProperties[i]Name" \n  value="PageProperties[i]"&gt;. Then, in the text template for cgi-email, \n  I have a 'accommodations preferences:' field that has little [] slots for each \n  of the AllProperties array items...pretty simple.</p></p><p><h2>Yes...it does leave a lot to be desired...</h2></p><p><p>So, it's not foolproof. I had to put a function to bust the frames on all of \n  the pages in the site that are not in the /travel section, otherwise, if you \n  followed a link from the travel section to another area of the site and then \n  went back, you'd be in a double frame. Since I did that, if you check some properties \n  while you're browsing, then go look at the sail line or women's swimsuits and \n  come back to the travel section...your checked values are gone. And I still \n  have to write a function that checks the boxes if you check it once, leave the \n  page, and then go back. And if you have JS turned of, it doesn't work. But like \n  I said at the beginning of the article, it doesn't have to be a foolproof solution, \n  just good enough to solve the problem with a minimum investment of resources. \n  The client is happy because the inquiries we get now have information about \n  which properties the inquirer was interested in. The user is happy because they \n  only have to fill out one form, and can go back to the properties they checked \n  while filling out the form. I'm happy because I learned more about planning \n  and building web sites/web applications.</p></p><p><p>Thanks!</p>