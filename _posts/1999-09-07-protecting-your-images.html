---
layout: post
permalink: node/421
---
<p>Don't want people stealing your images off your site?</p></p><p><p>Well here is a solution I implemented for a client, that makes the\nonly way to grab your image is thru a screen grab (see example\n     <a href="http://www.ematchcorp.com/test/" target="_blank">here</a>).</p></p><p><p>Now this is not an absolute solution to the problem since there isn't\none, but this is best way I've been able to implement todate, without\nadding watermarks to the images.</p></p><p><p>There are two parts to this implementation.</p></p><p><p>First you require a cgi script (see image.pl below) that: 1/ checks to\nsee if it's your page calling the image (using HTTP_REFERER) as you\nsee I'll allow any page from the /test/directory to qualify. If you\nuse another CGI ensure you explicity disallow it from qualifying. 2/\npipes your protected image from a safe directory 3/ ensures that the\nbrowser won't cache the image file by setting both the PRAGMA and\nEXPIRES headers. (even try viewing using page info)</p></p><p><p>Next part to the solution is to use javascript (see code in html\nexample below) in your page to ensure the user can't use the image\nsave feature by: 1/ loading a dumby image which appears when ever the\nmouse is over the image, thereby disabling the right mouse, save image\nas. 2/ using javascript to load the desired image, then swapping it\nwith the dumby once loaded and whenever the mouse is NOT over the\nimage.</p></p><p><p>Now also remember that your dumby image size has to be the same as the\nimage you want to display, now this wasn't a problem for me since I\nensured all of my clients photgraphs were the same size.</p></p><p><pre>====  image.pl ===========\n#!/perl\nrequire &quot;Cgi-lib.pl&quot;;\n&amp;ReadParse(*search);\nif ($ENV{'HTTP_REFERER'} =~ m#http://www.ematchcorp.com/test/# ) {\n  $expires='Expires: Wed, 26 Feb 1997 08:21:57 GMT\n';\n  $pragma='Pragma: no-cache';\n  $tmpfile=&quot;c:\\inetpub\\www\\ematch\\images\\$search{'file'}&quot;;\n  open( FROM, &quot;&lt; $tmpfile&quot; );\n  binmode FROM;\n  binmode STDOUT;\n# Print out the contents of the image file.\n  print &quot;Content-type: image/$search{'type'}\n&quot;;\n  print $expires,&quot;\n&quot;;\n  print $pragma,&quot;\n&quot;; print &quot;\n&quot;;</p><p>  while (&lt;FROM&gt;) {\n    print $_;\n  } \n  close FROM;\n} else {\n  ## Unauthorized access\n  print &quot;Content-type: text/html</p><p>&quot;;\n  print &quot;&lt;html&gt;&lt;body&gt;copyrighted material&lt;/body&gt;&lt;/html&gt;\n&quot;;\n}\nexit;\n====== end image.pl======== </pre></p><p><pre>==== begin index2.html==========\n&lt;html&gt; &lt;head&gt; &lt;title&gt;image example&lt;/title&gt; &lt;/head&gt;\n&lt;script language='javascript'&gt;\nfunction ImageLoad() {\n  window.status=&quot;Image cache test&quot;;\n  iFake = new Image ();\n  iFake.src = 'loader.gif';\n  iReal = new Image ();\n  iReal.src = '/cgi/image.pl?type=jpeg&amp;file=img0064.jpg';\n  document.images['slide'].src=iReal.src;\n}\n&lt;/script&gt;\n&lt;body onload='ImageLoad();'&gt;\n&lt;a href=&quot;&quot; onMouseover=&quot;document.images['slide'].src=iFake.src;&quot; onMouseout=&quot;document.images['slide'].src=iReal.src;&quot;&gt; &lt;img src=&quot;loader.gif&quot; name='slide' border=15&gt;   &lt;/a&gt;\n&lt;/body&gt; &lt;/html&gt;\n=========end index2.html ====== </pre>