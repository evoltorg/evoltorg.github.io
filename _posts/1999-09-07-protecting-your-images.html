---
layout: post
permalink: node/421
ratings: 0
avgrate: 
category: Code
user: mashton
real_name: "Mike Ashton"
user_biog: ""
user_since: 30 Aug 1999
avatar: 
article_count: 2
excerpt: "Don\'t want people stealing your images off your site?  Well here is a solution I implemented for a client, that makes the</p>only way to grab your image is thru a screen grab (see example here)."
---
<p>Don't want people stealing your images off your site?</p></p><p><p>Well here is a solution I implemented for a client, that makes the</p>only way to grab your image is thru a screen grab (see example</p>     <a href="http://www.ematchcorp.com/test/" target="_blank">here</a>).</p></p><p><p>Now this is not an absolute solution to the problem since there isn't</p>one, but this is best way I've been able to implement todate, without</p>adding watermarks to the images.</p></p><p><p>There are two parts to this implementation.</p></p><p><p>First you require a cgi script (see image.pl below) that: 1/ checks to</p>see if it's your page calling the image (using HTTP_REFERER) as you</p>see I'll allow any page from the /test/directory to qualify. If you</p>use another CGI ensure you explicity disallow it from qualifying. 2/</p>pipes your protected image from a safe directory 3/ ensures that the</p>browser won't cache the image file by setting both the PRAGMA and</p>EXPIRES headers. (even try viewing using page info)</p></p><p><p>Next part to the solution is to use javascript (see code in html</p>example below) in your page to ensure the user can't use the image</p>save feature by: 1/ loading a dumby image which appears when ever the</p>mouse is over the image, thereby disabling the right mouse, save image</p>as. 2/ using javascript to load the desired image, then swapping it</p>with the dumby once loaded and whenever the mouse is NOT over the</p>image.</p></p><p><p>Now also remember that your dumby image size has to be the same as the</p>image you want to display, now this wasn't a problem for me since I</p>ensured all of my clients photgraphs were the same size.</p></p><p><pre>====  image.pl ===========</p>#!/perl</p>require &quot;Cgi-lib.pl&quot;;</p>&amp;ReadParse(*search);</p>if ($ENV{'HTTP_REFERER'} =~ m#http://www.ematchcorp.com/test/# ) {</p>  $expires='Expires: Wed, 26 Feb 1997 08:21:57 GMT</p>';</p>  $pragma='Pragma: no-cache';</p>  $tmpfile=&quot;c:\\inetpub\\www\\ematch\\images\\$search{'file'}&quot;;</p>  open( FROM, &quot;&lt; $tmpfile&quot; );</p>  binmode FROM;</p>  binmode STDOUT;</p># Print out the contents of the image file.</p>  print &quot;Content-type: image/$search{'type'}</p>&quot;;</p>  print $expires,&quot;</p>&quot;;</p>  print $pragma,&quot;</p>&quot;; print &quot;</p>&quot;;</p><p>  while (&lt;FROM&gt;) {</p>    print $_;</p>  } </p>  close FROM;</p>} else {</p>  ## Unauthorized access</p>  print &quot;Content-type: text/html</p><p>&quot;;</p>  print &quot;&lt;html&gt;&lt;body&gt;copyrighted material&lt;/body&gt;&lt;/html&gt;</p>&quot;;</p>}</p>exit;</p>====== end image.pl======== </pre></p><p><pre>==== begin index2.html==========</p>&lt;html&gt; &lt;head&gt; &lt;title&gt;image example&lt;/title&gt; &lt;/head&gt;</p>&lt;script language='javascript'&gt;</p>function ImageLoad() {</p>  window.status=&quot;Image cache test&quot;;</p>  iFake = new Image ();</p>  iFake.src = 'loader.gif';</p>  iReal = new Image ();</p>  iReal.src = '/cgi/image.pl?type=jpeg&amp;file=img0064.jpg';</p>  document.images['slide'].src=iReal.src;</p>}</p>&lt;/script&gt;</p>&lt;body onload='ImageLoad();'&gt;</p>&lt;a href=&quot;&quot; onMouseover=&quot;document.images['slide'].src=iFake.src;&quot; onMouseout=&quot;document.images['slide'].src=iReal.src;&quot;&gt; &lt;img src=&quot;loader.gif&quot; name='slide' border=15&gt;   &lt;/a&gt;</p>&lt;/body&gt; &lt;/html&gt;</p>=========end index2.html ====== </pre>