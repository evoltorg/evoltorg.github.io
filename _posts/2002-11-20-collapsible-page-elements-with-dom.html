---
layout: post
permalink: node/45831
ratings: 12
avgrate: 4.1667
rating: 4.09
categories: [Code]
user: codepo8
real_name: "Chris Heilmann"
user_biog: "Currently employed in London as a Lead Front End Developer, Chris has been bouncing around the globe working for several agencies and companies. A web enthusiast from 1997 on workplaces include Munich, London, Santa Monica and San Francisco. 
More of Chris' writings can be found at http://icant.co.uk and he blogs at http://wait-till-i.com"
user_since: 29 Jul 2002
avatar: /images/pictures/picture-35456.jpg
article_count: 17
excerpt: "This article shows you how to use DOM Javascript to create collapsible elements in an HTML  document. It explains the basics how to do them and how to make them accessible for older browsers."
---
<h2>Show me, hide me</h2></p><p>Sometimes you want to enable surfers to hide and show elements of a document, whether it be to reveal extra information about a subject or to allow them to get rid of right hand navigation.</p></p><p>In older DHTML scripts this was done by adding an ID to the element to access its visibility property</p></p><code></p>&#60;script language=&#34;javascript&#34; type=&#34;text/javascript&#34;&#62;<br></p>&#60;!--<br></p>// Evil Netscape and IE 4.x function<br></p>function show(id,trigger){<br></p>	if (trigger==1){<br></p>		if (document.layers) document.layers[id].visibility = &#34;show&#34;<br></p>		else if (document.all) document.all[id].style.visibility = &#34;visible&#34;<br></p>	}else{<br></p>		if (document.layers) document.layers[id].visibility = &#34;hide&#34;<br></p>		else if (document.all) document.all[id].style.visibility = &#34;hidden&#34;<br></p>	}<br></p>}<br></p>//--&#62;<br></p>&#60;/script&#62;<br></p>&#60;a href=&#34;javascript:show('myText',1)&#34;&#62;Show&#60;/a&#62; <br></p>&#60;a href=&#34;javascript:show('myText',0)&#34;&#62;Hide&#60;/a&#62;<br></p>&#60;div id=&#34;myText&#34;&#62;Test&#60;/div&#62;<br></p></code></p><p>These functions did not collapse or expand the DIV, but just hide it. Furthermore in Netscape they only worked on absolutely positioned elements. A different way of doing that for newer browsers is by accessing the display attribute of the div.</p></p><pre>&#60;script language=&#34;javascript&#34; type=&#34;text/javascript&#34;&#62;</p>&#60;!--</p>// DOM function for >4 browsers</p>function show(id,trigger){</p>	if (trigger==1){document.getElementById(id).display=&#34;block&#34;;}</p>	else{document.getElementById(id).display=&#34;none&#34;;}</p>	}</p>}</p>//--&#62;</p>&#60;/script&#62;</p>&#60;a href=&#34;javascript:show('myText',1)&#34;&#62;Show&#60;/a&#62; </p>&#60;a href=&#34;javascript:show('myText',0)&#34;&#62;Hide&#60;/a&#62;</p>&#60;div id=&#34;myText&#34;&#62;Test&#60;/div&#62;</p></pre></p><p>This way of showing and hiding actually deletes the DIV from the display, making content below it jump further up.</p></p><p>Now this enables us to show and hide, or in this case, collapse and expand a part of the page using its ID. However, this can be pretty tiring, as each element we add to the document needs a unique ID and a link to point to it. Furthermore we need a link for showing and one for hiding. It would be a lot handier to have a link with, for example, a "+" next to it that hints that it is an expandable element. Clicking it would turn the "+" into a "-" and show the collapsed element. Clicking the link again would hide the element and turn the "-" into a "+".</p></p><h2>Climbing down the node tree</h2></p><p><acronym title="Document Object Model">DOM</acronym> allows us to do exactly that, if we use some straight forward  <acronym title="Hypertext Markup Language">HTML</acronym>.</p></p><p>Let's say we want a menu with collapsible elements in it. The HTML is:</p></p><pre></p>&#60;style type=&#34;text/css&#34;&#62;#menu div {display:none;}&#60;/style&#62;</p>&#60;div id=&#34;menu&#34;&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(0)&#34;&#62;+ Test1&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test 1&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(1)&#34;&#62;+ Test2&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test 2&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(2)&#34;&#62;+ Test3&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test3&#60;/div&#62;</p>&#60;/div&#62;</p></pre></p><p>We use the H5 tags to be able to access the links later. Otherwise it gets a lot harder to access the "+" in the link text. We set the display of each DIV to none to collapse them.</p></p><p>To access the menu we use <code>document.getElementById("menu")</code>, to access the collapsible elements we use <code>document.getElementById("menu").getElementsByTagName("div")</code>.</p></p><p>We can then count through the DIVs to access one of them, read its display attributes and reverse it.</p></p><pre></p>&#60;script language=&#34;javascript&#34; type=&#34;text/javascript&#34;&#62;</p>&#60;!--</p>function show(which){</p>	m=document.getElementById(&#34;menu&#34;);</p>	trig=m.getElementsByTagName(&#34;div&#34;).item(which).style.display;</p>	if (trig==&#34;block&#34;) trig=&#34;none&#34;;</p>	else if (trig==&#34;&#34;    trig==&#34;none&#34;) trig=&#34;block&#34;;</p>	m.getElementsByTagName(&#34;div&#34;).item(which).style.display=trig;</p>}</p>//--&#62;</p>&#60;/script&#62;</p>&#60;style type=&#34;text/css&#34;&#62;#menu div {display:none;}&#60;/style&#62;</p>&#60;div id=&#34;menu&#34;&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(0)&#34;&#62;+ Test1&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test 1&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(1)&#34;&#62;+ Test2&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test 2&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(2)&#34;&#62;+ Test3&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test3&#60;/div&#62;</p>&#60;/div&#62;</p></pre></p><p>Clicking the "Test 1" link (calling <code>show(0)</code>) now does the following:</p></p><ul></p><li>First line: Access the element with the ID "menu"</li></p><li>Second line: Access the first DIV (computers start counting at zero) in the menu and read its display attribute. </li></p><li>Third and fourth line: If the attribute is "none", it gets set to "block" and vice versa.</li> </p><li>Fifth line: Assign the changed attribute to the first DIV.</li></p></ul></p><p>This now enables us to show and hide the elements when clicking on the links, however, it does not change the "+" to "-" yet.</p></p><p>To do this we need to go through the node tree and access the link's text value</p></p><pre></p>&#60;script language=&#34;javascript&#34; type=&#34;text/javascript&#34;&#62;</p>&#60;!--</p>function show(which){</p>	m=document.getElementById(&#34;menu&#34;);</p>	trig=m.getElementsByTagName(&#34;div&#34;).item(which).style.display;</p>	if (trig==&#34;block&#34;) trig=&#34;none&#34;;</p>	else if (trig==&#34;&#34;    trig==&#34;none&#34;) trig=&#34;block&#34;;</p>	m.getElementsByTagName(&#34;div&#34;).item(trigger).style.display=trig;</p><p>	var highlighttext=&#34;-&#34;;</p>	varnormaltext=&#34;+&#34;;</p>	t=m.getElementsByTagName(&#34;h5&#34;).item(which);</p>	h=t.getElementsByTagName(&#34;a&#34;).item(0).firstChild;</p>	if (trig==&#34;none&#34;){h.nodeValue=h.nodeValue.replace(highlighttext,normaltext);}</p>	else {h.nodeValue=h.nodeValue.replace(normaltext,highlighttext);}</p>}</p>//--&#62;</p>&#60;/script&#62;</p>&#60;style type=&#34;text/css&#34;&#62;#menu div {display:none;}&#60;/style&#62;</p>&#60;div id=&#34;menu&#34;&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(0)&#34;&#62;+ Test1&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test 1&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(1)&#34;&#62;+ Test2&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test 2&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;javascript:show(2)&#34;&#62;+ Test3&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;Test3&#60;/div&#62;</p>&#60;/div&#62;</p></pre></p><p>We define two variables called "highlighttext" and "normaltext". These are the "-" for the expanded state and the "+" for the collapsed state.</p></p><p>Then we access the link elements inside the H5 on the same level as the DIV we expanded or collapsed, <code>t=m.getElementsByTagName(&#34;h5&#34;).item(which);</code>.</p></p><p>Inside this H5 we access the first A (item 0) and get its first child element, which is the text value of the link, <code>h=t.getElementsByTagName(&#34;a&#34;).item(0).firstChild;</code></p></p><p>We get the nodeValue of this child and, depending on which display is desired, we replace "+" (normaltext) with "-"(highlighttext) or vice versa.</p></p><p>Voila, we have accessed our collapsible page elements without using or adding IDs to them. For each DIV we add to the menu, we simply count up its number (Test 4 would be accessed via show(3) ).</p><p>However, this function only works in IE above 4 and Mozilla / Netscape above 6. Opera does know the getElementByID functionality but does not implement it properly. We need to think about something to make the content available to every browser.</p></p><p><h2>Helping the less fortunate</h2></p><p>The first thing we have to prevent happening is Netscape 4.x, Internet Explorer 4 and Opera trying to access the function and fail to make it work.</p></p><p>This can be done by wrapping it in a condition that checks for a functionality neither Netscape nor Opera have, but the others have.<br /></p><code>if (document.getElementById && document.createTextNode){}</code>,<br /></p>around the main function does the trick.</p></p><p>Then we need to ensure that the hidden DIVs are getting displayed for these browsers. We do that with the same condition, and by adding a new style rule overwriting the old one.</p></p><code></p>if (!document.getElementById && !document.createTextNode){<br></p>document.write('&#60;style type="text/css"&#62;#menu div{display:block;}&#60;/style&#62;')<br></p>}</p></code></p><p>The same hack should get applied when people do have the correct browsers, but have JavaScript disabled:</p></p><code></p>&#60;noscript&#62;&#60;style type="text/css"&#62;#menu div{display:block;}&#60;/style&#62;&#60;/noscript&#62;</p></code>	</p><p>And finally to make sure that all the horrid <code>href="javascript:"</code> links become working examples without javascript, we add a named anchor in each DIV, and link to that one.</p></p><code></p>&#60;h5&#62;&#60;a href="#test1" onclick="show(0)"&#62;+ Test1&#60;/a>&#60;/h5&#62;<br></p>&#60;div&#62;&#60;a name="test1"&#62;&#60;/a&#62;Test 1&#60;/div&#62;</p></code></p><p>That's all. We now have collapsible elements that work in every browser that supports DOM, and the others can still access all the data.</p></p><h2>The whole code</h2></p><pre></p>&#60;script language=&#34;javascript&#34; type=&#34;text/javascript&#34;&#62;</p>&#60;!--</p>function show(which){</p>	if (document.getElementById && document.createTextNode){</p>		m=document.getElementById(&#34;menu&#34;);</p>		trig=m.getElementsByTagName(&#34;div&#34;).item(which).style.display;</p>		if (trig==&#34;block&#34;) trig=&#34;none&#34;;</p>		else if (trig==&#34;&#34;    trig==&#34;none&#34;) trig=&#34;block&#34;;</p>		m.getElementsByTagName(&#34;div&#34;).item(which).style.display=trig;</p>		var	highlighttext=&#34;-&#34;;</p>		var	normaltext=&#34;+&#34;;</p>		t=m.getElementsByTagName(&#34;h5&#34;).item(which);</p>		h=t.getElementsByTagName(&#34;a&#34;).item(0).firstChild;</p>		if (trig==&#34;none&#34;){h.nodeValue=h.nodeValue.replace(highlighttext,normaltext);}</p>		else {h.nodeValue=h.nodeValue.replace(normaltext,highlighttext);}</p>	}</p>} </p>//--&#62;</p>&#60;/script&#62;</p>&#60;style type=&#34;text/css&#34;&#62;#menu div {display:none;}&#60;/style&#62;</p>&#60;!-- Backward compatibility hacks --&#62;</p>	&#60;noscript&#62;</p>		&#60;style type=&#34;text/css&#34;&#62;#menu div{display:block;}&#60;/style&#62;</p>	&#60;/noscript&#62;	</p>	&#60;script language=&#34;JavaScript&#34;&#62;</p>	&#60;!--</p><p>	if (!document.getElementById && !document.createTextNode){</p>		document.write('&#60;style type=&#34;text/css&#34;&#62;#menu div{display:block;}&#60;/style&#62;')</p>	}</p>	//--&#62;</p>	&#60;/script&#62;</p>&#60;!-- Backward compatibility hacks end --&#62;</p>&#60;div id=&#34;menu&#34;&#62;</p>	&#60;h5&#62;&#60;a href=&#34;#test1&#34; onclick=&#34;show(0)&#34;&#62;+ Test1&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;&#60;a name=&#34;test1&#34;&#62;&#60;/a&#62;Test 1&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;#test2&#34; onclick=&#34;show(1)&#34;&#62;+ Test2&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;&#60;a name=&#34;test2&#34;&#62;&#60;/a&#62;Test 2&#60;/div&#62;</p>	&#60;h5&#62;&#60;a href=&#34;#test3&#34; onclick=&#34;show(2)&#34;&#62;+ Test3&#60;/a&#62;&#60;/h5&#62;</p>	&#60;div&#62;&#60;a name=&#34;test3&#34;&#62;&#60;/a&#62;Test3&#60;/div&#62;</p>&#60;/div&#62;</p></pre></p><p>Of course you can access some other elements of this HTML to make the effect even more obvious. You can change the colour or background of the links according to their "highlight" or "normal" state.</p></p><p>To see and download a fully functional and a bit enhanced version of this effect to use, go to <a href="http://www.onlinetools.org/tools/domcollapsedata/" title="Fully functional and downloadable version of the script. Opens in a new window." target="_blank">this page</a>.</p></p><p>I have to thank Scott Benish, Craig Saila and Scott Andrew LePera  of the webdesign-L mailing list for testing and enhancement tips.</p>