---
layout: post
permalink: node/20059
ratings: 6
avgrate: 3.5000
category: Code
user: Martin Tsachev
real_name: "Martin Tsachev"
user_biog: "<p>Martin Tsachev started using computers
in 1992, programming Basic and has since
then developed a great passion for them.
</p>

<p>Nowadays he runs
<a href=\"http://www.mtdev.com\" rel=\"nofollow\" target=\"_blank\"
title=\"mtdev covers PHP, Python, JavaScript, and Linux shell scripts\">
mtdev</a> - a web site with highlight on PHP.
</p>"
user_since: 27 Jun 2001
avatar: /images/pictures/picture-12535.jpg
article_count: 6
excerpt: "Ever wanted to know what the visitors of your site think? Well wonder no more because with the help of PHP and MySQL this is a piece of cake. In this article I will explain how you can collect your visitors\' opinions about a topic you (or somebody else) is interested in."
---
<h2>Introduction</h2></p><p><p>Ever wanted to know what the visitors of your site think? Well, wonder no more because with the help of</p><a href="http://www.php.net/" title="PHP - Hypertext Preprocessor (Opens in a new window)" target="_blank">PHP</a> and</p><a href="http://www.mysql.com/" title="MySQL (Opens in new window)" target="_blank">MySQL</a> this is a piece of cake. In this article, I will explain how you can collect your visitors' opinions about a topic you (or somebody else) is interested in.</p></p></p><p><h3>What do you need:</h3></p><p><ul></p><li>PHP - obviously you know this from the title, right?<br></p>	Get it from <a href="http://www.php.net/" title="PHP - Hypertext Preprocessor (Opens in new window)" target="_blank">www.php.net</a>, available in source or binary for free.</li></p><li>MySQL - here we store the data. You should probably be able to use some other database also with a few modifications.<br></p>Download from <a href="http://www.mysql.com/" title="MySQL (Opens in new window)" target="_blank">www.mysql.com</a>. It is available through a GPL license in source or binary.</li></p><li>Apache or some other web server to test it all, and a hosting service for permanent storage.<br></p>You can get Apache from <a href="http://httpd.apache.org/" target="_blank" title="Apache Web Server (Opens in new window)">httpd.apache.org</a> for free. Source and binaries are available.</li></p></ul></p><p><p>So, I don't think you have to spend any money to get this wonderful software package, and you should be ready to go if you already have them.</p></p><p><h3>What are you expected to already know:</h3></p><p><ul></p><li>XHTML/HTML of course, after all this is what PHP sends the browser.</li></p><li>CSS - basic knowledge, if you like to control the way things look.</li></p><li>JavaScript - for client-side validation, not needed if you want to only check on the server-side, which is a lot slower and higher network load.</li></p><li>PHP - this is not a PHP tutorial, just an example. At least basic knowledge is needed.</li></p><li>MySQL - you have to create the database and tables or let someone else do it for you.</li></p></ul></p><p><h2>A word about the configurations</h2></p><p><p>I use a .htaccess file to setup PHP. If you have any trouble using the code try using these settings. If you get escaped quotes (like \' instead of ') you should use <code>magic_quotes_gpc = off</code> in php.ini or paste the following contents into a .htaccess file (or whatever it's called on your server). This should be in the directory where your code is, or in its parent directory.</p></p></p><p><pre></p>php_value arg_separator.output &quot;&amp;amp;&quot;</p>php_value arg_separator.input &quot;&amp;&quot;</p>php_flag register_globals off</p>php_flag short_open_tag off</p>php_flag magic_quotes_gpc off</p></pre></p><p><h2>Getting started</h2></p><p><h3>Globally included code</h3></p><p><pre></p>function connect_db() {</p>	global $link;</p><p>	$db_host = &quot;localhost&quot;;</p>	$db_username = 'username';</p>	$db_pass = 'password';</p>	$db_name = 'database_name';</p><p>	$link = @mysql_connect($db_host, $db_username, $db_pass)</p>		or die (&quot;Could not connect to database&quot;);</p>	@mysql_select_db ($db_name)</p>		or die (&quot;Could not select database&quot;);</p>}</p></pre></p><p><p>This is a function that connects to the database; I put this in a file that's included from every page at the site. If you think you don't understand anything you should check out the PHP manual. The <code>@</code> in front of the functions is used to suppress the default error messages if you can't connect to the database.</p></p></p><p><pre></p>&lt;?php</p>	if ( !isset($link) )</p>		connect_db();</p>	$res = @mysql_query(&quot;select count from poll where id=0&quot;)</p>		or die(&quot;Query cm p0 failed&quot;);</p>	$result = mysql_fetch_object($res);</p><p>	$poll = (int) $HTTP_GET_VARS['poll'];</p>	if ( ($poll &lt; 1) or ($poll &gt; $result-&gt;count) ) {</p>		mt_srand ((double) microtime() * 1000000);</p>		$poll = mt_rand(1,$result-&gt;count);</p>	}</p>?&gt;</p></pre></p><p><p>Connect to the database if no connection is established yet, and get the total number of polls available. Check if a GET variable <code>poll</code> has been passed. If negative or greater than the number of polls, this is an illegal value so get a random one.</p></p></p><p><pre></p>&lt;form method=&quot;get&quot; action=&quot;poll.php&quot; onsubmit=&quot;return validateVote(this.vote)&quot;&gt;</p>&lt;table border=&quot;0&quot; summary=&quot;poll inputs&quot;&gt;</p><p>&lt;?php</p>	$res = @mysql_query(&quot;select title, count, last from poll where id=$poll&quot;)</p>		or die(&quot;Query poll failed&quot;);</p>	$result = mysql_fetch_object($res);</p>?&gt;</p>	&lt;tr&gt;&lt;td>&lt;?php echo $result->title?>&lt;/td>&lt;/tr></p>&lt;?php</p>	$total = $result-&gt;count;</p>	$date = $result-&gt;last;</p><p>	$res = @mysql_query(&quot;select text, vote from poll_data where id=$poll&quot;)</p>		or die(&quot;Query poll_data failed&quot;);</p>	while ($row = mysql_fetch_object ($res)) {</p>		$input ='&lt;input type=&quot;radio&quot; name=&quot;vote&quot; value=&quot;' . $row-&gt;vote . '&quot; /&gt;';</p>    		echo &quot;&lt;tr&gt;&lt;td>$input $row->text&lt;/td>&lt;/tr>&quot;;</p>	}</p>?&gt;</p>	&lt;tr&gt;&lt;td>Total&amp;#160;votes:&amp;#160;&lt;?php echo $total?>&lt;/td>&lt;/tr></p>	&lt;tr&gt;&lt;td>Last&amp;#160;vote:&amp;#160;&lt;?php echo $date?>&lt;/td>&lt;/tr></p>	&lt;tr&gt;&lt;td>&lt;input type=&quot;submit&quot; value=&quot;Vote&quot; />&#160;&#160;&#160;</p>		&lt;a href=&quot;poll.php?poll=&lt;?php echo $poll?&gt;&quot; title=&quot;View the current poll results&quot;&gt;Results&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;</p>&lt;/table&gt;</p>	&lt;div&gt;</p>	&lt;input type=&quot;hidden&quot; id=&quot;poll&quot; name=&quot;poll&quot; value=&quot;&lt;?php echo $poll?&gt;&quot; /&gt;&lt;/div&gt;</p>&lt;/form&gt;</p></pre></p><p><p>This one defines the form which is submitted to the polls handling page, in my case <code>poll.php</code>. Get the poll title, total vote count, and the last time someone voted. Then iterate over each option and create a <code>radio input</code> for all of them. Finally display the total votes, last voted date, a</p><code>submit input</code> for voting and a link to the results (if somebody doesn't want to vote). We also pass the poll id to the poll handler. This can also be implemented with session variables but see first if PHP is compiled with <code>--enable-trans-sid</code>. If yes, then it is safe, otherwise your option is to pass the <code>SID</code> constant, but this is essentially the same.</p></p></p><p><p>Now for the client-side validation function that is run <code>onsubmit</code>.</p></p><p><pre></p>function validateVote( vote ) {</p>	valid = false;</p>	for ( var i = 0; i &lt;  vote.length; i++ ) {	// Opera 5.05 Linux does not support for/in on this object</p>		if ( vote[i].checked ) {</p>			valid = true;</p>			break;</p>		}</p>	}</p>	if ( ! valid ) {</p>		alert(&quot;You must choose one&quot;);</p>	}</p>	return valid;</p>}</p></pre></p><p><p>Well, that's all for the include code (this is usually shown on every page). The only other thing you may consider is protecting the file that holds the db username and password, in case PHP isn't there to process the code with something like this in a .htaccess file:</p></p></p><p><pre></p>&lt;Files &quot;my_db_password_in_here.php&quot;&gt;</p>    Order deny,allow</p>    Deny from all</p>&lt;/Files&gt;</p></pre></p><p><p>Now to get our hands on the input handling code.</p></p><p><h3>The Poll Handling Code</h3></p><p><pre></p>&lt;?php</p>	require &quot;global_includes_file.php&quot;;</p>	if ( !isset($link) )</p>		connect_db();</p><p>	$res = @mysql_query(&quot;select count from poll where id=0&quot;)</p>		or die(&quot;Query polls failed&quot;);</p>	$result = mysql_fetch_row($res);</p>	$polls = $result[0];</p><p>	$poll = (int) $HTTP_GET_VARS['poll'];</p>	if ( $poll &gt; $polls or $poll &lt; 1 )</p>		$poll = 1;</p></pre></p><p><p>Include a <code>global_includes_file.php</code> and check if a link to the database is established. Get the number of polls from the db and check if there is a GET passed variable <code>poll</code>. If not just display the first.</p></p></p><p><pre></p>	$poll_voted = (int) $HTTP_COOKIE_VARS['voted'];</p>	$poll_bit = ( 1 &lt;&lt; $poll );</p>	if ( !($poll_voted &amp; $poll_bit) ) {</p>		$poll_ok = true;</p>	} else {</p>		$poll_ok = false;</p>	}</p><p>	$vote = (int) $HTTP_GET_VARS['vote'];</p>	if ( $poll_ok and $vote &gt; 0 and $vote &lt; 6 ) {	//	count the vote</p>		$cookie_voted = $poll_voted   $poll_bit;</p>		setcookie('voted', $cookie_voted, time()+2592000);	// one month time</p>		@mysql_query(&quot;update poll set count=count+1, last=now() where id=$poll&quot;)</p>			or die('Query p2 failed');</p>		@mysql_query(&quot;update poll_data set count=count+1 where id=$poll and vote=$vote&quot;)</p>			or die('Query p3 failed');</p>	}</p></pre></p><p><p>Now we do not require visitors to register, just to vote. Don't just allow them to vote again and again (except if they erase the cookies, but that's another story). Definitely require registration (there's an article on</p><a href="/article/Creating_a_Login_Script_with_PHP_4/17/19661/index.html" title="Creating a Login Script With PHP 4 (Opens in a new Window)" target="_blank">Creating a login script with PHP 4</a> by</p><a href="/user/jesteruk/19107/index.html" title="Jester UK's evolt.org Bio Page" target="_blank">Jester uk</a>) Be sure to read the article, if this is your case.</p></p></p><p><p>To get by on cookies, get one called <code>voted</code>, if available, and check whether the user has already voted for this poll. Get the vote that is handled; here's an example of some hard-coded variables that you may wish to get rid of, if you think there may be a different number of answers to one question. Check whether he/she is allowed to vote and if the vote is ok, and set a cookie that will stay for one month to keep track that the user has voted (not that he/she cannot use another browser or just delete the cookie, but anyway).</p></p></p><p><p>To finish the voting update the total number of votes and the current choice (increment by one). I'm not quite sure if MySQL applies some locking and other stuff</p>when you pass the queries this way, but this is definitely safer than extracting the value from the database and then explicitly setting it to a value that is incremented in PHP.</p></p></p><p><pre></p>	function my_esc($input) {</p>		return mysql_escape_string( htmlspecialchars($input, ENT_QUOTES) );</p>	}</p><p>	if ( $HTTP_SERVER_VARS['REQUEST_METHOD'] == 'POST' ) {</p>		$comment = my_esc($HTTP_POST_VARS['fComments']);</p>		$subject = my_esc($HTTP_POST_VARS['fSubject']);</p>		$name = my_esc($HTTP_POST_VARS['fName']);</p>		if ( $name == '' )</p>			$name = 'anonymous';</p>		$email = my_esc($HTTP_POST_VARS['fEmail']);</p>		$poll = (int) $HTTP_POST_VARS['poll'];</p><p>		if ( $comment != '' )</p>			@mysql_query("insert into comments (name, subject, email, comment, date, poll) values('$name', '$subject', '$email', '$comment', now(), $poll)")</p>				or die('Query add comments failed');</p>	}</p></pre></p><p><p>Define a function that should escape the HTML and SQL if some <em>smarty</em> guy has decided to pass it to see what can happen. I'm not quite sure if this name is OK according to the PHP coding standards but anyway it's short and convenient, think up something else if you want. This is where you should change the code if you definitely want <code>magic_quotes_gpc = on</code>.</p></p></p><p><p>Check if any POSTing has happened, if so escape all the variables passed, and instead of displaying nothing replace the name with &quot;anonymous.&quot; If any comments have been POSTed we are ready to <code>insert</code> that in the database.</p></p></p><p><pre></p>	begin_head();</p>?&gt;</p>&lt;meta name=&quot;description&quot; content=&quot;Poll results and comments&quot; /&gt;</p>&lt;title&gt;Think up one&lt;/title&gt;</p>&lt;?php</p>	begin_body()</p>?&gt;</p></pre></p><p><p>That's supposing you have a function called <code>begin_head()</code> that prints the document type declaration and stuff. Remember we used cookies, so nothing but headers should have been printed until now. The other function begins the body and prints some headers (like navbar or logo, etc.).</p></p></p><p><pre></p>&lt;h1&gt;Poll results and comments&lt;/h1&gt;</p>&lt;?php</p>	if ( !$poll_ok and $vote )</p>		echo &quot;&lt;p&gt;You are not allowed to vote again&lt;/p&gt;&quot;;</p><p>	$res = @mysql_query(&quot;select title, count, last from poll where id=$poll&quot;)</p>		or die(&quot;Query c2 failed&quot;);</p>	$result = mysql_fetch_object($res);</p>	echo &quot;&lt;h2&gt;$result-&gt;title&lt;/h2&gt;&quot;;</p>	$total = $result-&gt;count;</p>	$date = $result-&gt;last;</p><p>?&gt;</p></pre></p><p><p>Print the first level header of the page and a message that the user is not allowed to vote again, if they've tried. Query the database to get the title, total count and last vote date for the current poll. I know &quot;the query failed&quot; messages are not user friendly, unfortunately I found that out long after I started using this code.</p></p></p><p><pre></p>&lt;table border=&quot;0&quot; cellspacing=&quot;5&quot; summary=&quot;votes statistics&quot;&gt;</p>&lt;?php</p>	$res = @mysql_query(&quot;select text, count from poll_data where id=$poll&quot;)</p>		or die(&quot;Query c3 failed&quot;);</p>	if ( mysql_num_rows($res) == 0 ) {</p>		echo &quot;&lt;tr&gt;&lt;td&gt;&lt;p&gt;Sorry still nothing in here&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&quot;;</p>	} else {</p>		while ($row = mysql_fetch_object ($res)) {</p>			$share = round(100 * $row-&gt;count / $total, 2);</p>				echo &quot;&lt;tr&gt;&lt;td&gt;$row-&gt;text&lt;/td&gt;&lt;td&gt;$share%&#160;($row-&gt;count)&lt;/td&gt;&lt;/tr&gt;&quot;;</p>		}</p>	}</p>?&gt;</p>&lt;/table&gt;</p>&lt;p&gt;</p>Total&#160;votes:&#160;&lt;?php echo $total?&gt;&lt;br /&gt;</p>Last&#160;vote:&#160;&lt;?php echo $date?&gt;</p>&lt;/p&gt;</p></pre></p><p><p>Print a table with the poll results, if any. Otherwise a message will be shown, which is needed. Without it you will get a division by zero error when calculating the percentage share of each choice.</p></p></p><p></p><pre></p>&lt;h2&gt;Other polls&lt;/h2&gt;</p>&lt;?php</p>         $res = @mysql_query(&quot;select * from poll where id!=$poll and id!=0&quot;)</p>                 or die(&quot;Query c4 failed&quot;);</p>?&gt;</p>&lt;table border=&quot;0&quot; cellspacing=&quot;5&quot; summary=&quot;other polls&quot;&gt;</p>&lt;tr&gt;&lt;th&gt;Poll&lt;/th&gt;</p>     &lt;th&gt;Votes&lt;/th&gt;</p>     &lt;th&gt;Comments&lt;/th&gt;</p>&lt;/tr&gt;</p>&lt;?php</p>         while ($row = mysql_fetch_object ($res)) {</p>?&gt;</p>                 &lt;tr&gt;&lt;td&gt;&lt;a</p>href=&quot;poll.php?poll=&lt;?php echo &quot;$row-&gt;id&quot; .'&quot;&gt;' .</p>$row-&gt;title?&gt;&lt;/a&gt;&lt;/td&gt;</p>                 &lt;td&gt;&lt;?php echo $row-&gt;count?&gt;&lt;/td&gt;</p>                 &lt;td&gt;&lt;?php echo $row-&gt;comments?&gt;&lt;/td&gt;</p>                 &lt;/tr&gt;</p>&lt;?php</p>         }</p>?&gt;</p>&lt;/table&gt;</p></pre></p><p></p><p>Print a table with links to other polls to be viewed/voted for. Note the query <code>where .. and id!=0</code>. That's because I use <code>id=0</code> to store the total number of polls.</p></p></p><p></p><pre></p>&lt;h2&gt;Comments&lt;/h2&gt;</p>&lt;div&gt;</p>&lt;?php</p>	$res = @mysql_query(&quot;select name, subject, email, comment, date from comments where poll=$poll&quot;)</p>		or die(&quot;Query poll comments failed&quot;);</p>	if ( mysql_num_rows($res) == 0 ) {</p>		echo &quot;&lt;p&gt;Sorry still nothing in here&lt;/p&gt;&quot;;</p>	} else {</p>		while ($row = mysql_fetch_object ($res)) {</p>?&gt;</p>			&lt;div class=&quot;commenthead&quot;&gt;</p>				&lt;div class=&quot;subject&quot;&gt;&lt;?php echo $row-&gt;subject ?&gt;&lt;/div&gt;</p>				&lt;div class=&quot;info&quot;&gt;by &lt;a href=&quot;mailto:&lt;?php echo $row-&gt;email ?&gt;&quot;&gt;</p>					&lt;?php echo $row-&gt;name ?&gt;&lt;/a&gt;</p>					on &lt;?php echo gmdate('d M Y g:ia', strtotime($row-&gt;date)) ?&gt; UTC</p>				&lt;/div&gt;</p>			&lt;/div&gt;</p><p>			&lt;div class=&quot;comment&quot;&gt;</p>			&lt;?php echo $row-&gt;comment ?&gt;</p>			&lt;/div&gt;</p>&lt;?php</p>		}</p>	}</p>?&gt;</p>&lt;/div&gt;</p></pre></p><p><p>Now for the comments: get all for the current poll from the database (or if nothing is available say so). Iterate over each comment and print its subject. On the next line print the name provided (you may consider not creating it as a <code>mailto:</code> link because e-mail is optional) and the date and time. I know many people don't like UTC (that's Universal Coordinated Time, the once called GMT), but I think this is what should be used all over the Internet. Or print the GMT offset (though this is rarely seen). Many sites would rather print their local time, but this doesn't help people in different time zones.</p></p></p><p><pre></p>&lt;h2&gt;Say your mind&lt;/h2&gt;</p><p>&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $HTTP_SERVER_VARS['PHP_SELF']?&gt;&quot;</p>	onsubmit=&quot;return validateString(this.comment)&quot;&gt;</p>&lt;div&gt;&lt;input type=&quot;hidden&quot; name=&quot;poll&quot; value=&quot;&lt;?php echo $poll?&gt;&quot; /&gt;&lt;/div&gt;</p>&lt;div class=&quot;formwrapper&quot;&gt;</p><p>&lt;div class=&quot;row&quot;&gt;</p>	&lt;label for=&quot;fName&quot; title=&quot;Write down your name here( optional)&quot;&gt;Name:&lt;/label&gt;</p>	&lt;span&gt;&lt;input type=&quot;text&quot; name=&quot;fName&quot; id=&quot;fName&quot; size=&quot;25&quot;</p>		title=&quot;Write down your name here( optional)&quot; tabindex=&quot;1&quot; /&gt;&lt;/span&gt;</p>&lt;/div&gt;</p>&lt;div class=&quot;row&quot;&gt;</p>	&lt;label for=&quot;fEmail&quot; title=&quot;Write down your e-mail here( optional)&quot;&gt;E-mail:&lt;/label&gt;</p>	&lt;span&gt;&lt;input type=&quot;text&quot; name=&quot;fEmail&quot; id=&quot;fEmail&quot; size=&quot;25&quot;</p>		title=&quot;Write down your e-mail here( optional)&quot; tabindex=&quot;2&quot; /&gt;&lt;/span&gt;</p>&lt;/div&gt;</p>&lt;div class=&quot;row&quot;&gt;</p>	&lt;label for=&quot;fSubject&quot; title=&quot;Write down a short subject, maximum 60 chars&quot;&gt;Subject:&lt;/label&gt;</p>	&lt;span&gt;&lt;input type=&quot;text&quot; name=&quot;fSubject&quot; id=&quot;fSubject&quot; size=&quot;25&quot;</p>		title=&quot;Write down a short subject, maximum 60 chars&quot; tabindex=&quot;2&quot; /&gt;&lt;/span&gt;</p>&lt;/div&gt;</p>&lt;div class=&quot;row&quot;&gt;</p>	&lt;textarea cols=&quot;40&quot; rows=&quot;6&quot; name=&quot;fComments&quot; id=&quot;fComments&quot;</p>		title=&quot;Just write the message here&quot; tabindex=&quot;3&quot;&gt;&lt;/textarea&gt;</p>&lt;/div&gt;</p>&lt;div class=&quot;row&quot; style=&quot;padding-bottom : 10px;&quot;&gt;</p>	&lt;input type=&quot;submit&quot; value=&quot;Submit comment&quot; title=&quot;Submit the comment&quot; tabindex=&quot;4&quot; /&gt;</p>	&#160;</p>	&lt;input type=&quot;reset&quot; value=&quot;Clear form&quot; title=&quot;Clears the text box&quot; tabindex=&quot;5&quot; /&gt;</p>&lt;/div&gt;</p><p>&lt;/div&gt;</p>&lt;/form&gt;</p><p>&lt;p&gt;Note: All fields except the comments are optional. If you think not to write any comments, I don't</p>really think you should waste disk space for the db.</p>&lt;/p&gt;</p></pre></p><p><p>This is pretty straight forward XHTML so I don't think anyone should need an explanation. The function that handles <code>onsubmit</code> follows.</p></p></p><p><pre></p>function validateString(str) {</p>	if ( str.value &amp;&amp; str.value.length &gt; 0 ) return true</p>	else {</p>		alert(&quot;You don't think I can read your mind do you?&quot;);</p>		str.focus();</p>		return false;</p>	}</p>}</p></pre></p><p><h3>Database stuff</h3></p><p><p>I apologize for the mixed case database queries; MySQL doesn't care about it so I don't feel I need to type all keywords in uppercase. You first have to create the database and then use <code>mysql -p your_database_name &lt; this_code.sql</code> where <code>this_code.sql</code> is the filename you used to save the following SQL code.</p></p></p><p></p><pre></p>CREATE TABLE poll (</p>	id int NOT NULL auto_increment,</p>	title varchar(100) NOT NULL default '',</p>	count int NOT NULL default '1',</p>	last date,</p>	PRIMARY KEY  (id)</p>);</p><p>CREATE TABLE poll_data (</p>	id int NOT NULL default '0',</p>	text char(50) NOT NULL default '',</p>	count int NOT NULL default '1',</p>	vote tinyint NOT NULL default '0'</p>);</p><p>create table comments(</p>	name varchar(30) not null default '',</p>	subject varchar(50) not null default '',</p>	email varchar(30) not null default '',</p>	comment text not null default '',</p>	date datetime not null default '',</p>	poll int not null default '0',</p>);</p></pre></p><p><h3>Stylesheet</h3></p><p><p>You can use the following selectors in a stylesheet linked from the <code>poll.php</code>:</p></p></p><p><ul></p><li>div.formwrapper</li></p><li>div.row</li></p><li>div.row label</li></p><li>div.row span, you can make it div.row input if you clear up the code</li></p><li>div.commenthead</li></p><li>div.subject</li></p><li>div.comment</li></p></ul></p><p><h2>To finish up</h2></p><p><p>I don't claim this is the best code. You can tweak it a bit to get the result you want. If you need to get all the code at once instead of copy/pasting from the textareas, you can grab a <a href="http://members.evolt.org/shaggy/articles/polls_comments_with_PHP.zip" title="Download the .zip file">zip</a> file or a</p><a href="http://members.evolt.org/shaggy/articles/polls_comments_with_PHP.tgz" title="Download the gzipped Tarball">gzipped tarball</a> with it. You know linebreaks are not always where they have to be and stuff, but this prevents it and you know everything should be working right.</p></p>