---
layout: post
permalink: node/335
ratings: 2
avgrate: 4.0000
category: Backend
user: MartinB
real_name: "Martin Burns"
user_since: 26 Apr 1999
avatar: "/images/pictures/picture-32.jpg"
article_count: 143
excerpt: "Using ASP on a busy server? Finding that it can't cope? Try our tips for making everything run faster, smoother and altogether more froody.</p>Performance goals vary from application to application. Yo"
---
Using ASP on a busy server? Finding that it can't cope? Try our tips for making everything run faster, smoother and altogether more froody.<p></p>Performance goals vary from application to application. You should set your</p>goals to correspond with your expected user traffic. In general, you should</p>aim for 20 pages or more per second with less than 30 percent CPU</p>utilization, and response times of 10 seconds or less.</p><ul></p><li>Retrieving values from collections is relatively slow. Store retrieved</p>values in local variables if you need to access them more than once. </p><li>Avoid using server-side <code>#include</code> directives to include large lists of</p>constants.</p><li>Use the new <code>&lt;METADATA&gt;</code> tag to import type-library constants into</p>global.asa. </p><li>Avoid using <code>Server.CreateObject</code>. Use <code>&lt;OBJECT&gt;</code> tags instead. </p><li>Group multiple Response.Write statements, and delimit them with one set of</p><code>&lt;% %&gt;</code> delimiters. </p><li>Avoid redimensioning VBScript arrays. </p><li>Use only one scripting language per page. </p><li>Buffered responses (Response.Buffer=True) are faster than unbuffered ones</p>(although they can appear less responsive). </p><li>Use <code>Response.IsClientConnected</code> during the processing of long scripts. This</p>property determines if the client has disconnected from the server since the</p>last <code>Response.Write</code>, and improves application responsiveness during times of</p>peak usage. </p><li>Use components to encapsulate business logic rather than complex script. </p><lli>Convert dynamic ASP output to static HTML using the ASP2HTM component</p>wherever possible. (ASP2HTM is included on the Internet Information Server</p>(IIS) Resource Kit CD.) </p><li>Store commonly requested, unchanging content in memory using an</p>application-scope Dictionary object. </p>Avoid using Session_OnEnd event procedures, if possible. </p><li>Disable the Session object on a page-by-page basis with the <code>&lt;%@</p>EnableSessionState=False %&gt;</code> statement. This declarative allows ASP to</p>process scripts concurrently, rather than sequentially. </p><li>Write client scripts that don't require roundtrips to the server. Distribute</p>work to the client, such as form input validation. Use the Browser</p>Capabilities component (MSWC.BrowserType) and customize client-side scripts</p>to take advantage of the browser, incorporating such technologies as DHTML,</p>client-side script, and ActiveX? controls. </p><li>Focus your optimization efforts on the most common paths through your site</p>or application. You can determine user behavior with IIS service logs and</p>the Usage Import and Report Writer component of Site Server Express. </p><li>Set <code>Response.Expires</code> appropriately so that proxy servers can intelligently</p>cache information that doesn't change often. </p><li>Optimize the use of ADO Connection objects, with ODBC connection pooling and</p>stored procedures. </p><li>Measure system performance with tools such as Task Manager, NetMon, and</p>PerfMon. Measure Web capacity with WCAT. Profile portions of your ASP script</p>with the ASP Tracer component. For more information see the IIS Resource</p>Kit. </p><li>Try to keep one ASP page to One application.</p>Use SQL stored procedures wherever possible.</p></ul></p><p>These tips are culled from <a href='http://msdn.microsoft.com'>MSDN</a>, where there may be even more.