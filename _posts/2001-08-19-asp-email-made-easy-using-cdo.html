---
layout: post
permalink: node/14951
ratings: 1
avgrate: 4.0000
category: Code
user: burhankhalid
real_name: "Burhan Khalid"
user_biog: "I\'m a college student finishing up my Bachelor of Science degree at <a href=\"http://www.swosu.edu\" rel=\"nofollow\">Southwestern Oklahoma State University</a>. I generally try to help out at evolt, answering questions on the list, and occasionally writing an article or two. I am the current president of the computer club, the only computer science tutor, and the webmaster for our site. In addition to traveling around the world (I speak 5 languages), in my free time I like to fly (both sims and real aircraft), read, and play around on the internet.

<p>That was 8 years ago - now I\'m a IT consultant, e-commerce and Linux SME in Kuwait. I currently work for a large engineering consultancy firm where I am responsible for IT strategy for the company and consulting with client on their large-scale IT projects.</p>"
user_since: 08 Aug 2001
avatar: 
article_count: 3
excerpt: "Lots of people ask me what\'s the easiest way to send email from a web page, how can I do it with the least amount of trouble, etc. Here is what I tell them."
---
<p>Before you write one lick of code, think about these things :</p></p><p>Just because people have email accounts, that doesn't mean that you should have free reign and send them all sorts of nonsense. If you are going to ask for their email address, do not abuse it. Its akin to asking someone for their telephone number, or home address. What if everytime you told someone your phone number, you got calls from people you didn't know trying to tell you how they can get you a college diploma for $25? Not only that, you get these phone calls <em>up to 80</em> times a day? I understand that some people have websites up there that are running on whats called click-thru or reference dollars. If you have such a partnership, please have the decency to add a little footer telling people on how to opt out. And I don't mean that little footnote written in font size -1000 that would take a guy with a 32 inch plasma screen four microscopes to read. Well, enough about that. I trust we are all sensible netizens. You guys know what I'm talking about.</p><p>Now, on to the good stuff: how do I send mail from my webpage? If you are on any Microsoft platform, and you are scratching your head looking for a way to send email via ASP, let me introduce you to your new best friend.</p><p>drumroll....</p><p><strong>Collaboration Data Objects</strong> or CDO for short</p><p>What is CDO?</p><p>Simply put, CDO is a framework, a bridge if you will, that allows access to an email server. Using CDO, you can create and send messages using the SMTP (IIS 4.0) or through MAPI (MS Exchange Server) <em>more on this later</em>. But first, three lines of code to send email!</p></p><pre>&lt;%</p> Set mailHook =  Server.CreateObject("CDONTS.Newmail")</p> mailHook.Send "you@you.com","joe@target.com","Subject","Body"</p> Set mailHook = nothing</p>%&gt;</pre></p><p>That's it! --Instant email sending. But I know what you are thinking, "what the heck is <em><strong>CDONTS</strong></em>? He was just talking about CDO earlier." Fear not, read on.</p><p><strong>Two Versions of CDO</strong></p><p>There are two versions of CDO available from Microsoft. CDO 1.2 and CDO for NTS (NT Server). CDONTS is a trimmed down version of CDO 1.2 and is included with IIS 4 and 5. CDO 1.2 is the full blown version, and it is bundled with Microsoft Exchange Server. I believe that Microsoft has come out with newer versions of CDO for the 2K line of products, providing more functionality (or so they say), but more than likely, more bugs. So, I'd stick with 1.2 for now...till the first few rounds of Service Packs are out at least. What is the difference between the two? Nothing too serious on the outside, but the <strong>main</strong> way they differ is in their communication protocols. CDO uses the Microsoft Messaging Application Program Interface (MAPI) and CDONTS uses Simple Mail Transfer Protocol (SMTP). Below is a simple table of features that are supported on each.</p></p><p></p><table align=center width=100%><tr><td align=center><b>Table of Comparison</b></td></tr></table></p><table align=center width=100% border=1></p><tr bgcolor="#C0C0C0"></p><td align=center>Feature</td><td>CDO1.2</td><td>CDONTS</td></tr><tr><td>Protocol Used</td><td>MAPI</td><td>SMTP</td></tr></p><tr><td>Accessible with ASP?</td><td>Yes</td><td>Yes</td></tr><tr><td>NewMail Object?</td><td><strong>No</strong></td><td>Yes</td></tr><tr><td>Requires authenticated user login?</td><td>Yes</td><td><strong>No</strong></td></tr><tr><td>Supports remote access?</td><td>Yes</td><td><strong>No</strong></td></tr><tr><td>Supports multiple servers?</td><td>Yes</td><td><strong>No</strong></td></tr><tr><td>Provides calendars, filters, sorting?</td><td>Yes</td><td><strong>No</strong></td></tr><tr><td>Provides for writing to Message Object?</td><td>Yes</td><td>Yes</td></tr><tr><td>Provides for reading from Message Object?</td><td>Yes</td><td><strong>No</strong></td><tr><td>Renders messages in HTML for browser veiwing?</td><td>Yes</td><td><strong>No</strong></td></tr><tr><td>Uses HTML/MHTML for transmission of rich text and graphics?</td><td><strong>No</strong></td><td>Yes</td></tr></table></p><p><strong>Conclusion</strong></p><p>What was the point of all this you may ask? Well, simply put, ASP provides for easy integration of email capabilities into existing solutions through the use of Collaboration Data Objects. Think of it this way: you compile an ActiveX DLL that stores all your emailing code, with of course code that will filter, sort, etc. your mailing lists, and you have a powerful and fast (compiled DLLs are always faster than inline ASP) way of implementing email. So, the next time a user hobbles on to your site, you can provide customized content, interesting emails (err...), flyers that have your site updates included (hmm...), your schedule and when you are free (*scratches head*)...wait, why did I write this?! This is the perfect weapon for all those that want to mailbomb people! Come to think of it...maybe I should delete this thing...ah heck, I'll just send an email to have it done ;)</p></p><p>On a personal note, I was wondering if anyone had any ideas on how to implement a similar solution ... using PHP? <em>[This would make a great followup article --ed]</em></p></p><p></p><p>As always, I look forward to your replies, complaints, etc.</p>