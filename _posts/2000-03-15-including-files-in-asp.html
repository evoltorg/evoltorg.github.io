---
layout: post
permalink: node/1344
ratings: 7
avgrate: 4.4286
categories: [Code]
user: aardvark
real_name: "Adrian Roselli"
user_biog: "<p style=\"text-align:justify;\">
A founder of evolt.org, Adrian Roselli (aardvark) is the Senior Usability Engineer at <a href=\"http://algonquinstudios.com/\" rel=\"nofollow\" target=\"_blank\" title=\"Visit Algonquin Studios - Opens New Window\">Algonquin Studios</a>, located in Buffalo, New York.
</p>

<p style=\"text-align:justify;\">
Adrian has years of experience in graphic design, web design and multimedia design, as well as extensive experience in internet commerce and interface design and usability. He has been developing for the World Wide Web since its inception, and working the design field since 1993.  Adrian is a founding member, board member, and writer to evolt.org. In addition, Adrian  sits on the Digital Media Advisory Committee for a local SUNY college and a local private college, as well as the board for a local charter school.
</p>

<p style=\"text-align:justify;\">
You can see his brand-spanking-new blog at <a href=\"http://blog.adrianroselli.com/\" rel=\"\">http://blog.adrianroselli.com/</a> as well as his new web site to promote his writing and speaking at <a href=\"http://adrianroselli.com/\" rel=\"\">AdrianRoselli.com</a>
</p>

<p style=\"text-align:justify;\">
Adrian authored the usability case study for evolt.org in <a href=\"http://www.amazon.com/exec/obidos/ASIN/1904151035/ref=nosim/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Amazon, for one, is selling it; opens in new window.\"><em>Usability: The Site Speaks for Itself</em></a>, published by glasshaus. He has written three chapters for the book <a href=\"http://www.amazon.com/exec/obidos/ASIN/1590591712/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Amazon, for one, is selling it; opens in new window.\"><em>Professional Web Graphics for Non Designers</em></a>, also published by glasshaus. Adrian also managed to get a couple chapters written (and published) for <a href=\"http://www.amazon.com/exec/obidos/ASIN/159059200X/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Opens in new window.\"><em>The Web Professional\'s Handbook</em></a> before glasshaus went under. They were really quite good. You should have bought more of the books.
</p>"
user_since: 14 Dec 1998
avatar: /images/pictures/picture-88.gif
article_count: 85
excerpt: "As more people use Active Server Pages, I\'ve noticed a trend that newer users can\'t figure out how to include files into their scripts.  Part of the problem is that they expect an include directive to exist in the \'&lt;%\' and \'%&gt;\' script tags, but this isn\'t the case with Active ..."
---
<p></p>As more people use Active Server Pages, I've noticed a trend that newer users can't figure out how to include files into their scripts.  Part of the problem is that they expect an include directive to exist in the <code>'&lt;%'</code> and <code>'%&gt;'</code> script tags, but this isn't the case with Active Server Pages.  Instead, you'll notice the include directive is reminiscent of Apache, or other web servers that allow server-side includes.  As such, there are some rules to including files and keeping them from breaking your script that you have to keep in mind.  So let's jump right in...</p></p></p><p><p></p>To include files in ASP pages:</p></p></p><p><pre></p>&lt;!--#include virtual   file =&quot;filename&quot;--&gt;</p></pre></p><p><p></p>The <code>'virtual'</code> and <code>'file'</code> keywords indicate the type of path you are using to include the file, and 'filename' is the path and file name of the file you want to include.</p></p></p><p><p></p>Included files do not require a special file name extension; however, MS docs will recommend giving included files an <code>.inc</code> extension to distinguish them from other types of files.  I prefer to create a directory that contains all the files, and give them all an <code>.asp</code> extension.  If someone finds that directory and/or file name (which can happen if your ASP scripts break and it shows the offending code), then the ASP parser will execute the script within.  By default, the server will treat an <code>.inc</code> file as plain text and serve it as such.  Often my include files are functions or navigation, so the result is a blank screen or an odd HTML page if I use an <code>.asp</code> extension.  This prevents a user from seeing my code (which may include database connection information), and while it may generate an error, this is preferrable to showing all my script as plain text.</p></p></p><p><h2>Using the 'Virtual' Keyword</h2></p><p><p></p>Use the '<code>virtual</code>' keyword to indicate a path beginning with a virtual directory. For example, if a file named '<code>footer.inc</code>' resides in a virtual directory named '<code>/footer</code>,' the following line would insert the contents of '<code>footer.inc</code>' into the script containing the line:<br><br> <code>&nbsp;&nbsp;&lt;!--#include virtual ="/footer/footer.inc"--&gt;</code></p></p></p><p><h2>Using the 'File' Keyword</h2></p><p><p></p>Use the '<code>file</code>' keyword to indicate a relative path. A relative path begins with the directory that contains the including file. For example, if you have a file in the directory '<code>headers</code>', and the file '<code>header.inc</code>' is in '<code>root\headers</code>', the following line would insert <code>'header.inc'</code> into your script:<br><br> <code>&nbsp;&nbsp;&lt;!--#include file ="headers/header.inc"--&gt;</code></p></p></p><p><p></p>Note that the path to the included file, '<code>headers/header.inc</code>,' is relative to the including file; if the script containing this <code>#include</code> statement is not in the directory '<code>/root</code>', the statement would not work.</p></p></p><p><p></p>You can also use the file keyword with '<code>../</code>' syntax to include a file from a parent, or higher-level, directory if the 'Enable Parent Paths' option is selected in Internet Service Manager.</p></p></p><p><h2>Other Notes:</h2></p><p><ul></p> <li>You can have one include file include another.  A file cannot include the file including it, nor can it include itself.  That would be bad.</li></p> <li>The include file must not have open control structures, nor can it be used to close control structures. You can't start an '<code>if</code>' statement in your main page and have the corresponding '<code>end if</code>' in the included file. The include file has to be able to stand on its own.</li></p> <li>The ASP parser includes a file <em>before</em> executing any script commands. This means you can't put a variable in the filename and include files dynamically based on that variable's value.  You can, however, load the include into a SUB and call the SUB only if certain criteria are met. For instance:<br></p><pre></p>  &lt;% IF foo = &quot;bar&quot; THEN %&gt;</p>    &lt;!--#include file =&quot;include/bar.inc&quot;--&gt;</p>  &lt;% ELSE %&gt;</p>    &lt;!--#include file =&quot;include/foo.inc&quot;--&gt;</p>  &lt;% END IF %&gt;</p></pre></p>Will still load both include files into the ASP script, as opposed to only loading one of them.  However, a cleaner way to do this might be:<br></p><pre></p>  &lt;% IF foo = &quot;bar&quot; THEN</p>    BAR</p>  ELSE</p>    FOO</p>  END IF %&gt;</p><p>  &lt;% SUB FOO %&gt;</p>  &lt;!--#include file =&quot;include/foo.inc&quot;--&gt;</p>  &lt;% END SUB %&gt;</p><p>  &lt;% SUB BAR %&gt;</p>  &lt;!--#include file =&quot;include/bar.inc&quot;--&gt;</p>  &lt;% END SUB %&gt;</p></pre></li></p> <li>You must close your script tags before including a file.  For instance:<br></p><pre></p>  &lt;% SUB FOOTER %&gt;</p>  &lt;!--#include file =&quot;footers/footer.inc&quot;--&gt;</p>  &lt;% END SUB %&gt;</p></pre></p>Will work. However,<br></p><pre></p>  &lt;% SUB FOOTER</p>  &lt;!--#include file =&quot;footers/footer.inc&quot;--&gt;</p>  END SUB %&gt;</p></pre></p>Will not.</li></p></ul>