---
layout: post
permalink: camel-poop
ratings: 7
avgrate: 4.2857
user: khurtwilliams
real_name: "Khurt Williams"
user_since: 19 Dec 2002
avatar: "/images/pictures/picture-50921.jpg"
article_count: 1
excerpt: "Most people are not aware of the fact that Perl has support for object-oriented programming. If you've used another object-oriented programming language such as Java or C++ or been exposed to object-orientation then object oriented programming in Perl is nothing like that. To do real useful object-o"
---
<p>Most people are not aware of the</p>                            fact that Perl has support for</p>                            object-oriented programming. If</p>                            you've used another object-oriented</p>                            programming language such as Java or</p>                            C++ or been exposed to</p>                            object-orientation then object</p>                            oriented programming in Perl is</p>                            nothing like that. To do real useful</p>                            object-oriented programming in Perl</p>                            you only need to use a few simple</p>                            rules as put forth by Larry Wall in</p>                            Object Oriented Perl.</p>                          </p></p>                          <p></p>                            Object oriented programmers are</p>                            familiar with the concept of object</p>                            and classes but I will review that</p>                            here quickly. An object is a thing</p>                            that provides access to or</p>                            modification of data. A class is</p>                            description of the attributes of a</p>                            particular kind of object and the</p>                            manner in which those objects can be</p>                            accessed and modified. A method is a</p>                            means by which an object's data is</p>                            accessed or modified. An object is an</p>                            instance of a class.</p>                          </p></p>                          <p></p>                            An example would be a</p>                            Person class in an HR</p>                            system. The Person</p>                            class describes the attributes of an</p>                            Person such as name,</p>                            address, title, social security</p>                            number, id etc. A particular class</p>                            instance or object would encapsulate</p>                            data about a particular</p>                            Person e.g. name,</p>                            title, social security number,</p>                            address, etc. Some methods to access</p>                            that object's data would be name,</p>                            address etc.</p>                          </p></p><p>                            <h2>Package</p>                            delivery</h2></p>                            <p> To create a class in Perl we first</p>                            build a package. A package is a</p>                            self-contained unit of user-defined</p>                            variables and subroutines, which can</p>                            be re-used over and over again. They</p>                            provide a separate namespace within a</p>                            Perl program that keeps subroutines</p>                            and variables from conflicting with</p>                            those in other packages.</p>                          </p></p>                          <p></p>                            To declare a class named</p>                            Person in Perl we do:</p>                          </p></p><pre></p>package Person;</p></pre></p>                          <p></p>                            That's it. The scope of the <code>package</code></p>                            definition extends to the end of the</p>                            file, or until another <code>package</code></p>                            keyword is encountered. Not very</p>                            useful yet but on to the next</p>                            section.</p>                          </p></p><p>                            <h2>There's a method to</p>                            this madness</h2></p>                          <p></p>                             A method is a means by which an</p>                            object's data is accessed or</p>                            modified. In Perl a method is just a</p>                            subroutine defined within a</p>                            particular package. So to define a</p>                            method to print our</p>                            Person object we do:</p>                          </p></p><pre></p>sub print {</p>    my ($self) = @_;</p><p>    #print Person info</p>    printf("Name:%s %s</p><p>", $self-&gt;firstName, $self-&gt;lastName );</p>}</p></pre></p>                          <p></p>                            The subroutine print is now</p>                            associated with the package</p>                            Person. To call the</p>                            method print on an</p>                            Person object we use</p>                            the Perl &quot;arrow&quot; notation. If the</p>                            variable <code>$khurt</code> contains an</p>                            Person object we would</p>                            call print on that object by writing:</p>                          </p></p>                          <pre>$khurt-&gt;print();</pre> </p>                          <p></p>                            When the object method is invoked a</p>                            reference to the object is passed in</p>                            along with any other arguments. This</p>                            is important since the method now has</p>                            access to the object on which it to</p>                            operate.</p>                          </p></p>                          <p></p>                            How do we create the invoking object?</p>                          </p></p>                            <h2>Bless me</p>                            father</h2></p>                          <p></p>                             To create an instance of a class (an</p>                            object) we need an object</p>                            constructor. This constructor is a</p>                            method defined within the package.</p>                            Most programmers choose to name this</p>                            object constructor method <code>new</code> but in</p>                            Perl one can use any name.</p>                          </p></p>                          <p></p>                            One can use any kind of Perl variable</p>                            as an object in Perl. Most Perl</p>                            programmers choose either references</p>                            to arrays or hashes.</p>                          </p></p>                          <p></p>                            Let's create our constructor for our</p>                            Person class using a</p>                            Perl hash reference;</p>                          </p></p><pre></p>#constructor</p>sub new {</p>    my $self = {</p>        _firstName =&gt; undef,</p>        _lastName  =&gt; undef,</p>        _ssn       =&gt; undef,</p>        _address   =&gt; undef</p>    };</p>    bless $self, 'Person';</p>    return $self;</p>}</p></pre></p>                          <p></p>                            What have we done? We created a</p>                            subroutine called <code>new</code></p>                            associated with the package</p>                            Person. The entries of</p>                            the hash reference <code>$self</code></p>                            become the attributes of our object.</p>                            We then use the <code>bless</code> function</p>                            on the hash reference. The</p>                            <code>bless</code> function take two</p>                            arguments; a reference to the</p>                            variable to be marked and a string</p>                            containing the name of the class.</p>                            This indicates that the variable now</p>                            belongs to the class</p>                            Person.</p>                          </p></p>                          <p></p>                            To create an instance of our</p>                            Person object:</p>                          </p></p><pre></p>my $khurt = new Person();</p></pre></p>                          <p></p>                            We have not defined accessor methods</p>                            or done any error checking on the</p>                            input values or keys or the anonymous</p>                            hash reference but we have the start</p>                            of a Perl Person OO</p>                            framework. To make our constructor</p>                            more flexible and to make our class</p>                            inheritable (more on that later) we</p>                            can define it to use the</p>                            <code>$class</code> variable to bless</p>                            the hash reference.</p>                          </p></p><pre></p>#constructor</p>sub new {</p>    my ($class) = @_;</p>    my $self = {</p>        _firstName =&gt; undef,</p>        _lastName  =&gt; undef,</p>        _ssn       =&gt; undef,</p>        _address   =&gt; undef</p>    };</p>    bless $self, $class;</p>    return $self;</p>}</p></pre></p>                          <p></p>                            Other object-oriented languages have</p>                            the concept of security of the data</p>                            to prevent a programmer from changing</p>                            an objects data directly and so</p>                            provide accessor methods to modify</p>                            object data. Perl does not have</p>                            private variables but we can still</p>                            use the concept of accessor methods</p>                            and ask programmers to not mess with</p>                            our object innards.</p>                          </p></p>                          <p></p>                            For our Person class we</p>                            should provides accessor methods for</p>                            our object attributes; <code>name</code>, </p>							<code>address</code>,</p>                            <code>title</code>, <code>ssn</code>.</p>                          </p></p><pre></p>#class Person</p>package Person;</p>use strict;</p>use Address;    #Person class will contain an Address</p><p>#constructor</p>sub new {</p>    my ($class) = @_;</p>    my $self = {</p>        _firstName =&gt; undef,</p>        _lastName  =&gt; undef,</p>        _ssn       =&gt; undef,</p>        _address   =&gt; undef</p>    };</p>    bless $self, $class;</p>    return $self;</p>}</p><p>#accessor method for Person first name</p>sub firstName {</p>    my ( $self, $firstName ) = @_;</p>    $self-&gt;{_firstName} = $firstName if defined($firstName);</p>    return $self-&gt;{_firstName};</p>}</p><p>#accessor method for Person last name</p>sub lastName {</p>    my ( $self, $lastName ) = @_;</p>    $self-&gt;{_lastName} = $lastName if defined($lastName);</p>    return $self-&gt;{_lastName};</p>}</p><p>#accessor method for Person address</p>sub address {</p>    my ( $self, $address ) = @_;</p>    $self-&gt;{_address} = $address if defined($address);</p>    return $self-&gt;{_address};</p>}</p><p>#accessor method for Person social security number</p>sub ssn {</p>    my ( $self, $ssn ) = @_;</p>    $self-&gt;{_ssn} = $ssn if defined($ssn);</p>    return $self-&gt;{_ssn};</p>}</p><p>sub print {</p>    my ($self) = @_;</p><p>    #print Person info</p>    printf("Name:%s %s</p><p>", $self-&gt;firstName, $self-&gt;lastName );</p>}</p><p>1;</p><p></pre></p>                          <h2>Making</p>                          babies</h2></p>                           </p>                          <p></p>                            Object-oriented programming sometimes</p>                            involves inheritance. Inheritance</p>                            simply means allowing one class</p>                            called the <i>Child</i> to inherit</p>                            methods and attributes from another,</p>                            called the <i>Parent</i> one so you</p>                            don't have to write the same code</p>                            again and again. For example, we can</p>                            have a class Employee which inherits</p>                            from Person. This is an referred to</p>                            as an &quot;isa&quot; relationship because an</p>                            Employee is a Person. Perl has a</p>                            special variable, <code>@ISA</code>, to help with</p>                            this. <code>@ISA</code> which governs (method)</p>                            inheritance. So to create a new</p>                            Employee class that will inherit</p>                            methods and attributes from our</p>                            Person class we simply code:</p>                          </p></p><pre></p># class Employee</p>package Employee;</p>use Person;</p>use strict;</p>our @ISA = qw(Person);    # inherits from Person</p></pre></p>                          <p></p>                            What we have done is load the Person</p>                            class and declare that Employee class</p>                            inherits methods from it. We have</p>                            declared no methods for Employee but</p>                            an Employee object will behave just</p>                            like a Person object. We should be</p>                            able to write code:</p>                          </p></p><pre></p>#create Employee class instance</p>my $khurt =  new Employee();</p> </p>#set object attributes</p>$khurt-&gt;firstName('Khurt');</p>$khurt-&gt;lastName('Williams');</p></pre></p>                          without any other changes. </p>                          <p></p>                            Now let's add some methods.</p>                          </p></p><pre></p># class Employee</p>package Employee;</p>use Person;</p>use strict;</p>our @ISA = qw(Person);    # inherits from Person</p><p>#constructor</p>sub new {</p>    my ($class) = @_;</p><p>    #call the constructor of the parent class, Person.</p>    my $self = $class-&gt;SUPER::new();</p>    $self-&gt;{_id}   = undef;</p>    $self-&gt;{_title} = undef;</p>    bless $self, $class;</p>    return $self;</p>}</p><p>#accessor method for  id</p>sub id {</p>    my ( $self, $id ) = @_;</p>    $self-&gt;{_id} = $id if defined($id);</p>    return ( $self-&gt;{_id} );</p>}</p><p>#accessor method for  title</p>sub title {</p>    my ( $self, $title ) = @_;</p>    $self-&gt;{_title} = $title if defined($title);</p>    return ( $self-&gt;{_title} );</p>}</p><p>sub print {</p>    my ($self) = @_;</p><p>    # we will call the print method of the parent class</p>    $self-&gt;SUPER::print;</p>    $self-&gt;address-&gt;print;</p>}</p><p>1;</p></pre></p>                          <p></p>                            Looking at the code you will notice</p>                            that we have a <code>new</code></p>                            method and a <code>print</code></p>                            method. Both a Child class and its</p>                            Parent class have the same method</p>                            defined. We have overridden the</p>                            Parent class' methods with the ones</p>                            from the Child. When those methods</p>                            are called on an Employee object we</p>                            will get the Employee class' version</p>                            of the method. This concept of using</p>                            the methods of and existing object</p>                            and modifying them is known as</p>                            polymorphism.</p>                          </p></p>                            <h2>Putting it</p>                            together</h2></p><p>                          <p></p>                             So now we have a complete set of</p>                            classes we can write a small program</p>                            to test them.</p>                          </p></p><pre></p>use strict;</p>use warnings;</p>use diagnostics;</p>use Employee;</p><p>#create Employee class instance</p>my $khurt =  eval { new Employee(); }  or die ($@);</p> </p>#set object attributes</p>$khurt-&gt;firstName('Khurt');</p>$khurt-&gt;lastName('Williams');</p>$khurt-&gt;id(1001);</p>$khurt-&gt;title('Executive Director');</p><p>$khurt-&gt;address( new Address() );</p><p>$khurt-&gt;address-&gt;street('10 Anywhere Lane');</p>$khurt-&gt;address-&gt;city('Anytown');</p>$khurt-&gt;address-&gt;state('NJ');</p>$khurt-&gt;address-&gt;zip('12345');</p><p>#diplay Employee info</p>$khurt-&gt;print();</p></pre></p>                          <p></p>                            Let's execute our code and see the</p>                            output</p>                          </p></p><pre></p>$ ./test.pl</p>Name:Khurt Williams</p><p>Address: 10 Anywhere Lane</p>Anytown, NJ 12345</p></pre></p>                          <p></p>                            It works! We covered the basics of</p>                            object oriented programing in Perl.</p>                            I hope this article was</p>                            informative and useful.</p></p>