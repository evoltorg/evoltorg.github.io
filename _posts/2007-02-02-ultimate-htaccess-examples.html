---
layout: post
permalink: ultimate_htaccess_examples
---
<p><strong>Here's my list of the ultimate htaccess code snippets and examples that I use all the time.</strong>  I tried to keep them extremely minimalistic.</p>\n<p>Don't miss checking out my <a href="http://www.askapache.com/htaccess/ultimate-htaccess-file-sample.html">example htaccess file</a>, its very comprehensive</p></p><p>\n<blockquote cite="http://www.askapache.com/htaccess/apache-htaccess.html"><p>Hey <a href="http://www.askapache.com/htaccess/apache-htaccess.html">jason</a> I'm glad someone finally noticed the "development" htaccess at the bottom of my file!  Thats honestly the piece of code I am most glad to have.</p></blockquote></p><p></p><p><h2>Heres the actual code that I use when I'm developing sites for clients</h2>\n<p>This lets google crawl the page, lets me access the whole site (24.205.23.222) without a password, and lets my client access the page WITH a password.  It also allows for XHTML and CSS validation! (w3.org)</p>\n<code>\n#     ELITE HTACCESS FOR WEBDEVELOPERS\n##############################################\nAuthName "SiteName Administration"\nAuthUserFile /home/sitename.com/.htpasswd\nAuthType basic\nRequire valid-user\nOrder deny,allow\nDeny from all\nAllow from 24\.205\.23\.222\nAllow from w3.org htmlhelp.com\nAllow from googlebot.com\nSatisfy Any\n</code></p><p>\n<p>\nEach code snippet has been copied from htaccesselite.  Additional and detailed info on each htaccess code snippet can be found at <a href="http://www.askapache.com/">askapache.com</a>\n</p>\n<p>\n<strong>NOTE:</strong> Most of these snippets can be used with a <a href="http://www.askapache.com/htaccess/using-filesmatch-and-files-in-htaccess.html">Files or Filesmatch</a> directive to only apply to certain files.\n</p>\n<p>\n<strong>NOTE:</strong> Any htaccess rewrite examples should always begin with:\n</p>\n<code>\nOptions +FollowSymLinks\nRewriteEngine On\nRewriteBase /\n</code></p><p>\n<h2>Apache Documentation: <a href="http://httpd.apache.org/docs/1.3/">1.3</a>    <a href="http://httpd.apache.org/docs/2.0/">2.0</a>    <a href="http://httpd.apache.org/docs/2.2/">2.2</a>    <a href="http://httpd.apache.org/docs/trunk/">Current</a></h2></p><p></p><p><h2>Make any file be a certain filetype (regardless of name or extension)</h2>\n<code>\n#Makes image.gif, blah.html, index.cgi all act as php\nForceType application/x-httpd-php\n</code></p><p></p><p>\n<h2>Redirect non-https requests to https server fixing double-login problem and ensuring that htpasswd authorization can only be entered using HTTPS</h2>\n<p><a href="http://www.htaccesselite.com/htaccess/redirecting-all-or-part-of-a-server-to-ssl-vt61.html">Additional https/ssl information</a> and <a href="http://www.askapache.com/htaccess/apache-ssl-in-htaccess-examples.html">Apache SSL in htaccess examples</a></p>\n<code>\nSSLOptions +StrictRequire\nSSLRequireSSL\nSSLRequire %{HTTP_HOST} eq "google.com"\nErrorDocument 403 https://google.com\n</code></p><p></p><p>\n<h2>SEO Friendly redirects for bad/old links and moved links</h2>\n<h3>For single moved file</h3>\n<code>\nRedirect 301 /d/file.html http://www.htaccesselite.com/r/file.html\n</code>\n<h3>For multiple files like a blog/this.php?gh</h3>\n<code>\nRedirectMatch 301 /blog(.*) http://www.askapache.com/$1\n</code>\n<h3>different domain name</h3>\n<code>\nRedirect 301 / http://www.newdomain.com\n</code></p><p></p><p>\n<h2>Require the www</h2>\n<code>\nOptions +FollowSymLinks\nRewriteEngine On\nRewriteBase /\nRewriteCond %{REQUEST_URI} !^/robots\.txt$\nRewriteCond %{HTTP_HOST} !^www\.example\.com$ [NC]\nRewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L] \n</code></p><p><h2>Require the www without hardcoding</h2>\n<code>\nOptions +FollowSymLinks\nRewriteEngine On\nRewriteBase /\nRewriteCond %{REQUEST_URI} !^/robots\.txt$ [NC]\nRewriteCond %{HTTP_HOST} !^www\.[a-z-]+\.[a-z]{2,6} [NC]\nRewriteCond %{HTTP_HOST} ([a-z-]+\.[a-z]{2,6})$     [NC]\nRewriteRule ^/(.*)$ http://%1/$1 [R=301,L]\n</code></p><p>\n<h2>Require no subdomain</h2>\n<code>\nOptions +FollowSymLinks\nRewriteEngine On\nRewriteBase /\nRewriteCond %{REQUEST_URI} !^/robots\.txt$\nRewriteCond %{HTTP_HOST} \.([a-z-]+\.[a-z]{2,6})$ [NC]\nRewriteRule ^/(.*)$ http://%1/$1 [R=301,L]\n</code></p><p><h2>Require no subdomain</h2>\n<code>\nOptions +FollowSymLinks\nRewriteEngine On\nRewriteBase /\nRewriteCond %{HTTP_HOST} \.([^\.]+\.[^\.0-9]+)$\nRewriteCond %{REQUEST_URI} !^/robots\.txt$ [NC]\nRewriteRule ^(.*)$ http://%1/$1 [R=301,L]\n</code></p><p>\n<h2>Redirect everyone to different site except 1 IP address (useful for web-development)</h2>\n<code>\nErrorDocument 403 http://www.someothersite.com\nOrder deny,allow\nDeny from all\nAllow from 24.33.65.6\n</code></p><p></p><p>\n<h2>CHMOD your files</h2>\n<p>\nchmod .htpasswd files 640\nchmod .htaccess files 644\nchmod php files 600\nchmod files that you really dont want people to see as 400\n<strong>NEVER chmod 777</strong>, if something requires write access use 766\n</p></p><p></p><p>\n<h2>Variable (<a href="http://httpd.apache.org/docs/2.2/mod/mod_env.html">mod_env</a>) Magic</h2>\n<h3>Set the Timezone of the server:</h3>\n<code>\nSetEnv TZ America/Indianapolis \n</code></p><p></p><p>\n<h2>Set the Server Administrator Email:</h2>\n<code>\nSetEnv SERVER_ADMIN webmaste@htaccesselite.com\n</code></p><p></p><p>\n<h2>Turn off the ServerSignature</h2>\n<code>\nServerSignature Off\n</code></p><p></p><p>\n<h2>Add a "en-US" language tag and "text/html; UTF-8" headers without meta tags</h2>\n<p>Article: <a href="http://www.askapache.com/htaccess/setting-charset-in-htaccess.html">Setting Charset in htaccess</a></p>\n<p>Article: <a href="http://www.askapache.com/htaccess/using-filesmatch-and-files-in-htaccess.html">Using FilesMatch and Files in htaccess</a></p>\n<code>\nAddDefaultCharset UTF-8\n# Or AddType 'text/html; charset=UTF-8' html\nDefaultLanguage en-US\n</code></p><p><h3>Using the Files Directive</h3>\n<code>\n<Files ~ "\.(htm html css js php)$">\n   AddDefaultCharset UTF-8\n   DefaultLanguage en-US\n</Files>\n</code></p><p><h3>Using the FilesMatch Directive <em>(preferred)</em></h3>\n<code>\n<FilesMatch "\.(htm html css js php)$">\n   AddDefaultCharset UTF-8\n   DefaultLanguage en-US\n</FilesMatch>\n</code></p><p>\n<h2>Use a custom php.ini with mod_php or php as a cgi</h2>\n<p>Article: <a href="http://www.askapache.com/php/custom-phpini-tips-and-tricks.html">Custom PHP.ini tips and tricks</a></p>\n<blockquote><p>\nWhen php run as Apache Module (mod_php)\nin root .htaccess\nSetEnv PHPRC /location/todir/containing/phpinifile</p><p>\nWhen php run as CGI\nPlace your php.ini file in the dir of your cgi’d php, in this case /cgi-bin/</p><p>htaccess might look something like this\nAddHandler php-cgi .php .htm Action php-cgi /cgi-bin/php5.cgi</p><p>\nWhen cgi’d php is run with wrapper (for FastCGI)\nYou will have a shell wrapper script something like this:</p><p>#!/bin/sh \nexport PHP_FCGI_CHILDREN=3 \nexec /user3/x.com/htdocs/cgi-bin/php5.cgi</p><p>Change To</p><p>#!/bin/sh \nexport PHP_FCGI_CHILDREN=3 \nexec /x.com/cgi-bin/php.cgi -c /abs/path/to/php.ini</p></blockquote></p><p></p><p>\n<h2>Securing directories: Remove the ability to execute scripts </h2>\n<p>\n    Heres a couple different ways I do it\n</p>\n<code>\nAddHandler cgi-script .php .pl .py .jsp .asp .htm .shtml .sh .cgi \nOptions -ExecCGI\n</code>\n<p>\nThis is cool, you are basically categorizing all those files that end in those extensions so that they fall under the jurisdiction of the -ExecCGI command, which also means -FollowSymLinks <em>(and the opposite is also true, +ExecCGI also turns on +FollowSymLinks)</em>\n</p></p><p></p><p>\n<h2>Only allow GET and PUT request methods to your server.</h2>\n<code>\nOptions -ExecCGI -Indexes -All +FollowSymLinks\nRewriteEngine On\nRewriteBase /\nRewriteCond %{REQUEST_METHOD} !^(GET PUT)\nRewriteRule .* - [F]\n</code></p><p></p><p>\n<h2>Processing All gif files to be processed through a cgi script</h2>\n<code>\nAction image/gif /cgi-bin/filter.cgi\n</code></p><p></p><p>\n<h2>Process request/file depending on the request method</h2>\n<code>\nScript PUT /cgi-bin/upload.cgi\n</code></p><p></p><p>\n<h2>Force Files to download, not be displayed in browser</h2>\n<code>\nAddType application/octet-stream .avi \nAddType application/octet-stream .mpg\n</code>\n<p>Then in your HTML you could just link directly to the file..</p>\n<code>\n<a href="http://www.askapache.com/movies/mov1.avi">Download Movie1</a>\n</code>\n<p>And then you will get a pop-up box asking whether you want to save the file or open it.</p></p><p></p><p>\n<h2>Show the source code of dynamic files</h2>\n<p>If you'd rather have .pl, .py, or .cgi files displayed in the browser as source rather than be executed as scripts, simply create a .htaccess file in the relevant directory with the following:</p>\n<code>\nRemoveHandler cgi-script .pl .py .cgi\n</code></p><p></p><p>\n<h2>Dramatically Speed up your site by implementing Caching!</h2>\n<p>Article: <a href="http://www.askapache.com/htaccess/speed-up-sites-with-htaccess-caching.html">Speed Up Sites with htaccess Caching</a></p>\n<code>\n# MONTH\n<FilesMatch "\.(flv gif jpg jpeg png ico swf)$">\n   Header set Cache-Control "max-age=2592000"\n</FilesMatch></p><p># WEEK\n<FilesMatch "\.(js css pdf txt)$">\n   Header set Cache-Control "max-age=604800"\n</FilesMatch></p><p># DAY\n<FilesMatch "\.(html htm)$">\n   Header set Cache-Control "max-age=43200"\n</FilesMatch>\n</code></p><p></p><p>\n<h2>Prevent Files image/file hotlinking and bandwidth stealing</h2>\n<code>\nOptions +FollowSymLinks\nRewriteEngine On\nRewriteBase /\nRewriteCond %{HTTP_REFERER} !^$\nRewriteCond %{HTTP_REFERER} !^http://(www\.)?askapache.com/.*$ [NC]\nRewriteRule \.(gif jpg swf flv png)$ http://www.askapache.com/feed.gif [R=302,L]\n</code></p><p></p><p>\n<h2>ErrorDocuments</h2>\n<p>Article: <a href="http://www.htaccesselite.com/htaccess/htaccess-errordocument-examples-vt11.html">Additional ErrorDocument Info and Examples</a></p>\n<code>\nErrorDocument 404 /favicon.ico\nErrorDocument 403 https://secure.htaccesselite.com\nErrorDocument 404 /cgi-bin/error.php\nErrorDocument 400 /cgi-bin/error.php\nErrorDocument 401 /cgi-bin/error.php\nErrorDocument 403 /cgi-bin/error.php\nErrorDocument 405 /cgi-bin/error.php\nErrorDocument 406 /cgi-bin/error.php\nErrorDocument 409 /cgi-bin/error.php\nErrorDocument 413 /cgi-bin/error.php\nErrorDocument 414 /cgi-bin/error.php\nErrorDocument 500 /cgi-bin/error.php\nErrorDocument 501 /cgi-bin/error.php\n</code>\n<p><strong>Note:</strong> You can also do an external link, but don't do an external link to your site or you will cause a loop that will hurt your SEO.</p></p><p></p><p>\n<h2>Authentication Magic</h2>\n<h3>Require password for 1 file:</h3>\n<code>\n<Files login.php>\n   AuthName "Prompt"\n   AuthType Basic\n   AuthUserFile /home/askapache.com/.htpasswd\n   Require valid-user\n</Files>\n</code>\n<h3>Protect multiple files:</h3>\n<code>\n<FilesMatch "^(exec env doit phpinfo w)\.*$">\n   AuthName "Development"\n   AuthUserFile /.htpasswd\n   AuthType basic\n   Require valid-user\n</FilesMatch>\n</code>\n<h3>Example uses of the Allow Directive:</h3>\n<code>\n# A (partial) domain-name\nAllow from 10.1.0.0/255.255.0.0\n					\n# Full IP address\nAllow from 10.1.2.3\n					\n# More than 1 full IP address\nAllow from 192.168.1.104 192.168.1.205\n					\n# Partial IP addresses \n# first 1 to 3 bytes of IP, for subnet restriction.\nAllow from 10.1\nAllow from 10 172.20 192.168.2\n					\n# network/netmask pair\nAllow from 10.1.0.0/255.255.0.0\n					\n# network/nnn CIDR specification\nAllow from 10.1.0.0/16\n					\n# IPv6 addresses and subnets\nAllow from 2001:db8::a00:20ff:fea7:ccea\nAllow from 2001:db8::a00:20ff:fea7:ccea/10\n</code>\n<h3>Using visitor dependent environment variables:</h3>\n<p>Article: <a href="http://www.htaccesselite.com/htaccess/setenvif-examples-vt134.html">Additional SetEnvIf examples</a></p>\n<code>\nSetEnvIf User-Agent ^KnockKnock/2\.0 let_me_in\nOrder Deny,Allow\nDeny from all\nAllow from env=let_me_in\n</code>\n<h3>Allow from apache.org but deny from foo.apache.org</h3>\n<code>\nOrder Allow,Deny\nAllow from apache.org\nDeny from foo.apache.org\n</code>\n<h3>Allow from IP address with no password prompt, and also allow from non-Ip address with password prompt:</h3>\n<code>\nAuthUserFile /home/www/site1-passwd\nAuthType Basic\nAuthName MySite\nRequire valid-user\nAllow from 172.17.10\nSatisfy Any\n</code>\n<h3>block access to files during certain hours of the day</h3>\n<code>\nOptions +FollowSymLinks\nRewriteEngine On\nRewriteBase /\n# If the hour is 16 (4 PM) Then deny all access\nRewriteCond %{TIME_HOUR} ^16$\nRewriteRule ^.*$ - [F,L]\n</code></p><p>\n<h2>A good default example .htaccess file</h2>\n<p>I use this when I start a new site, and uncomment or delete parts of the file depending on the sites needs</p>\n<code>\n#            DEFAULT SETTINGS\n##############################################\nOptions +ExecCGI -Indexes\nDirectoryIndex index.php index.html index.htm</p><p>### DEFAULTS ###\nServerSignature Off\nAddType video/x-flv .flv\nAddType application/x-shockwave-flash .swf\nAddType image/x-icon .ico\nAddDefaultCharset UTF-8\nDefaultLanguage en-US\nSetEnv TZ America/Indianapolis\nSetEnv SERVER_ADMIN webmaster@askapache.com</p><p>### FAST-CGI ###\nAddHandler fastcgi-script fcgi\nAddHandler php-cgi .php\nAction php-cgi /cgi-bin/php5-wrapper.fcgi</p><p></p><p>#           HEADERS and CACHING\n##############################################\n#### CACHING ####\n# YEAR\n<FilesMatch "\.(flv gif jpg jpeg png ico)$">\n   Header set Cache-Control "max-age=2592000"\n</FilesMatch>\n# WEEK\n<FilesMatch "\.(js css pdf swf)$">\n   Header set Cache-Control "max-age=604800"\n</FilesMatch>\n# 10 minutes\n<FilesMatch "\.(html htm txt)$">\n   Header set Cache-Control "max-age=600"\n</FilesMatch>\n# DONT CACHE\n<FilesMatch "\.(pl php cgi spl scgi fcgi)$">\n   Header unset Cache-Control\n</FilesMatch></p><p></p><p>#          REWRITES AND REDIRECTS\n##############################################\n### SEO REDIRECTS ###\nRedirect 301 /2006/uncategorized/htaccesselitecom-aboutus.html http://www.^^SITE^^.^^TLD^^</p><p>### REWRITES ###\nRewriteEngine On\nRewriteBase /</p><p>### WORDPRESS ###\n# BEGIN WordPress\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteBase /\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n</IfModule></p><p># END WordPress</p><p></p><p>#           AUTHENTICATION \n##############################################\nAuthName "askapache.com"\nRequire valid-user\nAuthUserFile /askapache/.htpasswd\nAuthType basic\n</code></p><p><a href="http://www.askapache.com/htaccess/apache-htaccess.html">Ultimate htaccess Article</a>