---
layout: post
permalink: style-switcher-in-asp
---
<p>\nAs more and more sites move away from embedded style tags (<code>&lt;font&gt;</code> tags, for example), the benefits of CSS to customize a user's visit has become all the rage.  It's hard to find a site bragging about its use of XHTML and CSS for layout that <em>doesn't</em> have a style switcher of some sort stuffed into a corner like some unruly hamster.\n</p></p><p><p>\nSome of the sites that heavily advocate using CSS for all presentation even provide some handy scripts to allow your users to switch between styles.  <a href="http://alistapart.com/" target="_new" title="For people who make websites; opens in new window">A List Apart</a> featured two such articles; <cite title="November 2, 2001; by Paul Sowden"><a href="http://www.alistapart.com/stories/alternate/" target="_new" title="Opens in new window">Alternative Style: Working with Alternate Style Sheets</a></cite> and <cite title="February 8, 2002; by David Ludwin"><a href="http://alistapart.com/stories/n4switch/" target="_new" title="Opens in new window">A Backward Compatible Style Sheet Switcher</a></cite>.\n</p></p><p><p>\nUnfortunately, both of these tutorials require client-side scripting in order to work.  No matter how backward-compatible or user-friendly the techniques used, if you have JavaScript disabled, it's a no-go.  Granted, if you don't have access to a server-side scripting language, its cut-n-paste ease is undeniable, but to both handle for users without JavaScript enabled (but who can still support CSS), or even later versions of browsers where it's all too possible for JavaScript support may get wonky, I've created a very simple server-side method to switch styles.\n</p></p><p><h2>The Concept</h2></p><p><p>\nThe concept is very simple, really.  A user comes to the site and he or she sees the default style that you've specified.  If, however, the user has been to the site before and chose a different style, you want the site to accept it.  Short of storing a user profile for every user and dealing with the hassle of letting users log in to see custom styles, the next approach would be to simply store the preferences within a cookie.  So, if there's a cookie with a style set, the site uses it, otherwise it uses the default.  Simple.\n</p></p><p><p>\nHow you choose to display these options, however, should be up to you.  The script samples given will allow you to use form elements (radio buttons or a select menu, for example) or simple hyperlinks.\n</p></p><p><h2>Code Samples</h2></p><p><p>\nThose of you familiar with my font sizing article from way back in 1999, <cite title="July 13, 1999"><a href="http://evolt.org/article/Give_the_User_Control_Over_Your_Fonts/22/253/index.html">Give the User Control Over Your Fonts</a></cite>, may recall that I used a set of three buttons to allow a user to cycle through three stylesheets with different type sizes for each selection.  Well, we're just going to repurpose that code.  Back then, we talked about browser detection so you could display the option only to those who could use it.  I'm skipping that for now, since your average site doesn't care too much, and there are many other and better scripts out there that you can customize to do your browser detection for you.\n</p></p><p><p>\nThis block of code first checks to see if a style has been selected by the user, and if not, it checks to see if there is a cookie with the CSS style.  Failing both of those it writes the default value to the cookie and then to the <code>&lt;link&gt;</code> element that calls the CSS file.  So, on a user's first visit, it will still show the default style.  If the user has cookies disabled, he or she will simply see the default style regardless of what he or she selects, although you can add a cookie detection script in here if you wish to hide the option.  Make sure this sits at the top of your document, before any HTML/XHTML is written to the browser.  Note that I've called the cookie <code>cCSS</code>, which ideally will demonstrate to users with cookies enabled that, with the associated value, the cookie is nothing more than a harmless style preference.\n</p></p><p><p>\nI'd recommend you make the below chunk of script into an include so you can re-use it all over your site.\n</p></p><p><pre>\n&lt;%</p><p>'##############################################################################\n'# styleswitcher.asp               Version 1.0                                #\n'# Copyright 2000 Adrian Roselli   adrian@roselli.org                         #\n'# Created 26/5/2002               Last Modified 26/5/2002                    #\n'##############################################################################\n'# COPYRIGHT NOTICE                                                           #\n'# Copyright [and -left] 2002 Adrian Roselli  All Rights Reserved except as   #\n'# provided below.                                                            #\n'#                                                                            #\n'# styleswitcher.asp may be used and modified free of charge by anyone so     #\n'# long as this copyright notice and the comments above remain intact. By     #\n'# using this code you agree to indemnify Adrian Roselli from any liability   #\n'# that might arise from it's use.                                            #  \n'#                                                                            #\n'# This script is released under the GPL.                                     #\n'# Selling the code for this program or any derivative work is expressly      #\n'# forbidden. A full copy of the GPL can be found in the Code section of      #\n'# http://evolt.org. In all cases copyright and this header must remain       #\n'# intact.                                                                    #\n'##############################################################################</p><p>'# Set the name of the current script to variable so you\n'# can use this script on any page of your site\nstrScriptName = Request.ServerVariables("SCRIPT_NAME")</p><p>'# First check the cookie value to see if anything has\n'# already been selected.\n'# Then, request the style from the entire Request collection,\n'# so it could come from a form submission, or an appended\n'# URL.\ncCSS = Request.Cookies("cCSS")\nrCSS = Request("rCSS")</p><p>\n'# If there is a style, write it to the cookie with any\n'# arbitrary date in the future so it sticks, and set the\n'# value for fCSS, our final variable from all this.\nIF NOT rCSS = "" THEN</p><p>	'# Set the cookie to what came in from the request.\n	Response.Cookies("cCSS") = rCSS\n	Response.Cookies("cCSS").expires = #10/10/2003#</p><p>	'# Set the final value equal to what came in from\n	'# the request collection.\n	fCSS = rCSS</p><p>'# If there is no style selected by the user...\nELSEIF rCSS = "" THEN</p><p>	'# ...and the cookie is blank, write the default.\n	IF cCSS = "" THEN\n		Response.Cookies("cCSS") = "default"\n		cCSS = "default"\n	END IF</p><p>	'# Now set the final variable to the default value\n	'# we've just set above.\n	fCSS = cCSS</p><p>	'# Finally, set the rCSS value in case you have a form\n	'# that relies on it to draw the selected value.\n	rCSS = fCSS\nEND IF</p><p>%&gt;\n</pre></p><p><p>\nNow that you've created the value for the stylesheet to display, you might as well have the page select the right one.  This works best if the value you used in your form or hyperlink is the filename, sans the extension, of the CSS file you wish to call:\n</p></p><p><p>\n<code>&lt;link rel="stylesheet" href="/&lt;% = fCSS %&gt;.css" media="all" type="text/css"/&gt;</code>\n</p></p><p>\n<p>\nNow, further down the page you actually want to give the user a means by which to select a style.  The examples I'll show are a select menu, a set of radio buttons, and some text links.  The text links could easily be modified to become images, so I'll leave out images for the scope of this example.\n</p></p><p>\n<h3>Select Menu</h3></p><p><p>\nUnfortunately, the select menu requires a click to see all the options, and then a click to select one.  It does not, however, fire without a submission click, which alleviates the hassle of users missing their target, although it does bring it up to three clicks.  You can always add an <code>onchange</code> if you so desire, however.\n</p></p><p><pre></p><p>&lt;form action="&lt;% = strScriptName %&gt;"&gt;\n&lt;p&gt;&lt;strong&gt;Got CSS?&lt;/strong&gt;&lt;/p&gt;\n	&lt;select name="rCSS" id="rCSS"&gt;\n		&lt;option value="default"&lt;% IF rCSS = "" OR rCSS = "default" THEN %&gt; selected="selected"&lt;% END IF %&gt;&gt;Default&lt;/option&gt;\n		&lt;option value="heaven"&lt;% IF rCSS = "heaven" THEN %&gt; selected="selected"&lt;% END IF %&gt;&gt;Heaven&lt;/option&gt;\n		&lt;option value="hell"&lt;% IF rCSS = "hell" THEN %&gt; selected="selected"&lt;% END IF %&gt;&gt;Hell&lt;/option&gt;\n		&lt;option value="evolt"&lt;% IF rCSS = "evolt" THEN %&gt; selected="selected"&lt;% END IF %&gt;&gt;evolt.org&lt;/option&gt;\n		&lt;option value="stealth"&lt;% IF rCSS = "stealth" THEN %&gt; selected="selected"&lt;% END IF %&gt;&gt;Stealth&lt;/option&gt;\n		&lt;option value="none"&lt;% IF rCSS = "none" THEN %&gt; selected="selected"&lt;% END IF %&gt;&gt;None&lt;/option&gt;\n	&lt;/select&gt;\n	&lt;br/&gt;\n	&lt;input type="submit" name="" value="Style Me!"/&gt;\n&lt;/form&gt;</p><p></pre></p><p><p>\nWhich will look like this:\n</p></p><p>\n<p><strong>Got CSS?</strong></p>\n	<select name="rCSS" id="rCSS">\n		<option value="default">Default</option>\n		<option value="heaven">Heaven</option>\n		<option value="hell">Hell</option>\n		<option value="evolt" selected>evolt.org</option>\n		<option value="stealth">Stealth</option>\n		<option value="none">None</option>\n	</select>\n	<br>\n	<input type="button" name="" value="Style Me!"></p><p>\n<h3>Radio Buttons</h3></p><p><p>\nThis option takes up more space on the page, but presents all the options to the user at once.  It's a two-clicker to get a new style in place, and as above, doesn't rely on JavaScript to submit the form, so the user must click the submit button.  Make sure you keep the <code>&lt;label&gt;</code> elements in place to provide a larger hit state for those browsers that support it.\n</p></p><p><pre>\n&lt;form action="&lt;% = strScriptName %&gt;"&gt;\n&lt;p&gt;\n&lt;strong&gt;Got CSS?&lt;/strong&gt;&lt;br/&gt;\n	&lt;input type="radio" name="rCSS" id="rCSS_default" value="default"&lt;% IF rCSS = "" OR rCSS = "default" THEN %&gt; checked="checked"&lt;% END IF %&gt; /&gt;&lt;label for="rCSS_default"&gt;Default&lt;/label&gt;&lt;br/&gt;\n	&lt;input type="radio" name="rCSS" id="rCSS_heaven" value="heaven"&lt;% IF rCSS = "heaven" THEN %&gt; checked="checked"&lt;% END IF %&gt; /&gt;&lt;label for="rCSS_heaven"&gt;Heaven&lt;/label&gt;&lt;br/&gt;\n	&lt;input type="radio" name="rCSS" id="rCSS_hell" value="hell"&lt;% IF rCSS = "hell" THEN %&gt; checked="checked"&lt;% END IF %&gt; /&gt;&lt;label for="rCSS_hell"&gt;Hell&lt;/label&gt;&lt;br/&gt;\n	&lt;input type="radio" name="rCSS" id="rCSS_evolt" value="evolt"&lt;% IF rCSS = "evolt" THEN %&gt; checked="checked"&lt;% END IF %&gt; /&gt;&lt;label for="rCSS_evolt"&gt;evolt.org&lt;/label&gt;&lt;br/&gt;\n	&lt;input type="radio" name="rCSS" id="rCSS_stealth" value="stealth"&lt;% IF rCSS = "stealth" THEN %&gt; checked="checked"&lt;% END IF %&gt; /&gt;&lt;label for="rCSS_stealth"&gt;Stealth&lt;/label&gt;&lt;br/&gt;\n	&lt;input type="radio" name="rCSS" id="rCSS_none" value="none"&lt;% IF rCSS = "none" THEN %&gt; checked="checked"&lt;% END IF %&gt; /&gt;&lt;label for="rCSS_none"&gt;None&lt;/label&gt;&lt;br/&gt;\n	&lt;input type="submit" name="" value="Style Me!"/&gt;\n&lt;/p&gt;\n&lt;/form&gt;</p><p></pre></p><p><p>\nWhich will look like this:\n</p></p><p>\n<p>\n<strong>Got CSS?</strong><br>\n	<input type="radio" name="rCSS" id="rCSS_default" value="default"><label for="rCSS_default">Default</label><br>\n	<input type="radio" name="rCSS" id="rCSS_heaven" value="heaven"><label for="rCSS_heaven">Heaven</label><br>\n	<input type="radio" name="rCSS" id="rCSS_hell" value="hell"><label for="rCSS_hell">Hell</label><br>\n	<input type="radio" name="rCSS" id="rCSS_evolt" value="evolt" checked><label for="rCSS_evolt">evolt.org</label><br>\n	<input type="radio" name="rCSS" id="rCSS_stealth" value="stealth"><label for="rCSS_stealth">Stealth</label><br>\n	<input type="radio" name="rCSS" id="rCSS_none" value="none"><label for="rCSS_none">None</label><br>\n	<input type="button" name="" value="Style Me!">\n</p></p><p></p><p><h3>Good Ol' Fashioned Hyperlinks</h3></p><p><p>\nSometimes a form is just a waste of clicks and totally unnecessary.  In those circumstances, you want your script to support hyperlinks, and you want it to show the selected style as well.  Here is some very basic code to handle that.  I've set the script to insert an inline style of bold for the selected sylesheet.  You can modify that or create a more robust method to style the selected option.\n</p></p><p><pre>\n&lt;p&gt;\n&lt;strong&gt;Got CSS?&lt;/strong&gt;\n&lt;/p&gt;</p><p>&lt;ul&gt;\n &lt;li&gt;&lt;a href="&lt;% = strScriptName %&gt;?rCSS=default"&lt;% IF rCSS = "" OR rCSS = "default" THEN %&gt; style="font-weight:bold;"&lt;% END IF %&gt;&gt;Default&lt;/a&gt;&lt;/li&gt;\n &lt;li&gt;&lt;a href="&lt;% = strScriptName %&gt;?rCSS=heaven"&lt;% IF rCSS = "heaven" THEN %&gt; style="font-weight:bold;"&lt;% END IF %&gt;&gt;Heaven&lt;/a&gt;&lt;/li&gt;\n &lt;li&gt;&lt;a href="&lt;% = strScriptName %&gt;?rCSS=hell"&lt;% IF rCSS = "hell" THEN %&gt; style="font-weight:bold;"&lt;% END IF %&gt;&gt;Hell&lt;/a&gt;&lt;/li&gt;\n &lt;li&gt;&lt;a href="&lt;% = strScriptName %&gt;?rCSS=evolt"&lt;% IF rCSS = "evolt" THEN %&gt; style="font-weight:bold;"&lt;% END IF %&gt;&gt;evolt.org&lt;/a&gt;&lt;/li&gt;\n &lt;li&gt;&lt;a href="&lt;% = strScriptName %&gt;?rCSS=stealth"&lt;% IF rCSS = "stealth" THEN %&gt; style="font-weight:bold;"&lt;% END IF %&gt;&gt;Stealth&lt;/a&gt;&lt;/li&gt;\n &lt;li&gt;&lt;a href="&lt;% = strScriptName %&gt;?rCSS=none"&lt;% IF rCSS = "none" THEN %&gt; style="font-weight:bold;"&lt;% END IF %&gt;&gt;None&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n</pre></p><p><p>\nWhich will look like this:\n</p></p><p><p>\n<strong>Got CSS?</strong>\n</p></p><p><ul>\n <li><a href="file.asp?rCSS=default" onClick="javascript:return false;">Default</a></li>\n <li><a href="file.asp?rCSS=heaven" onClick="javascript:return false;">Heaven</a></li>\n <li><a href="file.asp?rCSS=hell" onClick="javascript:return false;">Hell</a></li>\n <li><a href="file.asp?rCSS=evolt" style="font-weight:bold;" onClick="javascript:return false;">evolt.org</a></li>\n <li><a href="file.asp?rCSS=stealth" onClick="javascript:return false;">Stealth</a></li>\n <li><a href="file.asp?rCSS=none" onClick="javascript:return false;">None</a></li>\n</ul></p><p></p><p><p>\nYou can, of course, use images in place of plain-text hyperlinks.  I don't primarily because my styles vary so much in color that no single set of images would work &#8212; I'd have to create a new set of images for each style.\n</p></p><p><h2>Finally</h2></p><p><p>\nYou can modify this script to support one style switcher that only changes colors, and another that changes the layout of the page, as well.  Or a third one that resizes type, and on and on.  Ultimately, whatever you make should take into account how the user will interact with the page and allow a quick and easy way to see and make selections.\n</p>