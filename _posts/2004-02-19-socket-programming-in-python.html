---
layout: post
permalink: node/60276
ratings: 3
avgrate: 4.3333
categories: [Code]
user: premshree
real_name: "Premshree Pillai"
user_biog: "Premshree Pillai studies engineering at Mumbai University, India. He has written articles for a range of popular Indian IT magazines. He runs a website <a href=\"http://www.qiksearch.com\" rel=\"nofollow\">http://www.qiksearch.com</a> where he posts his works. He also runs <a href=\"http://premshree.resource-locator.com\" rel=\"nofollow\">http://premshree.resource-locator.com</a>"
user_since: 10 Aug 2002
avatar: 
article_count: 2
excerpt: "In this article I shall discuss socket programming in Python. I have explained the concepts using a sample Python client and a server."
---
<h2>Introduction</h2></p><p></p>In <a href="http://www.evolt.org/article/Socket_Programming_in_Perl/17/60108/">my last article at Evolt</a>, I had discussed socket programming in Perl. In this article, I shall discuss socket programming in Python. You need not know anything about Perl or socket programming in Perl, nonetheless you might want to refer it if you wish to.</p></p></p><p></p><p></p>Sockets are one of the most popular means of network communication. It follows the client-server architecture that most of you-all must be aware of. Using sockets in Python, it is possible to communicate to a server using a client program. Here, I will explain how using sockets a client program can communicate to a server. The client program is run at the client-side while the server program runs in the Internet. For testing the program, you can run it on a local server.</p></p></p><p></p><p></p>For socket programming, Python provides the <code>socket</code> module. It is a very common module and it's most likely that you have it. The <code>socket</code> module consists of the <code>socket()</code> function, which is used for socket initiation/creation. We will be primarily concerned with this function only, i.e. <code>socket.socket()</code>. The <code>socket</code> module also provides several other methods.</p></p></p><p><p></p>The <code>socket</code> module supports various protocols for communication, viz., TCP (Transmission Control Protocol), UDP (User Datagram Protocol), etc. TCP is a connection-oriented protocol, which means before a client can send messages with the server, a connection needs to be explicitly created to the server, and only then can the client-server communication take place. On the other hand, UDP is a connectionless protocol, which means no connection needs to be established between the client and the server for communication. Since, protocols are not the main concern of this article, I won't elucidate on them any further. Since we are concerned with socket programming (in Python), it would be better to make use of a simple protocol; thus in the Python examples that follow, I have used the connectionless UDP protocol.</p></p></p><p></p><p></p>Before we go further with our UDP client and servers, this is how you must import the <code>socket</code> module:</p></p></p><p></p><pre></p>from socket import *</p></pre></p><p><h2>Client Program</h2></p><p></p>First of all we need to initialize all the parameters that we will be using to initialize our socket:</p></p></p><p><pre></p>host = "localhost"</p>port = 21567</p>buf = 1024</p>addr = (host,port)</p></pre></p><p><p></p>The various variables we have created have the following meaning for the socket:</p></p></p><p><ul></p>	<li><code><b>host</b></code>: The <code>host</code> can be a host name or an IP address. Here we are testing the programs locally so we have used <code>localhost</code>. If the server program is running in the Internet then you must use its IP address or domain name.</li></p>	<li><code><b>port</b></code>: The <code>port</code> can be a number or symbolic service name.</li></p>	<li><code><b>buf</b></code>: <code>buf</code> is the maximum size of the data stream that can be transmitted at a time through the socket. You may set it to any power-of-2 value. However, what value you set depends on your requirements.</li></p>	<li><code><b>addr</b></code>: <code>addr</code> is a two-element tuple, the first element being <code>host</code> and the second element as <code>port</code>. The <code>addr</code> variable will be made use of when sending messages to the server.</li></p></ul></p><p><p></p>Once we have set the socket parameters using different variables, we can now actually initialize the socket, i.e. create the socket as follows:</p></p></p><p></p><pre></p>UDPSock = socket(AF_INET,SOCK_DGRAM)</p></pre></p><p><p></p>Note that the above code fragment does not use any of the variables that we have initialized before. However, those variables are required when actually sending the message to the server. In the above code fragment, <code>SOCK_DGRAM</code> indicates that we are using the UDP protocol for communication.</p></p></p><p></p><p></p>Now that we have created the socket, we can now send a message to the server using the <code>socket</code> object's <code>sendto()</code> method :</p></p></p><p></p><pre></p>msg = "Whatever message goes here..."</p>UDPSock.sendto(data,addr)</p></pre></p><p><p></p>Thus we have created the client program. Now let us create the server program that will display the messages that the client has sent.</p></p></p><p><h2>Server Program</h2></p><p></p>In the server program also, we create the socket in a similar manner, i.e., first we initialize our variables:</p></p></p><p></p><pre></p>host = "localhost"</p>port = 21567</p>buf = 1024</p>addr = (host,port)</p></pre></p><p><p></p>Now we have to create the socket, which again is similar to the client program:</p></p></p><p></p><pre></p>UDPSock = socket(AF_INET,SOCK_DGRAM)</p></pre></p><p><p></p>Another piece of code that needs to be added to the server code when creating the socket, is that we need to bind the address, <code>addr</code>, to the socket just created:</p></p></p><p></p><pre></p>UDPSock.bind(addr)</p></pre></p><p><ul></p>	<li><code><b>addr</b></code>: This is the local host bind port and should be same as the <code>addr</code> value passed in the client program.</li></p></ul></p><p><p></p>Now after creating the socket, we can now receive messages sent by the client using the <code>socket</code> object's <code>recvfrom()</code> method :</p></p></p><p></p><pre></p>data,addr = UDPSock.recvfrom(buf)</p></pre></p><p><p></p>Note that in the above code fragment, <code>UDPSock.recvfrom()</code> takes the buffer size, <code>buf</code>, as an argument and returns a tuple of two elements; thus we assign the values of the tuple to two variables, <code>data</code> and <code>addr</code>. We can now print the data received as:</p></p></p><p></p><pre></p>print data</p></pre></p><p><p></p>Thus we have created the server program. Now the client can communicate with server using a socket. Note that for the server to receive messages from the client, it (the server) should be running while the message is being sent by the client.</p></p></p><p></p><p></p>In the sections that follow, the codes for the client and server programs using Python have been listed. The codes are self-explanatory.</p></p></p><p></p><h2>Client program code</h2></p><p><pre></p># Client program</p><p>from socket import *</p><p># Set the socket parameters</p>host = "localhost"</p>port = 21567</p>buf = 1024</p>addr = (host,port)</p><p># Create socket</p>UDPSock = socket(AF_INET,SOCK_DGRAM)</p><p>def_msg = "===Enter message to send to server===";</p>print "</p>",def_msg</p><p># Send messages</p>while (1):</p>	data = raw_input('>> ')</p>	if not data:</p>		break</p>	else:</p>		if(UDPSock.sendto(data,addr)):</p>			print "Sending message '",data,"'.....<done>"</p><p># Close socket</p>UDPSock.close()</p></pre></p><p><p></p>We have refined the client program so that it accepts inputs from the keyboard, which is transmitted (communicated through sockets) to the server. A return (pressing enter/return once) will exit the client program.</p></p></p><p></p><h2>Server program code</h2></p><p><pre></p># Server program</p><p>from socket import *</p><p># Set the socket parameters</p>host = "localhost"</p>port = 21567</p>buf = 1024</p>addr = (host,port)</p><p># Create socket and bind to address</p>UDPSock = socket(AF_INET,SOCK_DGRAM)</p>UDPSock.bind(addr)</p><p># Receive messages</p>while 1:</p>	data,addr = UDPSock.recvfrom(buf)</p>	if not data:</p>		print "Client has exited!"</p>		break</p>	else:</p>		print "</p>Received message '", data,"'"</p><p># Close socket</p>UDPSock.close()</p></pre></p><p><p></p>We have refined the server program so that as and when the client sends a message, the server keeps displaying it.</p></p></p><p></p><h2>Interactive session</h2></p><p><p></p>The following screenshots illustrate an interactive client-server communication using sockets (in Python):</p></p></p><p><p><img src="images/36051/60276/ss1.jpg" align="center"><br><b>Client sending messages</b></p></p><p><p><img src="images/36051/60276/ss2.jpg" align="center"><br> <b>Server receiving messages</b></p></p><p><h2>Conclusion</h2></p><p></p>Thus we have learned how to communicate to a server from a client using sockets in Python. There are several applications that can be created using sockets, mostly network communication related applications. One popular example where sockets are used is in chat applications. In a typical chat application, each client is a server as well, and each server is a client as well, i.e., clients need to be able to listen and servers need to be able to transmit data.</p></p></p><p></p><p>If you have any comments/suggestions, please do get in touch with me.</p>