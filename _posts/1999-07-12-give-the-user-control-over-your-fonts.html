---
layout: post
permalink: Give_the_User_Control_Over_Your_Fonts
ratings: 4
avgrate: 4.5000
category: Visual Design
user: aardvark
real_name: "Adrian Roselli"
user_biog: "<p style=\"text-align:justify;\">
A founder of evolt.org, Adrian Roselli (aardvark) is the Senior Usability Engineer at <a href=\"http://algonquinstudios.com/\" rel=\"nofollow\" target=\"_blank\" title=\"Visit Algonquin Studios - Opens New Window\">Algonquin Studios</a>, located in Buffalo, New York.
</p>

<p style=\"text-align:justify;\">
Adrian has years of experience in graphic design, web design and multimedia design, as well as extensive experience in internet commerce and interface design and usability. He has been developing for the World Wide Web since its inception, and working the design field since 1993.  Adrian is a founding member, board member, and writer to evolt.org. In addition, Adrian  sits on the Digital Media Advisory Committee for a local SUNY college and a local private college, as well as the board for a local charter school.
</p>

<p style=\"text-align:justify;\">
You can see his brand-spanking-new blog at <a href=\"http://blog.adrianroselli.com/\" rel=\"\">http://blog.adrianroselli.com/</a> as well as his new web site to promote his writing and speaking at <a href=\"http://adrianroselli.com/\" rel=\"\">AdrianRoselli.com</a>
</p>

<p style=\"text-align:justify;\">
Adrian authored the usability case study for evolt.org in <a href=\"http://www.amazon.com/exec/obidos/ASIN/1904151035/ref=nosim/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Amazon, for one, is selling it; opens in new window.\"><em>Usability: The Site Speaks for Itself</em></a>, published by glasshaus. He has written three chapters for the book <a href=\"http://www.amazon.com/exec/obidos/ASIN/1590591712/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Amazon, for one, is selling it; opens in new window.\"><em>Professional Web Graphics for Non Designers</em></a>, also published by glasshaus. Adrian also managed to get a couple chapters written (and published) for <a href=\"http://www.amazon.com/exec/obidos/ASIN/159059200X/evoltorg02-20\" rel=\"nofollow\" target=\"_new\" title=\"Opens in new window.\"><em>The Web Professional\'s Handbook</em></a> before glasshaus went under. They were really quite good. You should have bought more of the books.
</p>"
user_since: 14 Dec 1998
avatar: /images/pictures/picture-88.gif
article_count: 85
excerpt: "There\'s nothing quite like getting your text just right with all your CSS attributes in place, and sitting back knowing that you finally have some typographic control over your pages. It\'s just too bad that\'s not the case for your users."
---
<p></p>There's nothing quite like getting your text just right with all your CSS attributes in place, and sitting back knowing that you finally have some typographic control over your pages.</p></p></p><p><p></p>It's just too bad that's not the case for your users.  A user may come to your site and see text so large they can't see more than three lines at a time, or so small they can't even see your text.</p></p></p><p><p></p>"But wait," you say, "I was careful to test it on Ed's machine, and Sally's, and even mine &#151; in <strong>two</strong> browsers at that.  What could possibly be wrong?"  Well, even though the <a href="http://www.w3.org/Style/CSS/" target="_new" title="W3C Cascading Style Sheets Specification">CSS specification</a> supports many different relative attributes, none of them seem to work on any of the current browsers.</p></p></p><p><p></p>Correct rendering of the '<code>em</code>' is all I ask for, it's such a simple concept: base 1em on the size of the default text as the user has it configured on his or her system, usually 12 point.  Ideally, you ensure that the user has complete control over the sizing of text, making it much easier for your reader to read.  But this is an ideal situation, not a real-world one and even if you get it to work, you may not realize that .5em is too small on every system but your own. You can see a great article on how to try to use the '<code>em</code>' at <a href="http://www.webreview.com/1998/06_26/webauthors/06_26_98_7.shtml" target="_new" title="Web Review - Understanding Em">WebReview.com</a>.</p></p></p><p><p></p>So it doesn't work, nor do any of the other relative sizing units &#151; at least not consistently across browsers and platforms.  Instead you may find you are using points, or pixels, or something else to set your font sizes, and you try to accommodate all your viewers by making it the most 'average' size you can.</p></p></p><p><p></p>But it doesn't have to be that way; you don't have to completely wrest control from your users.  Instead, empower them again, give them the ability to control what they see, let them, not you, decide that smaller text is better.</p></p></p><p><p></p>I'm a big proponent of server-side solutions whenever possible, it takes some strain off the browser, and ensures a consistent experience for all your users since nobody has to wait for clunky JavaScript to parse on their old P75 or Centris 610 with 16MB of RAM (way too little if you run any of today's bloated browsers or OSes).  So, given that disclaimer, I'm going to offer a solution to the problem using <strong>Active Server Pages</strong>, which results in plain ol' HTML when passed to the browser.  My code will not work with Apache, or ColdFusion, or any other server-side technology, but the capability to do it is in all of them, so at least follow the ideas as I go.</p></p></p><p><p></p>Let's start with a real-world example. If you surf over to any of the pages at my personal gallery in a 4.x browser, <a href="http://roselli.org/adrian/" target="_new" title="CSS Resizing Sample Site">http://roselli.org/adrian/</a> (please pardon the plug), you will see in the navbar a pair of buttons. By default, one should read '<em>Enlarge Text</em>' and the other should read '<em>Shrink Text</em>.'  Clicking one of these buttons will reload the current page with a link to a different style sheet (I use the <code>&lt;link&gt;</code> tag in the <code>&lt;head&gt;</code> to call my style sheets, but you can still use this tutorial if you embed your styles right in the document).  It also presents a '<em>Normal Size</em>' button in place of the button on which you just clicked (provided you just clicked one, of course).</p></p></p><p><p></p>Let me run down what happens when you first come to the site (provided I haven't changed anything, and it's working correctly):</p></p></p><p><ul></p><li>Your browser requests a page and sends its name and version number over in the HTTP header.</li></p><li>By requesting the <code>HTTP_USER_AGENT</code>, I can determine if your browser is capable of displaying CSS information.</li></p><li>I set a cookie on your browser indicating that you are CSS-capable, then I set a cookie telling me that the font size I will be using for now is the default.</li></p><li>When the page is served, some server-side script has determined if it should even send you the buttons to resize the text based on the CSS cookie I set.</li></p><li>If it is set, you get to see two buttons, one to enlarge, one to shrink the text.</li></p><li>The URL in the <code>&lt;a href&gt;</code> tag has a variable appended to the end of the filename of the current script (web page), that variable tells the script whether you've chosen to enlarge or shrink the text when you click one of the buttons.</li></p><li>The page reloads, reading the variable from the URL, which triggers script that loads the alternate style sheet.</li></p></ul></p><p><p></p>While this doesn't cover all the bases, it does kill quite a lot of birds with one stone (pardon the metaphor mixing). It is also <em>only</em> a CSS solution, although it wouldn't be too hard to make it apply to the <code>&lt;font&gt;</code> tags as well for your pre-CSS users. No matter what (CSS-capable) browser you are using, if you come to the page and the text is too small, kick it up a bit.  If it's still too small, well, don't read the text, just look at the pretty pictures.  Or you can use what you find in here to create more than three text size options.</p></p></p><p><p></p>So, on to...</p></p></p><p><h2>The Code</h2></p><p><p></p>First, you need to write up your cookie-setting script so you can call it from within every page on your site.  Save the file as '<code>cookies.asp</code>' and consider putting it in a subdirectory where you store all your include files (perhaps '<code>includes/</code>', and make sure you've disabled directory browsing and have put a '<code>default.asp</code>' with a <code>response.redirect</code> command to send the user to somewhere else less dangerous in your site). Try using the following ASP script, which only checks for Navigator or Internet Explorer versions 4.x.  I've purposely left it restricted to these two for the purpose of this tutorial, so that it has a better chance of fitting on the page. By the way, I'm not a cookie maven, so if you have suggestions, please let me know.</p></p></p><p><pre>&lt;%</p><p>'## Code by Adrian Roselli from http://roselli.org</p>'## Provided free for evolt.org and its members.</p>'## No catches, just give me credit.</p>'## This browser detection only detects IE4.x and NN4.x, please modify it as you see fit to get the 5.x and alternate manufacturer CSS-capable browsers.</p>'## Last change July 10, 1999</p><p></p>'########################</p>'## Browser Determination</p><p>'## Get the browser name and version number</p>UserAgent = Request.ServerVariables(&quot;HTTP_USER_AGENT&quot;)</p><p>'## If the cookie Browser has no value, then perform the following</p>IF Request.Cookies(&quot;Browser&quot;) = &quot;&quot; then</p><p>	'## Check the UserAgent string to see if it contains Mozilla or MSIE, and then to see if it has 4. in the version number</p>	if (instr(1,UserAgent,&quot;Mozilla&quot;,1) &gt; 0 OR instr(1,UserAgent,&quot;MSIE&quot;,1) &gt; 0) AND instr(1,UserAgent,&quot;4.&quot;,1) &gt; 0 THEN</p><p>		'## Adds 1 month onto todays date so the cookie will expire 1 month from now</p>		NewerDate = DateAdd(&quot;m&quot;, 1, FormatDateTime(Now,vbGeneralDate))</p><p>		'## Sets a cookie so that the browser is marked as CSS-capable</p>		Response.Cookies(&quot;Browser&quot;) = &quot;CSS&quot;</p>		Response.Cookies(&quot;Browser&quot;).expires = cdate(NewerDate)</p>	end if</p>END IF</p><p></p>'################</p>'## Set Text Size</p><p>'## If the URL does not have a ?size=value appended to it (meaning the user clicked one of the links), then perform the following</p>IF NOT Request(&quot;Size&quot;) = &quot;&quot; THEN</p><p>	'## If the user clicked to enlarge, then set the cookie to large</p>	IF Request(&quot;Size&quot;) = &quot;Large&quot; THEN</p>		Response.Cookies(&quot;TextSize&quot;) = &quot;Large&quot;</p>		Response.Cookies(&quot;TextSize&quot;).expires = #10/10/2000#</p><p>	'## If the user clicked to normalize, then set the cookie to large</p>	ELSEIF Request(&quot;Size&quot;) = &quot;Normal&quot; THEN</p>		Response.Cookies(&quot;TextSize&quot;) = &quot;Normal&quot;</p>		Response.Cookies(&quot;TextSize&quot;).expires = #10/10/2000#</p><p>	'## If the user clicked to shrink, then set the cookie to small</p>	ELSEIF Request(&quot;Size&quot;) = &quot;Small&quot; THEN</p>		Response.Cookies(&quot;TextSize&quot;) = &quot;Small&quot;</p>		Response.Cookies(&quot;TextSize&quot;).expires = #10/10/2000#</p><p>	END IF</p><p>'## Otherwise, check the cookie, and if it also has a blank value, set it to normal</p>ELSEIF Request.Cookies(&quot;TextSize&quot;) = &quot;&quot; THEN</p>	Response.Cookies(&quot;TextSize&quot;) = &quot;Normal&quot;</p>	Response.Cookies(&quot;TextSize&quot;).expires = #10/10/2000#</p>END IF</p><p></p>'##########################</p>'## Get Current Script Name</p><p>'## Sets ScriptName equal to whatever the current script name is</p>ScriptName = Request.ServerVariables(&quot;SCRIPT_NAME&quot;)</p><p></p>%&gt;</pre></p><p><p></p>Now you need to include this file in your script (web page).  To accomplish this and to ensure any time you need to update your script you can do so with little trouble, we will include it in all pages on the site.  We will assume that your scripts (web pages) are in a different directory at the same level as your '<code>includes/</code>' directory.  Insert this line of code at the top of each of your scripts, above the <code>&lt;HTML&gt;</code> tag:</p></p></p><p><p></p><code> &lt;!--#include virtual &#124; file =&quot;../includes/cookie.asp&quot;--&gt; </code></p></p></p><p><p></p>Now you need to create your resize links.  Create another text file and name it '<code>CSSResize.asp</code>'.  Paste the following script into the text file (making sure it also exists in the '<code>includes/</code>' directory). Note, I tend to name my include files with an '<code>.asp</code>' extension since '<code>.inc</code>' and '<code>.txt</code>' get sent to the browser as plain text, allowing users to see your script if they know the path to the file; however, using an '<code>.asp</code>' extension causes the server to try to parse the file, resulting in an error page, which is much better than displaying all your hard-work (copied code).</p></p></p><p><pre>&lt;%</p>'## Code by Adrian Roselli from http://roselli.org</p>'## Provided free for evolt.org and its members.</p>'## No catches, just give me credit.</p>'## Make sure you supply your own images, rollovers, whatever.  These are just suggestions, especially since text links are not always attractive.</p>'## Last change July 10, 1999</p><p></p>'## Request the cookie Browser and see if it is a CSS-capable browser, based on your previous work.</p>'## This ensures that you do not display the buttons if the browser cannot use them.</p>IF Request.Cookies(&quot;Browser&quot;) = &quot;CSS&quot; THEN</p>%&gt;</p><p>&lt;%</p>	'## If the text isn't already set to large, offer the option.</p>	IF NOT Request.Cookies(&quot;TextSize&quot;) = &quot;Large&quot; THEN</p>%&gt;</p>        	&lt;a href=&quot;&lt;% = ScriptName %&gt;?size=Large&quot;&gt;Enlarge Text&lt;/a&gt;&lt;br&gt;</p>&lt;% 	END IF %&gt;</p>&lt;%</p>	'## If the text isn't already set to normal, or is not set, offer the option.</p> 	IF NOT Request.Cookies(&quot;TextSize&quot;) = &quot;Normal&quot; OR Request.Cookies(&quot;TextSize&quot;) = &quot;&quot; THEN</p>%&gt;</p>        	&lt;a href=&quot;&lt;% = ScriptName %&gt;?size=Normal&quot;&gt;Return Text to Normal&lt;/a&gt;&lt;br&gt;</p>&lt;% 	END IF %&gt;</p>&lt;% </p>	'## If the text isn't already set to small, offer the option.</p>	IF NOT Request.Cookies(&quot;TextSize&quot;) = &quot;Small&quot; THEN</p>%&gt;</p>        	&lt;a href=&quot;&lt;% = ScriptName %&gt;?size=Small&quot;&gt;Shrink Text&lt;/a&gt;&lt;br&gt;</p>&lt;% 	END IF %&gt;</p><p>&lt;%</p>'## Display this text if the browser is not CSS capable - you could also just leave it blank.</p>ELSE</p>%&gt;</p>	&lt;i&gt;Sorry, you can't see this because I've determined your browser can't do CSS.&lt;/i&gt;</p>&lt;%</p>END IF </p>%&gt;</pre></p><p><p></p>Now you can see that when a user clicks one of the links, it reloads the current script (web page) with the size appended to the end of the URL. It does this because <code>&lt;% = ScriptName %&gt;</code> writes the URL of the current page into the <code>&lt;a href&gt;</code> before it is sent to the browser. The script (web page), upon reloading, reads the variable from the URL and uses that to set the cookie in the user's browser, allowing him or her to maintain his or her preference the next time he or she comes back without any further input.  But you will still provide the option to change it at any time by offering the other links.</p></p></p><p><p></p>Now, to put the resize links in your script (web page), just insert the following line in your page where you want the links to appear:</p></p></p><p><p></p><code> &lt;!--#include virtual &#124; file =&quot;../includes/CSSResize.asp&quot;--&gt; </code></p></p></p><p><p></p>We are now on to the last step, including the updated CSS in the document.  The next step you are going to take is create a new text file called '<code>CSS.asp</code>' in the '<code>includes/</code>' directory with the following script:</p></p></p><p><pre>&lt;%</p>'## Code by Adrian Roselli from http://roselli.org</p>'## Provided free for evolt.org and its members.</p>'## No catches, just give me credit.</p>'## Make sure you point to the right style sheets, silly.</p>'## Last change July 10, 1999</p><p>	'## Iterate through the size options, with a default if there are no matches.</p>	IF Request.Cookies(&quot;TextSize&quot;) = &quot;Large&quot; THEN</p>%&gt;</p>&lt;LINK  REL=&quot;stylesheet&quot; TYPE=&quot;text/css&quot; HREF=&quot;../includes/large.css&quot; NAME=&quot;master&quot;&gt;</p>&lt;% </p>	ELSEIF Request.Cookies(&quot;TextSize&quot;) = &quot;Small&quot; THEN</p>%&gt;</p>&lt;LINK  REL=&quot;stylesheet&quot; TYPE=&quot;text/css&quot; HREF=&quot;../includes/small.css&quot; NAME=&quot;master&quot;&gt;</p>&lt;%</p>	ELSE</p>%&gt;</p>&lt;LINK  REL=&quot;stylesheet&quot; TYPE=&quot;text/css&quot; HREF=&quot;../includes/normal.css&quot; NAME=&quot;master&quot;&gt;</p>&lt;%</p>	END IF</p>%&gt;</pre></p><p><p></p>Or, if you prefer to include all of your styles within each page, then you can use the following script.  Don't worry, the server will only send the chunk of CSS that you specify with your <code>IF</code> statments.</p></p></p><p><pre>&lt;style type=&quot;text/css&quot;&gt;</p><p>&lt;!--</p>&lt;%</p>'## Code by Adrian Roselli from http://roselli.org</p>'## Provided free for evolt.org and its members.</p>'## No catches, just give me credit.</p>'## Make sure you include all your styles, instead of just this one, silly.</p>'## Last change July 10, 1999</p><p>	'## Iterate through the size options, with a default if there are no matches.</p>	IF Request.Cookies(&quot;TextSize&quot;) = &quot;Large&quot; THEN</p>%&gt;</p>.text        {    font : 12pt Arial, Helvetica, serif ;</p>		  color : #cccc99 ;</p>                  line-height : 16pt }</p>&lt;% </p>	ELSEIF Request.Cookies(&quot;TextSize&quot;) = &quot;Small&quot; THEN</p>%&gt;</p>.text        {    font : 8pt Arial, Helvetica, serif ;</p>		  color : #cccc99 ;</p>                  line-height : 16pt }</p>&lt;%</p>	ELSE</p>%&gt;</p>.text        {    font : 10pt Arial, Helvetica, serif ;</p>		  color : #cccc99 ;</p>                  line-height : 16pt }</p>&lt;%</p>	END IF</p>%&gt;</p>--&gt;</p><p>&lt;/style&gt;</pre></p><p><p></p>Somewhere within the <code>&lt;HEAD&gt; &lt;/HEAD&gt;</code> tags of your script (web page), add the following:</p></p></p><p><p></p><code> &lt;!--#include virtual &#124; file = &quot;../includes/CSS.asp&quot;--&gt;</code></p></p></p><p><p></p>Congratulations, if I wrote the script correctly, then you should be ready to experiment on your own servers.  For double-checking purposes, the final code on your page may resemble this:</p></p></p><p><pre>&lt;!--#include virtual   file =&quot;../includes/cookie.asp&quot;&gt;</p><p>&lt;html&gt;</p>&lt;head&gt;</p>&lt;title&gt;Soylent Green&lt;/title&gt;</p><p>&lt;!--#include virtual   file =&quot;../includes/CSS.asp&quot;--&gt;</p><p>&lt;/head&gt;</p><p>&lt;body bgcolor=&quot;#003333&quot; text=&quot;#cccc99&quot; link=&quot;#cc9933&quot; vlink=&quot;#999999&quot; alink=&quot;#ff0000&quot;&gt;</p><p>&lt;font face=&quot;arial,helvetica,sans serif&quot; size=&quot;2&quot; class=&quot;text&quot;&gt;</p><p>This is some standard body text.  It will change size of you click a link below.</p>&lt;br&gt;&lt;br&gt;</p><p>&lt;!--#include virtual   file =&quot;../includes/CSSResize.asp&quot;--&gt;</p><p>&lt;/font&gt;</p><p>&lt;/body&gt;</p>&lt;/html&gt;</pre></p><p><p></p>I have posted a sample page made up of the code found in this tutorial.  If you do not have access to an ASP-capable server, then you may want to <a href="http://roselli.org/adrian/articles/samples/css_test.asp" onClick="window.open('http://roselli.org/adrian/articles/samples/css_test.asp','CSS_test','height=200,width=200'); return false;" title="Tutorial Sample Page">take a look</a> at how it should function.</p></p></p><p><p></p>There are many more options available to you here.  Perhaps you want more than 3 styles, maybe you want 6.  Perhaps you want the styles to change depending on where your user is surfing &#151; for instance, pages of just text get a larger stylesheet, but pages with images and only caption text may have smaller stylesheets. You can also use the same code to re-write your <code>&lt;font&gt;</code> tags throughout the site, simply be defining them as variables in an included file and calling that variable throughout the site.  You can even load larger or smaller navigation images for your site by using a series of image files in addition to the CSS.</p></p></p><p><p></p>Obviously, many of these suggestions go beyond what you may need to do for your users, but at the very least, giving the user control over the fonts on your site could go a long way to keeping them as repeat users.  And at the same time, you may sleep better knowing that you are working toward making the web a friendlier place for both the eagle-eyed and the lazy-eyed.</p></p></p><p><p></p>If anybody would like to submit script that performs these same functions for other server/platform combinations (eg. ColdFusion), please feel free to let me know, and I'll try to update the article.</p></p>