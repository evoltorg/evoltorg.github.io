---
layout: post
permalink: node/60165
ratings: 1
avgrate: 1.0000
rating: 3.41
categories: [Code]
user: ideahamster
real_name: "troy janisch"
user_biog: "Troy Janisch is president and founder of <a href=\"http://www.iconinteractive.com\" rel=\"nofollow\">Icon Interactive&#8482;</a>,  an industry leader helping companies integrate Internet and other Interactive media into sales channels, marketing strategies, and overall branding. He can be contacted by email at <a href=\"mailto:tjanisch@iconinteractive.com\" rel=\"nofollow\">tjanisch@iconinteractive.com.</a>"
user_since: 08 Jul 2002
avatar: /images/pictures/picture-32830.jpg
article_count: 17
excerpt: "Analog may be the most popular Web stats analyzer in the world, but it isn\'t the most intuitive program for Windows users to automate. These step-by-step instructions will get the program working on your NT server, like magic."
---
<p></p>Analog  may be the most popular Web stats analyzer in the world, but it isn't the most intuitive program for Windows users to automate.   These step-by-step instructions will get the program working on your server, like magic.</p></p></p><p><p></p>For the sake of brevity, I'll assume that you can download and install Analog and Report Magic. If you can't do that, you probably shouldn't be writing scheduled batch files anyway.</p></p></p><p></p><h2>Step 1: Your Analog CFG file</h2></p><p></p><p></p>There is nothing magical about setting up a good CFG file for Analog.  Since CFG files are roughly the same for each platform, I won't waste your time here.  Instead, I'll provide you with a few useful links:</p></p></p><p><ol></p> <li><a href="http://www.analog.cx/docs/custom.html" target="_new" title="Opens in new window">Analog documentation</a> &#8212; which tells you how to create a CFG file.</li></p> <li><a href="http://www.rix-web.com/analyzer/" target="_new" title="Opens in new window">The RixWeb CFG file creator</a>  &#8212;  which will create a CFG file for you.</li></p> <li>This example <a href="files/32830/60165/my.cfg" target="_new" title="Opens in new window">CFG file</a> &#8212;  which you can use for inspiration</li></p></ol></p><p><p></p>When creating your CFG file, there are just a couple of things to keep in mind. First, that you'll be overriding the LOGFILE setting when the program is run. And, second, that you only need to output a .DAT file if you're going to run Report Magic.</p></p></p><p><p></p><a href="http://www.reportmagic.org/" target="_new" title="Opens in new window">Report Magic</a>  is a tool that makes Analog reports look prettier. Like Analog, its free, so there is no reason not to use it.</p></p></p><p><h2>Step 2: Your Report Magic INI file</h2></p><p><p></p>Report Magic INI files need to know where to find your DAT file and where to write the HTML files for the Web Stats report. In this case,  here are the relevant links:</p></p></p><p><ol></p> <li><a href="http://www.reportmagic.org/docs/config.html" target="_new" title="Opens in new window">Report Magic Settings Documentation</a> - where you can read about creating an INI file.</li></p> <li>This example <a href="files/32830/60165/my.ini" target="_new" title="Opens in new window">INI file</a>  which you can use for inspiration.</li></p></ol></p><p><p></p>Report Magic can dynamically create file names that include date information. You'll probably want different INI files for monthly and yearly reports.  It's not uncommon to have multiple Report Magic INI files for a single Analog CFG file.</p></p></p><p><h2>Step 3: Your Manual Batch File</h2></p><p><p></p>If you're setting up Analog or Report Magic for the first time, you'll want to create a batch file that generates historical reports - those for previous month/years that you'll want to view statistics for.</p></p></p><p><p></p>The manual batch file needs to include two lines for each report generated. The first is the Analog command. The command above specifies: 1) the location of analog.exe; 2) the log files to be included in the report; and 3) the .CFG file to be executed. For example:</p></p></p><p><p></p><code>call c:\analog\analog.exe c:\LogFiles\W3SVC9\ex0203*.log +g&quot;c:\stats\config\my.cfg&quot; -G</code></p></p></p><p><p></p>The second line for each report is the Report Magic command. This command specifies: 1) the location of the rmagic.exe; and 2) the location of the .INI file. For example:</p></p></p><p><p></p><code>call c:\analog\rmagic.exe c:\stats\config\my.ini</code></p></p></p><p><p></p>This <a href="files/32830/60165/manual.bat" target="_new" title="Opens in new window">example</a>  generates monthly reports for 2002.</p></p></p><p><h2>Step 4: The Automated Batch File</h2></p><p><p></p>The automated batch file takes the same format as a manual batch file. However, at the beginning of the batch file you must first fetch the current month/year:</p></p></p><p><p></p><code>@ echo off<br>set yy%date:~12,2%<br>set mm=%date:~4,2%</code></p></p></p><p><p></p>Then, use the same commands, replacing the appropriate portion of the log file name:</p></p></p><p><p></p><code>call c:\analog\analog.exe c:\LogFiles\W3SVC9\ex%yy%%mm%*.log +g&quot;c:\stats\config\my.cfg&quot; -G<br><br><br></p>call c:\analog\rmagic.exe c:\stats\config\my.ini</code></p></p></p><p><p></p>This <a href="files/32830/60165/nightly.bat" target="_new" title="Opens in new window">example</a> generates a monthly Web stats report.</p></p></p><p><h2>Step 5: Use Windows Task Scheduler</h2></p><p><p></p>Using Windows Task Scheduler, specify a time when you want the batch file to run.  For detailed instruction, visit the <a href="http://www.analog.cx/how-to/batch/index.html" target="_new" title="Opens in new window">Analog web site</a></p></p></p><p><p></p><img src="images/32830/60165/task1.jpg" alt="" width="441" height="318" border="0"></p></p></p><p><p></p>Ta da! You're automatically generating Analog web stats report.</p></p>