---
layout: post
permalink: node/1833
---
<P>The ability to distinguish visited links from those not yet visited is a great feature and one that can be extended to form select elements (also known as "dropdown boxes") in some situations.</p></p><p><p>For the purposes of this example, we'll be using ColdFusion and a database of projects (a portfolio). The intention of this article is to get the opinions of CF experts (as I am not one), and discover a perfect way of implementing this idea, for the eventual benefit of all developers. My initial attempt is just to get people thinking - so expect to find problems. ;)</P></p><p><P>That said, we'll need a few things - an Application.cfm, a project.cfm, and a project database (project.mdb). And we'll add in a linked stylesheet too (styles.css). You'll find portions of the code for these throughout the article, and they'll all be available to download also.</P></p><p><P>The code works in the following way: in the Application.cfm, a list is created, full of zeros, and has a length equal to the number of projects found in the database. As each project is visited/viewed, it's corresponding position in the list is changed from a zero to a one. In this way, the code that builds the select box can tell whether each project has been visited (or not), and set the appearance appropriately.</P></p><p><P>Firstly, the Application.cfm:</P></p><p><pre>\n&lt;cfapplication name=&quot;project&quot; clientmanagement=&quot;yes&quot; sessionmanagement=&quot;yes&quot; sessiontimeout=#createtimespan(0, 2, 0, 0)#&gt;\n&lt;cfset data = &quot;project&quot;&gt;\n&lt;cfquery name=&quot;getall&quot; datasource=&quot;#data#&quot;&gt;\n&nbsp;&nbsp;&nbsp;select projectid, projectname\n&nbsp;&nbsp;&nbsp;from project\n&nbsp;&nbsp;&nbsp;order by projectid;\n&lt;/cfquery&gt;</p><p>&lt;cfparam name=&quot;session.visit&quot; default=&quot;#repeatstring(&quot;0,&quot;,&quot;#getall.recordcount#&quot;)#&quot;&gt;\n</pre></p><p><P>It's the last line here that's important - it's setting a default session variable (<B>session.visit</B>). The function <B>repeatstring()</B> will repeat <B>"0"</B> by the <B>recordcount</B> of the <B>getall</B> query. So, if at this stage, we have 15 projects in our database, the value of <B>session.visit</B> will be:</P>\n<BLOCKQUOTE>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,</BLOCKQUOTE>\n<P>Next, the stylesheet. I'm only going to include the part that's critical, but the file itself can be downloaded later.</P></p><p><pre>\n.visited {\n&nbsp;&nbsp;&nbsp;font-family : verdana, arial, sans-serif;\n&nbsp;&nbsp;&nbsp;color : #999999;\n&nbsp;&nbsp;&nbsp;font-size : 10pt;}</p><p>.unvisited {\n&nbsp;&nbsp;&nbsp;font-family : verdana, arial, sans-serif;\n&nbsp;&nbsp;&nbsp;color : #000000;\n&nbsp;&nbsp;&nbsp;font-size : 10pt;}\n</pre></p><p><P>These two classes will be applied to the select box's option tags depending on their visited status. The only difference is the colour - unvisited options remain black, but those that have been visited "fade" to grey.</P>\n<P>Finally, the project.cfm file itself. You can download it in its entirety at the end of this article, but for now, here's the first important section which sits at the top of the file:</P></p><p><pre>\n&lt;cfparam name=&quot;url.projectid&quot; default=&quot;1&quot;&gt;\n&lt;cfquery name=&quot;getem&quot; datasource=&quot;#data#&quot; maxrows=1&gt;\n&nbsp;&nbsp;&nbsp; select projectid, projectname, projectdescription\n&nbsp;&nbsp;&nbsp; from project\n&nbsp;&nbsp;&nbsp; where projectid = #url.projectid#;\n&lt;/cfquery&gt;</p><p>&lt;cfif getem.recordcount is &quot;0&quot;&gt;&lt;cfinclude template=&quot;project.cfm&quot;&gt;&lt;cfabort&gt;&lt;/cfif&gt;</p><p>&lt;cfset session.visit = &quot;#listsetat(session.visit, &quot;#url.projectid#&quot;, 1)#&quot;&gt;\n</pre></p><p><P>The last line in this part is what changes the required zero to a one. It uses the function <B>listsetat()</B> to change the character at the position (<B>#url.projectid#</B>) of the project to <B>"1".</B></P>\n<P>The select box code itself is what causes the options to fade when they've been visited:</P></p><p><pre>\n&lt;form action=&quot;project.cfm&quot; method=&quot;post&quot; name=&quot;selectproject&quot;&gt;\n&lt;select name=&quot;projectname&quot; size=&quot;1&quot; class=unvisited onChange=&quot;location.href = this[this.selectedIndex].value&quot;&gt;\n&lt;cfoutput query=getall&gt;</p><p>\n&lt;option class=&quot;&lt;cfif #getem.projectid# is #projectid#&gt;unvisited&lt;cfelseif #listgetat(session.visit, &quot;#projectid#&quot;)# is &quot;1&quot;&gt;visited&lt;cfelse&gt;unvisited&lt;/cfif&gt;&quot; value=&quot;project.cfm?projectid=#projectid#&quot; &lt;cfif #getem.projectid# is #projectid#&gt;selected&lt;/cfif&gt;&gt;</p><p>&amp;nbsp;&amp;nbsp;\n&lt;cfif #listgetat(session.visit, &quot;#projectid#&quot;)# is &quot;1&quot;&gt;&amp;nbsp;&lt;cfelse&gt;-&lt;/cfif&gt;\n&amp;nbsp;#projectname#&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/option&gt;</p><p>&lt;/cfoutput&gt;\n&lt;/select&gt;\n&lt;/form&gt;\n</pre></p><p><P>In this section, there are five important sections. The first, <B>"unvisited"</B> ensures that the currently selected option is given the "black" style, and does not appear faded until the next selection.</P>\n<P>The second, <B>#listgetat(session.visit, "#projectid#")#</B>, grabs the value (from the list) at the position of the project in the select box. The next two show the application of the <B>visited</B> and <B>unvisited</B> styles, depending on the value. If the value is one, the project has been visited, and the visited style is applied. If the value is zero, then it is unvisited, and the style is set accordingly.</P></p><p><P>The final item enables this select box to show the "visited" projects based on a non-CSS method. If the project is unvisited, add a hyphen. If it's been visited, leave the hyphen out. This ensures that non-stylesheet enabled browsers can still get at least <B>some</B> feedback from the dropdown.</P></p><p><P>Last of all, <A href="http://isaac.triplezero.com.au/dropdown/dropdown.zip">download a zip</A> of the files you'll need, and/or visit the simplified <A href="http://isaac.triplezero.com.au/dropdown/project.cfm">code in action</A>.</P></p><p><P>If you spot any errors in the code, or can suggest major improvements, please post below, or email me so that I can update the article. Thanks.</P></p><p><P><A href="mailto:isaac@triplezero.com.au">isaac</A></P>