---
layout: post
permalink: node/26440
ratings: 26
avgrate: 4.5000
category: Code
user: jesteruk
real_name: "Jester uk"
user_biog: "<p>I just like messing around with web design stuff, just a hobby.</p>
<p>Particularly perl, PHP and SQL.</p>

<p><a href=\"http://www.free2code.net\" rel=\"nofollow\" title=\"My site\" target=\"_blank\">http://www.free2code.net/</a></p>"
user_since: 22 Dec 2001
avatar: 
article_count: 6
excerpt: "I see a lot of badly written PHP code around, this article addresses a few of the most common mistakes people make and will, hopefully, encourage some to write better PHP."
---
<p>I see a lot of very badly written PHP code around, most of which I have been guilty for myself,</p>so I thought I'd write a tutorial to help people get the most out of PHP -- and maybe not make</p>the mistakes I did.</p></p><p><h3>" And ' Are Very Different</h3></p><p><p>I see a lot of this:</p></p><p><p><code>$name = "Bill";</code></p></p><p><p>That isn't efficient; the whole point of double quotes is to allow interpolation. Meaning, PHP</p>checks anything within double quotes for a variable. Like so:</p><p><p><code>echo "My name is $name";</code></p></p><p><p>If you do:</p></p><p><p>$name = "Bill";</p><p><p>Then PHP checks the contents of the double quotes for a variable to interpolate. This makes</p>your scripts SLOWER, in small scripts this isn't noticeable, it isn't a big difference, but in</p>large, complex scripts this extra work for PHP can be very noticeable. Get into the habit of doing:</p></p><p><p>$name = 'Bill';</code></p></p><p><p><em>"Hey, PHP, I'm not using double quotes, I'm using single quotes here, don't even bother checking</p>for something to interpolate."</em></p></p><p><p>This reduces the work PHP has to do to parse your script, increasing efficiency, especially in</p>larger scripts. Get into the habit &#8212; use quotes correctly.</p></p><p><p>These rules apply to everything, echo, functions, strings, everything.</p></p><p><p><code>SetCookie('name', 'Bill');</code></p></p><p><p>Not:</p></p><p><p><code>SetCookie("name", "Bill");</code></p></p><p><p>Another thing you can do is use single quotes even when using a variable, like so:</p></p><p><p><code>$name = 'Bill';<br></p>echo 'My name is '.$name;</code></p></p><p><p>Apparently, PHP scripts parse faster this way. One other advantage of this is:</p></p><p><p><code>echo "&lt;a href=\"http://www.evolt.org\"&gt;Evolt&lt;/a&gt;";</code></p></p><p><p>Look familiar? Use single quotes and you don't have to escape double quotes.</p></p><p><p><code>echo '&lt;a href="http://www.evolt.org"&gt;Evolt&lt;/a&gt;';</code></p></p><p><p>Works fine, and saves you having to escape those annoying quotes.</p></p><p><p>Get used to it, I wish I'd have been told that when I started with PHP.</p></p><p><h3>Jump from PHP Mode</h3></p><p><p>I also see a lot of this:</p></p><p><p><code>&lt;?php<br></p>$name = 'Bill';<br></p>echo "&lt;table align=\"center\"&gt;&lt;tr&gt;&lt;td&gt;My name is $name&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;";<br></p>?&gt;</code></p></p><p><p>No, don't do that. One of the great features of PHP is its ability to jump in and out of PHP</p>mode. It has actually been shown that jumping from PHP mode when outputting data actually</p>increases your script's parse speed, so your script will be faster. Do this:</p></p><p><p><code>&lt;?php<br></p>$name = 'Bill';<br></p>?&gt;<br></p>&lt;table align="center"&gt;&lt;tr&gt;&lt;td&gt;My name is &lt;?=$name?&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</code></p></p><p><p><code>Leave "PHP Mode" and print out the content, if you need to use more PHP code, just jump back in!</p>It's easy to do, it makes content easier to output, and it speeds up your scripts.</code></p></p><p><p><code>&lt;?=$name?&gt;</code></p></p><p><p>This is a short-hand in PHP for:</p></p><p><p><code>&lt;?php echo $name; ?&gt;</p></code></p><p><p>Jump into PHP Mode, echo out the data contained in the variable then jump back out of PHP mode.</p>Use it, it makes scripts easier to read, easier to edit, it's just a lot easier and efficient.</p></p><p><h3>register_globals Off</h3></p><p><p>Another mistake I see around a lot is people writing scripts that will not work if register_globals is off.</p>In the next release of PHP register_globals will be off by default, so you need to start writing your scripts with this in mind.</p></p><p><p>Having register_globals off is no big deal. I mean how hard is it to write:</p></p><p><p><code>$_POST['username']</p></code></p><p><p>Rather than:</p></p><p><p><code>$username</p></code></p><p><p>Not very. It's also a lot more secure, as it stops users being able to pass variables to your script through the query string and the like. If they stuck:</p></p><p><p><code>?name=Jester</p></code></p><p><p>Into their address bar, "Jester" would not be available in <code>$name</code>. It would be available in <code>$_GET['name']</code> or <code>$HTTP_GET_VARS['name']</code>. So they can't pass variables that could twist the behaviour of your scripts.</p></p><p><p>Note: If you have register_globals off, ensure you have track_vars on. Track_vars makes all environment variables available in the arrays: <code>$HTTP_SERVER_VARS ($_SERVER also, for newer versions of PHP)</code>, <code>$HTTP_COOKIE_VARS</code>, <code>$HTTP_POST_VARS ($_POST also)</code> and <code>$HTTP_GET_VARS {$_GET also)</code>. Using these arrays instead of the normal variables isn't much extra work for more security.</p></p><p><p>Sessions in PHP also perform a lot better with register_globals off. Take a look at a snippet of code.</p></p><p><p><code>$username = $_POST['uname'];</p>session_register('username');</code></p></p><p><p>To register a session variable many people use this method (I have in the past), you don't need to, if you have register_globals off you can merely do:</p></p><p><p><code>$_SESSION['username'] = $_POST['uname'];</code></p></p><p><p>You see, in the first part code PHP needs to know that the variable is being registered as a session variable. In the second we are using the <code>$_SESSION</code> array, PHP knows if we store something in this it is a session variable, we don't need to "register" it, and the variable will now be available to you -- without you having to pass it through the query string and form inputs -- until you destroy it; like so:</p></p><p><p><code>unset($_SESSION['username']);</code></p></p><p><h3>With MySQL</h3></p><p><p>Another mistake a lot of people make is when they extract data from a database. For anyone familiar with <a href="http://www.php.net" title="PHP.net" target="_blank">PHP</a> and <a href="http://www.mysql.com" title="MySQL.com" target="_blank">MySQL</a>, you will be familiar with the following function:</p></p><p><p><a href="http://www.php.net/manual/en/function.mysql-fetch-array.php" title="PHP Manual: mysql_fetch_array()" target="_blank">mysql_fetch_array()</a></p></p><p><p>"<em>mysql_fetch_array() is an extended version of <a href="http://www.php.net/manual/en/function.mysql-fetch-row.php" title="PHP Manual: mysql_fetch_row()" target="_blank">mysql_fetch_row()</a>. In addition to storing the data in the numeric indices of the result array, it also stores the data in associative indices, using the field names as keys.</em>"</p></p><p><p>The above is taken from the function description on php.net. So it's saying, when we use <code>mysql_fetch_array()</code> we are fetching <strong>two</strong> arrays: one containing indices, and one containing associative references to the field names in your database. Why? If you want indices, you will use <code>mysql_fetch_row()</code>, right? We use <code>mysql_fetch_array()</code> when we want the associative references. It's a lot easier when using associative references, yet we have this spare array taking up space and diminishing the efficiency of our code. Luckily those nice people at PHP have an array that fetches an associative array, and <strong>only</strong> that:</p></p><p><p><a href="http://www.php.net/manual/en/function.mysql-fetch-assoc.php" title="PHP Manual: mysql_fetch_assoc()" target="_blank">mysql_fetch_assoc()</a></p></p><p><p><code>mysql_fetch_assoc()</code> fetches an associative array. If you want only that, use this function, if you want indices, use <code>mysql_fetch_row()</code>. If for some reason you need both, <em>then</em> you should use <code>mysql_fetch_array()</code>. Don't assign variables you won't use.</p></p><p><h3>References</h3></p><p><ul></p><li><a href="http://www.php.net" title="The PHP Homepage" target="_blank">PHP.net</a></li></p><li><a href="http://www.zend.com/zend/art/mistake.php" title="PHP Mistakes" target="_blank">Common PHP Mistakes (though the person who wrote this makes a few of his own)</a></li></p></ul></p><p><p>PHP is going places, it's a great language, in my opinion second-to-none when it comes to dynamic webpages. Let's use it to its full potential.</p></p><p>-Jester</p>