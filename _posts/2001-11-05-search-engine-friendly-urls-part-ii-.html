---
layout: post
permalink: node/17171
ratings: 6
avgrate: 4.5000
rating: 4.22
categories: [Code]
user: bheerssen
real_name: "Bruce Heerssen"
user_biog: "<a href=\"www.heerssen.com\" rel=\"nofollow\">Please visit my website</a> (non-commercial)"
user_since: 14 Nov 2000
avatar: /images/pictures/picture-3789.jpg
article_count: 1
excerpt: "This article is an extension of Garrett Coakley's excellent article Search Engine Friendly URLs with PHP and Apache."
---
<p><em>This article is an extension of <a href="http://www.evolt.org/user/garrett/123/index.html" title="Garrett Coakley" target="new">Garrett Coakley's</a> excellent article <a href=http://www.evolt.org/article/Search_Engine_Friendly_URLs_with_PHP_and_Apache/17/15049/index.html" title="Search Engine Friendly URLs with PHP and Apache" target="new">Search Engine Friendly URLs with PHP and Apache</a>.</em></p></p><h3>The Intro</h3></p><p><p>In <a href=http://www.evolt.org/article/Search_Engine_Friendly_URLs_with_PHP_and_Apache/17/15049/index.html" title="Search Engine Friendly URLs with PHP and Apache" target="new">part one</a>, we learned how to use <a href="http://www.php.net" title="Learn more about PHP" target="new">PHP</a> and <a href="http://www.apache.org" title="Learn more about the Apache Project" target="new">Apache</a> to provide URLs that look like directories so that search engines would index them correctly. I also think they just look neat, much prettier than a bunch of ampersands and equal signs. This method also results in shorter URLs since there is no need for the variable names -- just the values. This is a definite plus, so I excitedly began to implement the method on <a href="http://members.evolt.org/bheerssen/" title="my member site" target="new">my site</a>.</p></p><p><p>I soon discovered, however, that all of the supporting pages lost their formatting. I quickly determined that this was due to having used relative URLs in my <code>&lt;link&gt;</code> tags. Further examination revealed that all of my internal links were broken as well, and for the same reason. This would have been easily fixed by simply specifying the absolute URL to the linked files, but I didn't want to do that because I would have to continually change them every time I updated the site from my development server. A more elegant solution was called for.</p></p><p><h3>The Script</h3></p><code></p><pre></p>&lt;?</p>/* Define our global variables */</p>global $REQUEST_URI;</p>global $SCRIPT_NAME;</p><p>/* Assign the value of $SCRIPT_NAME to $base_href.</p>   This value is used at the beginning of all links in the site</p>   so that absolute hrefs are created. Relative hrefs will not</p>   work with this method. */</p>$base_href = $SCRIPT_NAME;</p><p>/* Create an array ($path) out of $base_href</p>   so that we can get the name of the current template. */</p>$path = explode("/",$base_href);</p><p>/* Pop the template name at the end of the array and assign it to $template. */</p>$template = array_pop ($path);</p><p>/* Convert $path back to a string to use later in the template.</p>   This variable is used to reference CSS and JavaScript</p>   source files since $base_href includes the template name. */</p>$path = implode ("/",$path);</p><p>/* Extract the values from the end of the URI.</p>    Note that variable names are not included </p>    in the URI, just the values.</p>    It its therefore important that you always </p>    use the same order for your variables</p>    when creating links. The order itself is not </p>    important, so long as it's always the same. */</p>$vars = str_replace($SCRIPT_NAME, "", $REQUEST_URI);</p><p>/* create an array from the string $vars, then </p>   loop over the array, extract each</p>   value, and assign each to a temporary variable */</p>$array = explode("/",$vars);</p>$num = count($array); // How many items in the array?</p>for ($i = 1 ; $i < $num ; $i++) {</p>        $url_array["arg".$i] = $array[$i];</p>}</p><p>/* Since we know what order the values come </p>    in, we can assign each value to it's correct </p>    variable. This part can also be done later in </p>    whichever script needs the info. */</p>$page = $url_array["arg1"];</p>$message = $url_array["arg2"];</p>$message2 = $url_array["arg3"];</p><p> ?&gt;</p> </pre></p></code></p><p><p>For the purpose of assigning values to variables, <code>$REQUEST_URI</code> is great. But to give an absolute path to the current directory -- without hard coding the directory into the script -- it's not enough. To do that, <code>$SCRIPT_NAME</code> is used, but <code>$SCRIPT_NAME</code> also includes (wait for it) the script's file name. We just want the directory. So, we convert the value of <code>$SCRIPT_NAME</code> to an array then pop off the last value in the array (the file name) and convert the array back into a string. Voila! A dynamically generated path to the current directory. </p></p><p><p>In the above script, this path value is contained in the variable <code>$path</code>. The <code>$path</code> variable should be used for all internally reference files such as <code>.css</code> and <code>.js</code> files. This will ensure that all of your style sheets and javascripts will work as expected. You can also use the <code>$path</code> variables in your links, but for convenience, I've created a variable <code>$base_href</code> that could be used instead. So, instead of <code>&lt;a href="&lt;? echo "$path/index/someVar/anotherVar/"; ?&gt;"&gt;</code>, you would have <code>&lt;a href="&lt;? echo "$base_href/someVar/anotherVar/"; ?&gt;"&gt;</code>.</p></p><p></p><h3>Moving on</h3></p><p>The rest of the script is the same as Garrett's, so we'll leave off further explanation, but there is one more improvement we can make, and it's to the .htaccess file.</p>In Part One, Garrett showed us how to use .htaccess to force Apache to send our script to PHP for processing even though it does not have the .php file extension. I thought it would be nice to have the document listed as the default document for the directory so I added the following line to the .htaccess file:</p></p><p><p><code></p>DirectoryIndex index</p></code></p></p><p>This directive tells Apache to use the file "index" as the default document in this directory. Pretty sweet, huh?</p>