---
layout: post
permalink: Simple_Localization_with_PHP
ratings: 3
avgrate: 3.3333
rating: 3.68
categories: [Backend]
user: emm
real_name: "Emmanuel DÃ©carie"
user_biog: "Emmanuel D&eacute;carie live in Montr&eacute;al (Qu&eacute;bec, Canada) and specialize in content management system (CMS) and custom build web applications. If you need a consultant for your projects (Perl, PHP, Radio UserLand, Manila), please, have a look at <a href=\"http://scriptdigital.com\" rel=\"nofollow\" target=\"_blank\">http://scriptdigital.com</a>."
user_since: 23 Dec 2002
avatar: /images/pictures/picture-51270.jpg
article_count: 1
excerpt: "On PHP DevCenter, Adam Trachtenberg and Joao Prado Maia have described interesting ways to localize web sites with PHP. I'm offering another alternative, which should be easy for non-programmers to use."
---
<ul></p>	<li><a href="/Simple_Localization_with_PHP#top">Simple Localization with PHP</a></li></p>	<li><a href="/Simple_Localization_with_PHP#setstringlisting">Listing setstring</a></li></p>	<li><a href="/Simple_Localization_with_PHP#howitworks">How it Works</a></li></p>	<li><a href="/Simple_Localization_with_PHP#extendingsetstring">Extending setstring</a></li></p>	<li><a href="/Simple_Localization_with_PHP#versionshistory">Versions History</a></li></p>	<li><a href="/Simple_Localization_with_PHP#requirements">Requirements</a></li></p>	<li><a href="/Simple_Localization_with_PHP#download">Download</a></li></p></ul></p><p><p></p>On PHP DevCenter, <a href="/Simple_Localization_with_PHP#note1" title="Note 1">Adam Trachtenberg</a> and <a href="/Simple_Localization_with_PHP#note2" title="Note 2">Joao Prado Maia</a> have described interesting ways to localize web sites with PHP. In this article I've offered another alternative, which should be easy for non-programmers to use.  We will take advantage of the user function <code>setstring</code> function:</p></p></p><p><code></p>setstring ( $lang, $string, [$lang, $string])</p></code></p><p><p></p>Here's a working example of a login page in French and English, which could easily be turned into a template:</p></p></p><p><h2><a name="loginpage">Example 1: The Login Page</a></h2></p><p><a href="http://scriptdigital.com/divers/evolt_example1.html" name="http://scriptdigital.com/divers/evolt_example1.html" target="_blank" title="Opens in a new window">Example 1</a></p><p><h3><a name="htmlsource">The HTML Source of the Login Page</a></h3></p><p><pre></p>&lt;? include_once ("./setstring.inc") ?&gt;</p><p>&lt;?= "&lt;a href='" . $PHP_SELF . "?lang=fr'&gt;Fran&ccedil;ais&lt;/a&gt;" ?&gt;  </p>&lt;?= "&lt;a href='" . $PHP_SELF . "?lang=en'&gt;English&lt;/a&gt;" ?&gt;  </p>&lt;?= "&lt;a href='" . $PHP_SELF . "?logoff=1'&gt;Logoff&lt;/a&gt;" ?&gt;</p><p>&lt;form method="post" action="&lt;?=$PHP_SELF?&gt;"&gt;</p>    &lt;p&gt;</p>        &lt;b&gt;&lt;?=setstring ( 'fr', 'Enregistrement requis', 'en', 'Login required')?&gt;&lt;/b&gt;</p>    &lt;/p&gt;</p>    &lt;p&gt;</p>        &lt;?=setstring ('fr', 'Nom de login:', 'en', 'Login')?&gt;&lt;br&gt;&lt;input type="text" name="uid" size="8"&gt;</p>    &lt;/p&gt;</p>    &lt;p&gt;</p>        &lt;?=setstring ( 'fr', 'Mot de passe:', 'en', 'Password')?&gt;&lt;br&gt;&lt;input type="password" name="pwd" size="8"&gt;</p>    &lt;/p&gt;</p>    &lt;p&gt;</p>        &lt;input type="submit" name="processlogin" value=" &lt;?= setstring ( 'fr', 'Confirmer', 'en', 'Submit') ?&gt; "&gt;</p>    &lt;/p&gt;</p>&lt;/form&gt;</p></pre></p><p><p></p>As you can see, this simple function can be useful when you don't want a <a href="http://scriptdigital.com/divers/images/multilingues.jpg" target="_blank" title="Opens in a new window">web interface</a> for non-programmers to manage different language versions (which the two articles cited above imply). This is ideal in situations where you don't need to display a large amount of content, as is the case of the login page example. (Well, this is not completely accurate as we will see later.)</p></p></p><p><p></p>The setstring function is easy to manage.  It uses session variables to maintain the language preference of the user, and possibly a cookie to maintain state after the session finishes.  Let's look at the code now, and I'll explain it in detail below.</p></p></p><p><h3><a name="setstringlisting">The setstring Listing</a></h3></p><p><pre></p>####################################</p># setstring.inc - Version 1.0 - December 19 2002</p># Copyright: Emmanuel M. Decarie - emm@scriptdigital.com - http://scriptdigital.com</p># BSD License</p># READ ME: http://www.scriptdigital.com/divers/phplocalization.html</p># $Date: 2002/12/19 20:44:01 $ - $RCSfile: setstring.inc,v $ - $Revision: 1.2 $</p>####################################</p><p></p># start the session</p>session_start ();</p><p># Set the default language.</p>$defaultlanguage = "fr";</p><p></p># Set to 1 if you want to use a cookie.</p>$use_cookie = 1;</p><p># Cookie expiration.</p>$expire_cookie = 3600 * 24 * 2; /* 2 days */</p>  </p><p></p># Set $getlang to the requested key for the language if a GET arg 'lang' exists.</p>$getlang = $_GET['lang'];</p> </p># Set a cookie to the GET arg 'lang' if it exists.</p># Set the SESSION key 'lang' to the 'lang' value of the cookie if it exits.</p>if ( $use_cookie == 1 ) {</p><p> 	if ( isset ($getlang) ) {</p> 		setcookie ('lang', $getlang, expire_cookie);</p> 	}</p>  	</p> 	if ( isset ($_COOKIE['lang']) ) {</p> 		$_SESSION['lang'] = $_COOKIE['lang'];</p><p>  	}</p> }</p>  </p># Destroy session and cookie.</p>if ( isset ($_GET['logoff']) ) {</p> 	session_destroy ();</p><p> 	if ( $use_cookie == 1 ) { setcookie ('lang',$getlang, -3600); }</p> 	header ("Location: http://" . $_SERVER['HTTP_HOST'] . "/" . $PHP_SELF);</p> }</p><p> # The main routine.</p><p> function setstring () {</p> 	global $defaultlanguage;</p> 	global $getlang;</p> 	$lang = $_SESSION['lang'];</p> 	$args = func_get_args ();</p>	</p><p> 	# A newcomer.	</p> 	if ( !isset ($lang) ) {</p> 		session_register ('lang');</p> 		$lang = $defaultlanguage;</p> 	}</p> 	</p><p> 	# give $_GET['lang'] the choice to set $lang </p> 	if (  isset ($getlang) ) { </p> 		$lang = $getlang;</p> 		$_SESSION['lang'] = $lang;</p>		</p> 	}</p><p> 	</p> 	# Now $lang have been set either by $languagedefautl, $getlang, or $_SESSION['lang'].</p> 	# Loop in the language array and return $string if $lang is found.</p> 	if ( count ($args) ) {</p> 		if ( in_array ($lang, $args) ) {</p> 			for ($i = 0; $i < count ($args); $i++) {</p><p> 				if ( $args[$i] == $lang ) {</p> 					return $args[$i + 1];</p> 				}</p> 			}</p> 		}</p> 	}</p><p> 	return "";</p> }</p><p></pre></p><p><h3><a name="howitworks">How it Works</a> </h3></p><p><p></p>Before looking at the script itself, <strong>it is important to note</strong> that you'll need to put your include statement (the <code>include ("./setstring.inc")</code> call) before any HTML output.  This is because setstring can use cookies; see <a href="http://www.php.net/setcookie" target="_blank" title="Opens in a new window">setcookie</a> in the PHP manual for details.</p></p></p><p><p></p>At the beginning of the script (lines: 12 - 19) we set the configurations for <code>$defaultlanguage</code>, <code>$use_cookie</code> and <code>$expirecookie</code>. The value of the <code>$defaultlanguage</code> is for newcomers that don't have a cookie or that didn't set the language by clicking on a link. The value of the default language can be anything, as the names of the languages. You can use something like this if you like:</p></p></p><p><p></p><code>$defaultlanguage = "schtroumph"</code></p></p></p><p><p></p><code>&lt;?= setstring ('schtroumph', 'Quelle schtroumphe est-il ?', 'klingon', "'arlogh Qoylu'pu'?") ?&gt;</code></p></p></p><p><p></p>Don't forget to escape your quotes inside the string returned by the function. This will not work: <code>('klingon', ''arlogh Qoylu'pu'?')</code> but this will: <code>'klingon', (''arlogh Qoylu'pu'?')</code>. You can also change single quote to double quotes as in the example above.</p></p></p><p><p></p>Also, don't forget to use HTML entities to escape non-ASCII text. If you use languages like Arabic, Chinese or Hebrew, and depending if you use UTF-8 for text encoding or another variety of encoding that is not based on Unicode (like, for example, GB-2312 for Simplified Chinese), you can use directly this encoding with the setstring function. But you have to set the http-equiv in the <code>&lt;meta&gt;</code> tag like this:</p></p></p><p><pre></p>&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;</p></pre></p><p></p>or </p></p></p><pre></p>&lt;meta http-equiv="Content-Type" content="text/html; charset=gb2312"&gt;</p></pre></p><p><p></p>You set <code>$use_cookie</code> to 1 if you want your users to keep their language setting after the session finishes, and set <code>$expirecookie</code> to the number of seconds you want the cookie to last. In the example, <code>$expirecookie</code> is set to expire in 2 days.</p></p></p><p><p></p>The language which the function returns is determined by order of priority:</p></p></p><ol></p>	<li>The value of the <code>lang</code> argument in the <code>GET</code> request (lines: 23, 58)</li></p>		</p>			<p></p>			You set the 'lang' value in the GET request by a link like this so that the page will point to itself: <br></p>			<code>&lt;?= "&lt;a href='" . $PHP_SELF . "?lang=fr'&gt;Fran&amp;ccedil;ais&lt;/a&gt;" ?&gt;</code></p>			</p></p>			<p></p>			And will look like this after PHP has processed it:<br></p>			<code>&lt;a href='/divers/phplocalization.html?lang=fr'&gt;Fran&amp;ccedil;ais&lt;/a&gt;</a></code></p>			</p></p>			<p></p>			If the <code>'lang'</code> value in the <code>GET</code> request is set and if <code>$use_cookie == 1</code>, we set a cookie for the <code>'lang'</code> value. <br></p>			</p></p>	</p><p>	<li>The value of the <code>lang</code> keyword for a cookie set previously by setstring (line: 32)</li></p>		</p>			<p></p>			This was set in (1) if the user has clicked on a link with <code>'?lang=$lang'</code>.</p>			</p></p><p>		</p><p> </p>	<li>The global value <code>$defaultlanguage</code> (lines: 13, 55)</li></p>		</p>			<p></p>			If nothing happened at (1) or (2), use the <code>$defaultlanguage</code> value to set the language.</p>			</p></p>		</p></ol></p><p>When the <code>$lang</code> keyword is found, setstring loop in the array that was pass to it (lines: 65 -75) and returns the value of the element (which is the $string parameter) after the element that matches the value of <code>$lang</code>. Here's a snippet of code that illustrate the above.</p></p></p><p><pre></p>$lang = 'en';</p>setstring ('fr', 'Allo', 'en', 'Hello');</p><p>for ($i = 0; $i < count ($args); $i++) {</p>    if ( $args[$i] == $lang ) {                 # $lang == 'en'</p>        return $args[$i + 1];                   # return 'Hello'</p>    }</p></pre></p><p><h3><a name="extendingsetstring">Extending setstring</a> </h3></p><p><p></p>If you have repetitive text, you could use setstring with constants, and here's how to do it for the login example above.  First, create a file for each language and define the same constants.</p></p></p><p><h4>french.inc</h4></p><pre></p>&lt;?</p>####################################</p># french.inc</p># $Date$ - $RCSfile$ - $Revision$</p>####################################</p><p>define ('LOGIN_REQUIRED', "Enregistrement requis");</p>define ('LOGIN', "Nom de login");</p>define ('PASSWORD', "Mot de passe");</p>?&gt;</p><p></pre></p><p><h4>english.inc</h4></p><pre></p>&lt;?</p>####################################</p># english.inc</p># $Date$ - $RCSfile$ - $Revision$</p>####################################</p><p>define ('LOGIN_REQUIRED', "Login Required");</p>define ('LOGIN', "Login");</p>define ('PASSWORD', "Password");</p>?&gt;</p><p></pre></p><p><p></p>Then, you just have to use setstring once to build different languages versions. Here, we use setstring to pass the right language file to include.</p></p></p><p><h2><a name="loginpage2">Example 2: The Login Page</a></h2></p><p><pre></p>&lt;? include_once ("./setstring.inc") ?&gt;</p><p>&lt;? include ( setstring ( 'fr', './french.inc', 'en', './english.inc') )?&gt;</p><p>&lt;?= "&lt;a href='" . $PHP_SELF . "?lang=fr'&gt;Fran&amp;ccedil;ais&lt;/a&gt;" ?&gt;  </p>&lt;?= "&lt;a href='" . $PHP_SELF . "?lang=en'&gt;English&lt;/a&gt;" ?&gt;  </p>&lt;?= "&lt;a href='" . $PHP_SELF . "?logoff=1'&gt;Logoff&lt;/a&gt;" ?&gt;</p><p>&lt;form method="post" action="&lt;?=$PHP_SELF?&gt;"&gt;</p>	&lt;p&gt;</p>		&lt;b&gt;&lt;?=LOGIN_REQUIRED?&gt;&lt;/b&gt;</p>	&lt;/p&gt;</p>	&lt;p&gt;</p>		&lt;?=LOGIN?&gt;&lt;br&gt;&lt;input type="text" name="uid" size="8"&gt;</p>	&lt;/p&gt;</p>	&lt;p&gt;</p>		&lt;?=PASSWORD?&gt;&lt;br&gt;&lt;input type="password" name="pwd" size="8"&gt;</p>	&lt;/p&gt;</p>	&lt;p&gt;</p>		&lt;input type="submit" name="processlogin" value=" &lt;?= SUBMIT ?&gt; "&gt;</p>	&lt;/p&gt;</p>&lt;/form&gt;</p><p></pre></p><p><p></p>If you have a lot of text you can use an <code>include</code> function with <code>setstring</code>. You create a file for each language as above, and then use the <code>include</code> function:</p></p></p><p><h2><a name="loginpage3">Example 3: include and setstring</a></h2></p><p><pre></p>&lt;? include_once ("./setstring.inc") ?&gt;</p><p>&lt;?= "&lt;a href='" . $PHP_SELF . "?lang=fr'&gt;Fran&amp;ccedil;ais&lt;/a&gt;" ?&gt;  </p>&lt;?= "&lt;a href='" . $PHP_SELF . "?lang=en'&gt;English&lt;/a&gt;" ?&gt;  </p>&lt;?= "&lt;a href='" . $PHP_SELF . "?logoff=1'&gt;Logoff&lt;/a&gt;" ?&gt;</p><p>&lt;? include ( setstring ( 'fr', './filefrench.inc', 'en', './fileenglish.inc') )?&gt;</p></pre></p><p></p><h2><a name="versionshistory">Version History</a> </h2></p><p><p></p>Version 1.0 </p>	<blockquote></p>	First release: December 19 2002.<br></p>	Open Source (BSD license).<br></p>	A big thanks to <a href="http://nyphp.org" title="http://nyphp.org">Hans Zaunere</a>, <a href="http://www.mcu.org.uk/" title="http://www.mcu.org.uk/">Jim Byrne</a>, Jaz-Michael King, and <a href="http://www.bouzou.com" title="http://www.bouzou.com">Deke Smith</a> for reviewing this text.<br></p>	</blockquote></p></p></p><p><h2><a name="requirements">Requirements</a> </h2></p><p><p></p>PHP greater than 4.1.x<br></p></p></p><p><h2><a name="download">Download</a> </h2></p><p><p></p><a href="http://scriptdigital.com/divers/gems/setstring.txt" target="_blank" title="Opens in a new window">Save this page</a> to your disk as &quot;<code>setstring.inc</code>&quot;.</p></p></p><p><h2>Notes</em></h2></p><p><p></p><ul></p><li></p><a href="http://www.onlamp.com/pub/a/php/2002/11/28/php_i18n.html?page=1" target="_blank" title="Opens in a new window">Internationalization and Localization with PHP</a><a name="note1">&nbsp;</a><br></p>by Adam Trachtenberg</p></li></p><p><li></p><a href="http://www.onlamp.com/pub/a/php/2002/06/13/php.html" target="_blank" title="Opens in a new window">Gettext</a><a name="note2">&nbsp;</a><br></p>by Joao Prado Maia<br></p>http://www.onlamp.com/pub/a/php/2002/06/13/php.html</a></p></li></p></ul>