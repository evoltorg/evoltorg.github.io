---
layout: post
permalink: node/44112
ratings: 11
avgrate: 4.1818
category: Backend
user: iisdude
real_name: "Matt Foley"
user_biog: "Matt Foley is a former Solaris sysadmin who was turned to the \"darkside\" and is now works for a large southern California hosting and Web agency. He quite likes Windows now in spite of himself."
user_since: 15 Oct 2002
avatar: ""
article_count: 1
excerpt: "It would be nice if everything ran in a vacuum so that when something goes wrong you know what caused it, but in the real world most software is dependent on other software. ASP, ASP.NET, ColdFusion, JSP, Perl are no different... they run on top of IIS. Here\'s a list of ten ways to make I..."
---
<p>As an IIS administrator it sometimes gets downright annoying having to fend off all the insults from Apache admins I meet claiming innate server superiority.  Generally the discussion about Web administration starts first with all the various security holes plaguing IIS and the negative press the platform garnered over the last year.  Then it invariably moves to a discussion about how <a href="http://www.netcraft.com" target="_blank" title="Link opens in a new window">Netcraft</a>  and other stats sites show Apache as the dominant server on the Web, or how a certain big site uses Apache, or how there are so many cool <a href="http://httpd.apache.org/docs/mod/" target="_blank" title="Link opens in a new window">modules</a> to add to Apache.  Pointing out that scads of non-identified corporate in-house servers run IIS, or that it too is a free server (since it comes with the operating system), or that there are in fact plenty of cool <a href="http://www.iisfaq.com/default.asp?View=P11" target="_blank" title="Link opens in a new window">add-ons for IIS</a> (including many that provide <a href="http://www.genusa.com/isapi/isapisrc.html" target="_blank" title="Link opens in a new window">source code</a>) &#8212; all this does little to dissuade these server chauvinists of their opinion.  Rather than whining about rude Apache admins, however, I thought it would be a more useful response simply to write down some of the ways I've found of improving IIS.  So without further delay here are my top ten tips for making the most of your IIS.</p> </p><p></p><h2>Tip 10: Customize Your Error Pages</h2></p><p><p>Although this is quite simple to do, few people seem to take advantage of it.  Just select the &quot;Custom Errors&quot; tab in MMC and map each error, such as 404, to the appropriate HTML or ASP template.  Full details can be found <a href="http://www.15seconds.com/issue/980210.htm" target="_blank" title="Link opens in a new window">here</a>.  If you want an even easier solution &#8212; or if you want to let developers handle the mapping without giving them access to the MMC &#8212; use a product like <a href="http://www.customerror.com" target="_blank" title="Link opens in a new window">CustomError</a>.</p></p><p><h2>Tip 9: Dive into the MetaBase</h2></p><p><p>If you think Apache is powerful because it has a config file, then take a look at the MetaBase.  You can do just about anything you want with IIS by editing the MetaBase.  For example, you can create virtual directories and servers; stop, start and pause Web sites; and create, delete, enable and disable applications.</p></p><p><p>Microsoft provides a GUI utility called MetaEdit, somewhat similar to RegEdit, </p>to help you read from and write to the MetaBase.  Download the latest version </p><a href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;q232068&" target="_blank" title="Link opens in a new window">here</a>.  But to really  impress those UNIX admins &#8212; and to take full advantage of the MetaBase by learning how to manipulate it programmatically &#8212; you'll want to try out the command-line interface, officially called the IIS Administration Script Utility.  Its short name is adsutil.vbs and you'll find it in <code>C:\inetpub\adminscripts</code>, or else in <code>%SystemRoot%\system32\inetsrv\adminsamples</code>, together with a host of other </p>useful administrative scripts.</p></p><p><p>A word of caution though:  Just like Apache conf files, the MetaBase is pretty crucial to the functioning of your Web server, so don't ruin it.  <a href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q300672&" target="_blank" title="Link opens in a new window">Back it up first</a>.</p></p><p><h2>Tip 8: Add spell checking to your URLs</h2></p><p><p>Apache folks always brag about cool little tricks that Apache is capable of &#8212; especially because of the wealth of modules that can extend the server's basic functionality.  One of the coolest of these is the ability to fix URL typos using a module called mod_speling. Well, thanks to the folks at Port80 Software, it now appears that IIS admins can do this trick too, using an ISAPI filter called <a href="http://www.urlspellcheck.com" target="_blank" title="Link opens in a new window">URLSpellCheck</a>.  You can check it out right on their site, by trying URLs like <a href="http://www.urlspellcheck.com/fak.htm" target="_blank" title="Link opens in a new window">www.urlspellcheck.com/fak.htm</a>, <a href="http://www.urlspellcheck.com/faq1.htm" target="_blank" title="Link opens in a new window">www.urlspellcheck.com/faq1.htm</a> &#8212; or any other simple typo you care to make.</p></p><p><h2>Tip 7: Rewrite your URLs</h2></p><p><p>Cleaning your URLs has all sorts of benefits &#8212; it can improve the security of your site, ease migration woes, and provide an extra layer of abstraction to your Web applications. Moving from a ColdFusion to an ASP based site, for example, is no big deal if you can  remap the URLs.  Apache users have long bragged about the huge power of mod_rewrite &#8212; the standard Apache module for URL rewriting.  Well, there are now literally a dozen versions of this type </p>of product for IIS &#8212; many of them quite a bit easier to use than mod_rewrite, which tends to presume familiarity with  regular expression arcana.  Check out, for example, <a href="http://www.qwerksoft.com/products/iisrewrite/" target="_blank" title="Link opens in a new window">IIS ReWrite</a> or <a href="http://www.isapirewrite.com/" target="_blank" title="Link opens in a new window">ISAPI ReWrite</a>.  So brag no more, Apache partisans.</p></p><p><h2>Tip 6: Add browser detection</h2></p><p><p>There are a lot of ways to build Web sites, but assuming everybody has a certain browser or screen size is just plain stupid.  Simple JavaScript sniff-scripts exist for client-side browser detection, but if you are an IIS user you can do better with a product called </p><a href="http://www.browserhawk.com/" target="_blank" title="Link opens in a new window">BrowserHawk</a> from CyScape.  The Apache world doesn't really have something comparable to this popular, mature and well-supported product.  Speaking of CyScape, they've recently added an interesting-looking related product called <a href="http://www.browserhawk.com/products/country/intro.asp" target="_blank" title="Link opens in a new window">CountryHawk</a> that helps with location detection, but so far I haven't had the language- or location-sensitive content to warrant trying it out.</p></p><p><h2>Tip 5: Gzip site content</h2></p><p><p>Browsers can handle Gzipped and deflated content and decompress it on the fly.  While IIS 5 had a gzip feature built-in, it is pretty much broken.  Enter products like <a href="http://www.pipeboost.com/" target="_blank" title="Link opens in a new window">Pipeboost</a> to give us better functionality &#8212; similar to what Apache users have enjoyed with <a href="http://www.remotecommunications.com/apache/mod_gzip/" target="_blank" title="Link opens in a new window">mod_gzip</a>.  Don't waste your  bandwidth &#8212; even Google encodes its content, and their pages are tiny.</p></p><p><h2>Tip 4: Cache your content</h2></p><p><p>While I'm on the topic of improving performance, remember to make your site cache friendly.  You can set expiration headers for different files or directories right from the MMC.  Just right click on an item via the IIS MMC, flip to the "HTTP Headers" tab, and away you go.  If you want to set cache control headers programmatically &#8212; or even better, let your site developers do it &#8212; use something like <a href="http://www.cacheright.com" target="_blank" title="Link opens in a new window">CacheRight</a>.  If you want to go further and add reverse proxy caching, particularly for generated content, use a product like <a href="http://www.xcache.com/home/default.asp?c=45&p=352" target="_blank" title="Link opens in a new window">XCache</a> &#8212; which also throws in compression.</p></p><p><p>It might involve more time and expense to take full advantage of caching, but when you watch your logs shrink because they don't contain tons of pointless 304 responses, and your bandwidth consumption drop like a stone, even while your total page views increase over the same period, you'll start to understand why this particular tip was so important.  Cache friendly sites are quite rare, but there is plenty of information available online about the enormous benefits to be had by doing it right:  Check out <a href="http://www.web-caching.com" target="_blank" title="Link opens in a new window">Brian Davidson's page</a>, this nifty tutorial from <a href="http://www.mnot.net/cache_docs/" target="_blank" title="Link opens in a new window">Mark Nottingham</a>, and <a href="http://webmaster.info.aol.com/index.cfm?sitenum=2&article=12" target="_blank" title="Link opens in a new window">what AOL has to say</a> on the subject.</p></p><p><h2>Tip 3: Tune your server</h2></p><p><p>Tuning IIS is no small topic &#8212; whole books and courses are dedicated to it.  But </p>some good basic help is available online, such as this piece from IIS guru <a href="http://www.iisadministrator.com/Articles/Index.cfm?ArticleID=16144" target="_blank" title="Link opens in a new window">Brett Hill</a>, or this <a href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;q308186&" target="_blank" title="Link opens in a new window">Knowledge Base article</a> from Microsoft itself.  However, if you don't feel like getting your hands dirty &#8212; or can't afford the time and expense of turning yourself into an expert &#8212; take a look at <a href="http://www.xcache.com/home/default.asp?c=51&p=334" target="_blank" title="Link opens in a new window">XTune</a>, from the makers of XCache.  It's performance tuning wizards step you through the process of tuning your IIS environment, making expert recommendations along the way.</p></p><p><h2>Tip 2: Secure your server with simple fixes</h2></p><p><p>Sure people are going to attack sites, but you don't have to be a sitting duck if you're willing to make even a small effort.  First off, don't advertise the fact that you are running IIS by showing your HTTP server header.  Remove or replace it using something like <a href="http://www.servermask.com" target="_blank" title="Link opens in a new window">ServerMask</a> &#8212; probably the best twenty-five bucks you'll ever spend.  You can go farther than this by removing unnecessary file extensions to further camouflage your server environment, and scanning request URLs for signs of exploits.  There are number of commercial products that do user input scanning, and Microsoft offers a free tool called <a href="http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/tools/tools/urlscan.asp?frame=true" target="_blank" title="Link opens in a new window">URLScan</a> which does the job.  URLScan runs in conjunction with <a href="http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/tools/tools/locktool.asp" target="_blank" title="Link opens in a new window">IISLockDown</a>, a standard security package that should probably be installed on every IIS server on the planet.  These are simple fixes that could pay off big, so do them now.</p></p><p><h2>Tip 1: Patch, patch, patch!</h2></p><p><p>Okay, we in the IIS world do have to patch our systems and make hotfixes.  However, as a former Solaris admin I had to do the same thing there, so I am not sure why this is a big surprise.  You really need to keep up with the patches, Microsoft is of course the <a href="http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/current.asp" target="_blank" title="Link opens in a new window">definitive source</a>, but if you can also use the highly regarded <a href="http://www.cert.org/" target="_blank" title="Link opens in a new window">www.cert.org</a>.  Simply search on &quot;IIS&quot;.</p></p><p><p>Well there you have it: 10 tips for IIS admins to improve their servers.  Some of the tips might become obsolete once IIS 6 is gold, but, for now at least, W2K and NT IIS admins should apply a few of these today and sleep a little better at night.</p>