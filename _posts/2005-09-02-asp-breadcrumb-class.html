---
layout: post
permalink: asp-breadcrumb-class
ratings: 0
avgrate: 
category: Code
user: pittster
real_name: ""
user_biog: ""
user_since: 
avatar: 
article_count: 0
excerpt: "This is an ASP class that generates a breadcrumb style navigation based on the website\'s directory structure. It is an implementation of the BreadCrumbs PHP Class @ www.backettcase.com and some code \'borrowed\' from Adrian Roselli\'s \"Breadcrumbs for Those Using ASP\" on this very site."
---
  <h2>Background</h2></p><p><p></p>My current employer Etelesolv (<a href='http://www.etelesolv.com' target="_blank">www.etelesolv.com</a>) had a client that, as part of their new website, required that required breadcrumb nav.  The project was to use ASP . </p></p><p></p>I had used the <a href="http://www.baskettcase.com/classes/breadcrumb/" target="_blank"> BreadCrumbs PHP Class</a>, by Richard Baskitt,  for a couple of projects and I wanted to have a class similar to it that would easily implement this type of navigation. The closest thing I could find on the web was <a href='http://www.roselli.org' target="_blank">Adrian Roselli's</a>   <a href="http://www.evolt.org/article/Breadcrumbs_for_Those_Using_ASP/17/4438/" target="_blank"> "Breadcrumbs for Those Using ASP"</a> evolt.org article.</p></p></p><p></p>So I proceded to use the Breadcrumb PHP Class model and implement some of Adrien's string manipulation methods with a touch of <a href="http://www.asp101.com" target="_blank">ASP 101</a> for the PCase method, </p> to create a reusable piece of code that our developers could use on any of their projects. I now share it with you.... (dramatic reverberation)</p><p></p></p><p></p>Here is the code:</p><pre></p>&lt;%</p>'BreadCrumb Class v1.0</p>'Created by Jason Irving Copyright 2005 - pittster@hotmail.com</p>'Last Update January 24, 2005</p>'This class was heavily influenced by Breadcrumbs PHP Class @ http://www.baskettcase.com/classes/breadcrumb/</p>'the build method was inspired by breadcrumb.asp  Version 1.0 by  Adrian Roselli  adrian@roselli.org  @ http://www.evolt.org/article/Breadcrumbs_for_Those_Using_ASP/17/4438/</p><p>'********Properties</p>'cssClass : string - css stylesheet class for the &lt;a&gt; tag</p>'to separate the style for the delimiter, use the following css syntax example</p>' mystyle { color: blue; }</p>' mystyle a {color: red; }</p>' the delimiter will be in the first style, the link in the second</p>'Homepage : string - name of the homepage</p>'Uscore2Space : boolean string (1, yes, true) - replace underscores with " " space</p>'wordCase : string (mixed, upper, lower) - </p>'Delimiter : string - the text delimiter between elements</p>'showFiles : boolean string (1, yes, true) - append the name of the viewed file to menu</p>'showFilesNoExt: boolean string (1, yes, true) - append the name of the viewed file to menu without extension, overrides showFiles</p>'</p><p>'*********Methods</p>'build() - print the menu</p>'changeName : string tag, string, str - Hashtable of elements and replacement words</p><p>class clsBreadCrumb</p><p>	Private strDelimiter</p>	Private dictReplaceWords</p>	Private strPath</p>	Private strCSSClass</p>	Private strHomePage </p>	Private bolUscore2Space</p>	Private bolShowFiles</p>	Private bolShowFilesNoExt</p>	Private strCaseFormat</p>	</p>	Private Sub Class_Initialize()</p>	strCSSClass = "" </p>	strHomePage = "home" </p>	strPath = Request.ServerVariables("PATH_INFO")</p>	bolUscore2Space = "1" </p>	strCaseFormat = "mixed"</p>	bolShowFiles = "1"</p>	bolShowFilesNoExt = "0"</p>	strDelimiter = ">"</p>	set dictReplaceWords = Server.CreateObject("Scripting.Dictionary")</p>	End Sub</p><p>	</p>	Private Sub Class_Terminate()</p>	dictReplaceWords = nothing</p>	End Sub</p><p>	'*********Properties*************</p>	</p>	'*****SET</p>	Public Property Let cssClass(str)</p>		strCSSClass = " class='" & str & "'"</p>	End Property</p>	</p>	Public Property Let Homepage(str)</p>		strHomePage = str</p>	End Property</p>	</p>	Public Property Let showFiles(str)</p>		if lcase(trim(str)) = "1" or lcase(trim(str)) = "yes" or lcase(trim(str)) = "true" then</p>			bolShowFiles = 1</p>		else</p>			bolShowFiles = 0</p>		end if</p>	End Property</p>	</p>	Public Property Let showFilesNoExt(str)</p>		if lcase(trim(str)) = "1" or lcase(trim(str)) = "yes" or lcase(trim(str)) = "true" then</p>			bolShowFilesNoExt = 1</p>		else</p>			bolShowFilesNoExt = 0</p>		end if</p>	End Property</p>	</p>	Public Property Let Uscore2Space(str)</p>		if lcase(trim(str)) = "1" or lcase(trim(str)) = "yes" or lcase(trim(str)) = "true" then</p>			bolUscore2Space = 1</p>		else</p>			bolUscore2Space = 0</p>		end if</p>	End Property</p>	</p>	Public Property Let wordCase(str)</p>		if lcase(trim(str)) = "mixed" or lcase(trim(str)) = "upper" or lcase(trim(str)) = "lower" then</p>			strCaseFormat = lcase(trim(str))</p>		else</p>			strCaseFormat = "mixed"</p>		end if</p>	End Property</p>	</p>	Public Property Let Delimiter(str)</p>		strDelimiter = Server.HTMLEncode(trim(str))</p>	End Property</p>	</p><p></p>'*********Methods*************</p><p>	Public Function changeName(tag,str)</p>		dictReplaceWords.add lcase(tag), lcase(str)</p>	End Function</p>	</p>Public Function Build()</p>dim tmpPath</p>dim strTmpPath</p>dim DirPath</p>dim FullPath</p>dim strContent</p><p>FullPath = strPath</p>response.write ("<span  & strCSSClass & >")</p><p>Do Until instr(1,FullPath,"/") = 0</p><p>	'Split the string on the "/"</p>	strTmpPath = Trim(mid(FullPath,1,instr(1,FullPath,"/")-1))</p>	DirPath = DirPath & strTmpPath & "/"</p><p>	'Replace the underscore with a space if the option is set</p>	</p>	if bolUscore2Space = 1 then</p>	strTmpPath = Replace(Trim(strTmpPath),"_"," ")</p>	end if</p>	</p>	</p>	if dictReplaceWords.exists(lcase(strTmpPath)) then</p>	strTmpPath = dictReplaceWords.item(strTmpPath)</p>	end if</p>	</p>	'Apply the appropriate case to the entry</p>	</p>	'get the next directory	</p>	FullPath = mid(FullPath,instr(1,FullPath,"/")+1,Len(FullPath)-Len(tmpPath))</p>	</p>	'create the filename entry if applicable</p>	dim tmpFileName</p>	dim tmpFileNameLabel</p>	</p>	tmpFileName = FullPath</p>	</p>	if instr(1,tmpFileName,"/") = 0 then</p>		if bolShowFilesNoExt = "1" then</p>			dim intPos</p>			intPos = InStrRev(tmpFileName , ".", -1, 1)</p>	    	if intPos > 0 Then</p>		        tmpFileNameLabel = Left(tmpFileName , intPos - 1)</p>			end if</p>		else</p>			tmpFileNameLabel = tmpFileName</p>		end if</p>	else</p>		tmpFileName = ""</p>	end if</p>	</p>	select case lcase(strCaseFormat)</p>	case "mixed"</p>	strTmpPath = PCase(strTmpPath)</p>	strHomePage = PCase(strHomePage)</p>	case "upper"</p>	strTmpPath = UCase(strTmpPath)</p>	strHomePage = UCase(strHomePage)</p>	case "lower"</p>	strTmpPath = LCase(strTmpPath)</p>	strHomePage = LCase(strHomePage)</p>	case else</p>	strTmpPath = PCase(strTmpPath)</p>	strHomePage = PCase(strHomePage)</p>	end select</p><p>	</p>	'add home page link</p>	if strTmpPath = "" then</p>	response.write "<a href='/'  & strCSSClass & >" & strHomePage & "</a>"</p>	else</p>		response.write " " & strDelimiter & " <a href="" & DirPath &   & strCSSClass & >" & strTmpPath & "</a>"</p>	end if</p>	</p>	if tmpFileName <> "" then</p>		if bolShowFiles = "1" or bolShowFilesNoExt = "1" then</p>		response.write " " & strDelimiter & " <a href="" & DirPath & tmpFileName &   & strCSSClass & >" & tmpFileNameLabel & "</a>"</p>		end if</p>	end if</p>	</p>Loop</p>response.write ("</span>")</p>End Function</p><p></p><p>'************************************************************</p>' This function takes a string and converts to Proper Case.</p>' Prototyped by: Brian Shamblen on 3/18/99</p>' This version by: Us... naturally! - ASP 101</p>'************************************************************</p><p>private Function PCase(strInput)</p>	Dim iPosition  ' Our current position in the string (First character = 1)</p>	Dim iSpace     ' The position of the next space after our iPosition</p>	Dim strOutput  ' Our temporary string used to build the function's output</p><p>	' Set our position variable to the start of the string.</p>	iPosition = 1</p>	</p>	' We loop through the string checking for spaces.</p>	' If there are unhandled spaces left, we handle them...</p>	Do While InStr(iPosition, strInput, " ", 1) <> 0</p>		' To begin with, we find the position of the offending space.</p>		iSpace = InStr(iPosition, strInput, " ", 1)</p>		</p>		' We uppercase (and append to our output) the first character after</p>		' the space which was handled by the previous run through the loop.</p>		strOutput = strOutput & UCase(Mid(strInput, iPosition, 1))</p>		</p>		' We lowercase (and append to our output) the rest of the string</p>		' up to and including the current space.</p>		strOutput = strOutput & LCase(Mid(strInput, iPosition + 1, iSpace - iPosition))</p><p>		' Note:</p>		' The above line is something you may wish to change to not convert</p>		' everything to lowercase.  Currently things like "McCarthy" end up</p>		' as "Mccarthy", but if you do change it, it won't fix things like</p>		' ALL CAPS.  I don't see an easy compromise so I simply did it the</p>		' way I'd expect it to work and the way the VB command</p>		' StrConv(string, vbProperCase) works.  Any other functionality is</p>		' left "as an exercise for the reader!"</p>		</p>		' Set our location to start looking for spaces to the</p>		' position immediately after the last space.</p>		iPosition = iSpace + 1</p>	Loop</p><p>	' Because we loop until there are no more spaces, it leaves us</p>	' with the last word uncapitalized so we handle that here.</p>	' This also takes care of capitalizing single word strings.</p>	' It's the same as the two lines inside the loop except the</p>	' second line LCase's to the end and not to the next space.</p>	strOutput = strOutput & UCase(Mid(strInput, iPosition, 1))</p>	strOutput = strOutput & LCase(Mid(strInput, iPosition + 1))</p><p>	' That's it - Set our return value and exit</p>	PCase = strOutput</p>End Function</p><p>end class %&gt;</p></pre></p><p><p>To implement it on a page, simply do the following</p></p><pre></p>&lt;%</p>dim objBreadCrumb</p>set objBreadCrumb = new clsBreadCrumb</p><p>'Set a property</p>objBreadCrumb.wordCase = "upper" </p><p>' Changes the instance of a directory called "about" to "about this site"</p><p>objBreadCrumb.changeName("about", "about this site") </p>objBreadCrumb.Build()</p>%&gt;</p></pre></p><p><p>Use the guides at the top of the class source code and VOILA! a breadcrumb nav.</p></p><p><p>Enjoy,<br />Jason Irving</p>