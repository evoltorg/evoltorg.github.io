---
layout: post
permalink: node/786
ratings: 0
avgrate: 
categories: [Code]
user: deboute
real_name: "benjamin deboute"
user_biog: ""
user_since: 14 Dec 1999
avatar: 
article_count: 2
excerpt: "  Have you ever wondered what is the price to pay for Evolution? I mean upgrading your pages to reach the current W3C standard, every 6 months.</p>When xHTML went recommended I asked myself :: \"What would you do, my dear friend, if you have 2 handfuls of sites running and your clients cal..."
---
<p></p>  Have you ever wondered what is the price to pay for Evolution? I mean upgrading your pages to reach the current W3C standard, every 6 months.</p></P></p><P></p>  When xHTML went recommended I asked myself :: "What would you do, my dear friend, if you have 2 handfuls of sites running and your clients call, asking that the pages should be standard compliant tomorrow?  They would find my cold body on my chair, my face buried in the monitor up to the neck."</p></P></p><P></p>  Then I found a solution...and it may be yours now , )</p></P></p><P></p>  I searched if it was possible to build an engine which would ouput pages undependent of HTML code - an engine that would receive instructions, process them through the current lexicon you give it (i.e. : HTML4.0/xHTML...), translate, and serve.</p></P></p><P></p>  I found an <A HREF="http://www.phpbuilder.com/columns/zhang19990610.php3" TARGET="php">article</A> about class.layout in phpBuilder. First, when I saw this, I yelled :: "HERESY!"  The next day, I had the strange feeling that it could have missed somthing important, and re-read it. I had the solution, I found the Grail!</p></P></p><P></p>  Class.layout sets up tag constructors, functions whose variables are tag attributes and their values. After a little tweaking, this class was fully xHTML compliant, and if my pages had used it, each one would have been xHTML complient in half an hour.</p></P></p><P></p>  Let's go through the principles of this <A HREF="http://www.nerdsoul.com/evolt/class_layout.txt" TARGET="php">class</A>, then we'll see how to modify it, and how to built a php page that ouputs pages with browser-specific HTML.</p></P></p><P></p>  I would advice you to take a look at the <A HREF="http://www.phpbuilder.com/columns/zhang19990610.php3" TARGET="php">phpBuilder article</A> first, as i don't want to paraphrase it, and want to avoid making this article too awfully long, and as i go deeper into concepts i introduced in my <A HREF="http://www.evolt.org/index.cfm?menu=8&cid=734&catid=17" TARGET="php">precedent article</A>, you should perhaps get a look on it.</p></P></p><P></p>  Beware, I jump into the serious things right now...I warned you, read the <A HREF="http://www.phpbuilder.com/columns/zhang19990610.php3" TARGET="php">phpBuilder </p>  article</A> first , )</p></P></p><h3></p>  How it works ::</p></h3></p><P></p>  Let's analyse the text constructor.</p></P></p><P></p>  <CODE></p>  <pre></p>    class Text extends HTMLBase {</p>      var $classname = &quot;text&quot;;</p>      var $str; </p>      function Text($s,$a = &quot;&quot;) { </p>        // gets the attributes, then they are stocked into 'settings'</p>        // by the parent constructor magic. Trust me.</p>        $this-&gt;setparam($a);</p>        //gets the text string</p>        $this-&gt;str = $s; </p>      } </p>      function printit() { </p>        echo &quot;&lt;FONT&quot;. $this-&gt;settings . &quot;&gt;&quot;; </p>        echo $this-&gt;str; </p>        echo &quot;&lt;/FONT&gt;&quot;; </p>      } </p>    }</p>  </pre></p>  </CODE></p></P></p><p><P></p>  Use it.</p></P></p><p><P></p>  <pre></p>    insert($where_you_want, text(&quot;php-foo&quot;, array(&quot;face&quot;=&gt;&quot;arial&quot;,&quot;color&quot;=&gt;&quot;lime&quot;, &quot;id&quot;=&gt;&quot;test&quot;)));</p>  </pre></p></P></p><h3></p>  What it does ::</p></h3></p><P></p>  It outputs in the element $where_you_want (predefined element that could be a table, a layer, a div...) the tag container &lt;FONT&gt; and the variables you gave it.</p></P></p><p><P></p>  <CODE></p>    &lt;FONT FACE=&quot;arial&quot; COLOR=&quot;lime&quot; ID=&quot;test&quot;&gt;php-foo&lt;/FONT&gt;</p>  </CODE></p></P></p><p><P></p>  ok?</p></P></p><h3></p>  How to modify it ::</p></h3></p><P></p>  I'm no phpwizz, i'm no OOPguru, I only took a deep breath and experimented. The example will be how to make a xHTML defined page based on the standard HTML class.</p></P></p><P></p>  The html newhtml() constructor ::</p></P></p><p><P></p>  <CODE></p>  <pre></p>    function newhtml(&amp;$w,$a = &quot;&quot;) { </p>      $w = html($a); </p>    }</p>    ...</p>    function html($a = &quot;&quot;) { </p>      $na = md5(microtime()); $GLOBALS[&quot;$na&quot;] = new Html($a); </p>      return $na ; </p>    }</p>    ...</p>    class Html extends HTMLBase { </p>      var $classname = &quot;html&quot;; </p>      function html($a = &quot;&quot;) { </p>        $this-&gt;setparam($a); </p>      } </p>      function printit() { </p>        echo &gt;&lt;!DOCTYPE HTML PUBLIC \&gt;-//W3C//DTD HTML 4.0 Transitional//EN\&gt;&gt;</p>&gt;; </p>        echo &gt;</p>&lt;HEAD&gt;</p>&quot;; </p>        $this-&gt;printheader(); </p>        echo &quot;</p>&lt;HEAD&gt;</p>settings . &quot; &gt;&quot;; </p>        $this-&gt;printchild(); </p>      } </p>      function printheader() { </p>        if (is_array($this-&gt;children)) { </p>          reset($this-&gt;children); </p>          while ( list(,$ch) = each($this-&gt;children) ) { </p>            if ( getclass($ch) == &quot;wheader&quot; ) { </p>              $GLOBALS[&quot;$ch&quot;]-&gt;printit();</p>            } </p>          } </p>        } </p>      } </p>    }</p>    </pre></p>  </CODE></p></P></p><p><P></p>  To build a newxhtml() func...</p></P></p><p><P></p>  <CODE></p>  <pre></p>    function newxhtml(&amp;$w,$a = &quot;&quot;) { </p>      $w = xhtml($a); </p>    }</p>    ...</p>    function xhtml($a = &quot;&quot;) { </p>      $na = md5(microtime()); $GLOBALS[&quot;$na&quot;] = new Xhtml($a); </p>      return $na ; </p>    }</p>    ...</p>    class Xhtml extends HTMLBase { </p>      var $classname = &quot;xhtml&quot;; </p>      function xhtml($a = &quot;&quot;) { </p>        $this-&gt;setparam($a); </p>      } </p>      function printit() { </p>        echo &quot;&lt;? XML VERSION=\&quot;1.0\&quot; ENCODING=\&quot;UTF-8\&quot; ?&gt;&quot;; </p>        echo &quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//W3C//DTD XHTML 1.0 Transitional//EN\&quot; \&quot;DTD/XHTML1-strict.DTD\&quot;&gt;</p>&quot;; </p>        echo &quot;</p>&lt;HEAD&gt;</p>&quot;; </p>        $this-&gt;printheader(); </p>        echo &quot;</p>&lt;HEAD&gt;</p>settings . &quot; &gt;&quot;; </p>        $this-&gt;printchild(); </p>      } </p>      function printheader() { </p>        if (is_array($this-&gt;children)) { </p>          reset($this-&gt;children); </p>          while ( list(,$ch) = each($this-&gt;children) ) { </p>            if ( getclass($ch) == &quot;wheader&quot; ) { </p>              $GLOBALS[&quot;$ch&quot;]-&gt;printit(); </p>            } </p>          } </p>        } </p>      } </p>    }</p>    </pre></p>  </CODE></p></P></p><p><P></p>  EASY! Look Ma, I know OOP !!!!!</p></P></p><P>These tweakin's were essential, cuz' the open-sourced version of class.layout was very restrictive.  You couldn't just output a serie of tags, the part of a page, you were obliged to construct your page like a block. Now you know how to tweak it, you can create your constructors. I added a newsnip() which outputs only the tags you insert()... </P></p><P></p>  Now, let's see the REALLY serious things. I discovered that I can use this class to create pages which use the fundamentals of CSS...but on STEROIDS !!</p></P></p><P></p>  With php, you can define veriables that hold any string you want, ok?  Let's see some vars.</p></P></p><p><P></p>  <CODE></p>    $mailto = &quot;you@your.address&quot;;</p>    $bckgrnd = &quot;background.gif&quot;;</p>  </CODE></p></P></p><p><P></p>    Okay, quite simple stuff.  Now, i want to trim down all the redundancies in my code.  Say I use several lines like this in my code ::</p></P></p><p><P></p>  <pre></p>    insert($w,$title = table(array(&quot;width&quot;=&gt;&quot;100%&quot;, &quot;border&quot;=&gt;&quot;0&quot;, &quot;cols&quot;=&gt;&quot;2&quot;)));</p>  </pre></p></P></p><p><P></p>  I could define</p></P></p><p><P></p>  <pre></p>    $basic_table = array(&quot;width&quot;=&gt;&quot;100%&quot;, &quot;border&quot;=&gt;&quot;0&quot;, &quot;cols&quot;=&gt;&quot;2&quot;);</p>  ...</p>  insert($w, $title = table($basic_table));</p>  </pre></p></P></p><p><P></p>  Do you feel the scheme?</p></P></p><h3></p>  i.e. a menu box ::</p></h3></p><P></p>  <CODE></p>  <pre></p>&lt;TABLE CELLPADDING=&quot;0&quot; CELLSPACING=&quot;0&quot; BORDER=&quot;1&quot; BORDERCOLOR=&quot;#CCCCCC&quot; HEIGHT=&quot;10&quot; WIDTH=&quot;76&quot; ID=&quot;menu&quot;&gt;</p>  &lt;TR&gt;</p>    &lt;TD WIDTH=&quot;71&quot;&gt;</p>      &lt;A</p>       HREF=&quot;/blitzblog.php3&quot;</p>       onMouseOver=&quot;chgcolor(2,1);</p>                    window.status='daily memes harvest/net hype of the day';</p>                    return true&quot;</p>       onMouseOut=&quot;chgcolor(2,1,1);</p>                   window.status='';</p>                   return true&quot;</p>       ID=&quot;linkk&quot;</p>       TITLE=&quot;'daily memes harvest/net hype of the day'&quot;</p>      &gt;blitz&#124;blog&lt;/A&gt;</p>    &lt;/TD&gt;</p>    &lt;TD WIDTH=&quot;5&quot;&gt;</p>     &lt;A</p>       HREF=&quot;/blitzblog.php3&quot;</p>       onMouseOver=&quot;chgcolor(2,1); </p>                    window.status='daily memes harvest/net hype of the day';</p>                    return true&quot;</p>       onMouseOut=&quot;chgcolor(2,1,1); </p>                   window.status='';</p>                   return true&quot;</p>       ID=&quot;linkk&quot;</p>       TITLE=&quot;'daily memes harvest/net hype of the day'&quot;</p>      &gt;&raquo;&lt;/A&gt;</p>    &lt;/TD&gt;</p>  &lt;/TR&gt;</p>&lt;/TABLE&gt;</p>  </pre></p>  </CODE></p></P></p><p><P></p>  is translated to</p></P></p><p><P></p>  <CODE></p>  <pre></p>    insert($menucell, $submenu = table($submenu_attr)); </p>    insert($submenu, $linkcell = cell($wdth1)); </p>    insert($linkcell, $blitzblog); </p>    insert($submenu, $gtcell = cell($wdth2)); </p>    insert($gtcell, $blitzbloggt);</p>  </pre></p>  </CODE></p></P></p><p><P></p>  With the variables defined ::</p></P></p><p><P></p>  <CODE></p>  <pre></p>$submenu_attr = array(&quot;bordercolor&quot;=&gt;&quot;#CCCCCC&quot;, &quot;height&quot;=&gt;&quot;10&quot;, &quot;cols&quot;=&gt;&quot;2&quot;, &quot;width&quot;=&gt;&quot;76&quot;, &quot;id&quot;=&gt;&quot;menu&quot;); </p>$wdth1 = array(&quot;width&quot;=&gt;&quot;71&quot;); </p>$wdth2 = array(&quot;width&quot;=&gt;&quot;5&quot;);</p>// This means that each of your menu boxes are defined by these 3 variables. </p>//onto the links</p>$altblitzblog = &quot;'daily memes harvest/net hype of the day'&quot;; </p>if (cap == 3) {</p>  $blitzblog = anchor(&quot;/blogger.html&quot;,</p>                      &quot;blitz&#124;blog&quot;,</p>                      array(&quot;onMouseover&quot;=&gt;&quot;chgcolor(2,1);</p>                                            window.status=$altblitzblog;</p>                                            return true&quot;,</p>                            &quot;onMouseout&quot;=&gt;&quot;chgcolor(2,1,1);</p>                                           window.status='';</p>                                           return true&quot;,</p>                            &quot;id&quot;=&gt;&quot;linkk&quot;,</p>                             &quot;title&quot;=&gt;$altblitzblog</p>                           )</p>                      );</p>  $blitzbloggt = anchor(&quot;/blogger.html&quot;,</p>                        &quot;&raquo;&quot;,</p>                        array(&quot;onMouseover&quot;=&gt;&quot;chgcolor(2,1);</p>                                              window.status=$altblitzblog;</p>                                              return true&quot;,</p>                              &quot;onMouseout&quot;=&gt;&quot;chgcolor(2,1,1);</p>                                             window.status='';</p>                                             return true&quot;,</p>                              &quot;id&quot;=&gt;&quot;linkk&quot;,</p>                              &quot;title&quot;=&gt;$altblitzblog</p>                             )</p>                      &nbsp); </p>}</p>else { </p>  $blitzblog = anchor(&quot;/blogger.html&quot;,</p>                      &quot;blitz&#124;blog&quot;,</p>                      array(&quot;onMouseover&quot;=&gt;&quot;window.status=$altblitzblog;</p>                                            return true&quot;,</p>                            &quot;onMouseout&quot;=&gt;&quot;window.status='';</p>                                           return true&quot;,</p>                            &quot;id&quot;=&gt;&quot;linkk&quot;,</p>                            &quot;title&quot;=&gt;$altblitzblog</p>                           )</p>                     );</p>  $blitzbloggt = anchor(&quot;/blogger.html&quot;,</p>                        &quot;&raquo;&quot;,</p>                        array(&quot;onMouseover&quot;=&gt;&quot;window.status=$altblitzblog;</p>                                              return true&quot;,</p>                              &quot;onMouseout&quot;=&gt;&quot;window.status='';</p>                                             return true&quot;,</p>                              &quot;id&quot;=&gt;&quot;linkk&quot;,</p>                              &quot;title&quot;=&gt;$altblitzblog</p>                             )</p>                       ); </p>}</p>  </pre></p>  </CODE></p></P></p><p><P></p>  My favorite topic...each browser got it's output! If i want a js to happen only where it is supported, i summon it here. It may seem excessive, but think that each of your menu boxes will only need the same code (with the appropriate links variables called), and that they will all change in ALL your pages if you tweak a variable in your definition page!</p></P></p><p><P></p>  Uber-CSS for all browsers as it is done server-side!</p></P></p><h3></p>  examples ::</p></H3></p><ul></p><li>  the html output :: <A HREF="http://www.nerdsoul/data/data.html" TARGET="php">data.html</A></li></p><li>  the php source :: <A HREF="http://www.nerdsoul.com/evolt/data.txt" TARGET="php">data.txt</A></li></p><li>  the definitions file :: <A HREF="http://www.nerdsoul.com/evolt/defs.txt" TARGET="php">def.txt</A></li></p><li>  the browser detection file :: <A HREF="http://www.nerdsoul.com/evolt/browserdet.txt" TARGET="php">browserdet.txt</A></li></p><li>  my class.layoutrevised :: <A HREF="http://www.nerdsoul.com/evolt/class_layoutrevisited.txt" TARGET="php">class_layoutrevisited.txt</A></li></p><li>if you want my data.inc :: <A HREF="http://www.nerdsoul.com/evolt/data_inc.txt" TARGET="php">data_inc.txt</A></li></p></ul></p><p><P></p>  Pack all your presentation variables in an included file, share it through your pages and a small change in this file goes through all your site. And i find it easier to read (read my lips :: &quot;no more &lt;/td&gt;s") , ) And it will allow you to use all the other functions of php!</p></P></p><P></p>  You could even include specific langages files IN your definition file. Which means that all your re-used text (menus, footers, headers) could be internationalized easily.</p></P></p><P></p>  If anyone is interested by pushing this experiment further...<A HREF="mailto:deboute@nerdsoul.com">mail me</A></p></P>