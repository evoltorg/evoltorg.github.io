---
layout: post
permalink: node/4438
ratings: 6
avgrate: 4.5000
category: Code
user: aardvark
real_name: "Adrian Roselli"
user_since: 14 Dec 1998
avatar: "/images/pictures/picture-88.gif"
article_count: 85
excerpt: "While we have a great tutorial on how to build a breadcrumb navigation trail using Perl on a Unix/Apache site, I thought it would be nice to have an ASP version as well.  Same concept, except it was developed independently, so it might be a bit different."
---
<p></p>Instead of going through the usefulness of the breadcrumb navigation concept all over again, I'll just refer you to Martin's article, <cite><a href="http://evolt.org/article/Breadcrumbs_for_All/17/4428/evolt.org" title="Breadcrumbs for All - on evolt.org, opens in this window">Breadcrumbs for All</a></cite>.  It's a great tutorial for those of us with Perl and Unix/Apache servers, but it leaves out those of us using ASP on IIS.  It also leaves out a few others, but I'm just doing ASP here, so cut me some slack.</p></p></p><p><p></p>You can see a sample of this code in action at the <a href="http://kenancenter.org/" target="_blank" title="opens in new window">Kenan Center</a> site (the Recreation section has the most depth right now).  This site has only a few levels of directories, but it is still just as useful on that site as on extremely deep sites.</p></p></p><p><p></p>One thing to keep in mind is that you have to name directories in plain english (or your human-readable language of choice) since it uses the directory names for the breadcrumb.  This function will capitalize the words in the directory names, and it replaces all underscores with spaces for display.  It does not handle special characters, but then again, neither does the Windows file system (at least not extended characters).  It's a simple matter of using a <code>replace()</code> function against a pre-defined list of characters to enable that, however.</p></p></p><p><p></p>The code should be created as an include file called <code>breadcrumb.asp</code> and stuffed into your general includes directory.  The page that calls it should have a variable called <code>PageTitle</code> that is the name of the page.  This variable is used by <code>breadcrumb.asp</code> (and if you're smart, the file calling it) to list the current page.  If the variable is blank, however, it just uses the words "Current Page."  It's also worth noting that this script goes right to the root of the site with its links, which may or may not be what you want.</p></p></p><p><pre></p>&lt;% '############################</p><p>'##############################################################################</p>'# breadcrumb.asp                  Version 1.0                                #</p>'# Copyright 2000 Adrian Roselli   adrian@roselli.org                         #</p>'# Created 24/4/2000               Last Modified 24/4/2000                    #</p>'##############################################################################</p>'# COPYRIGHT NOTICE                                                           #</p>'# Copyright [and -left] 2000 Adrian Roselli  All Rights Reserved except as   #</p>'# provided below.                                                            #</p>'#                                                                            #</p>'# breadcrumb.asp may be used and modified free of charge by anyone so long   #</p>'# as this copyright notice and the comments above remain intact. By using    #</p>'# this code you agree to indemnify Adrian Roselli from any liability that    #</p>'# might arise from it's use.                                                 #</p>'#                                                                            #</p>'# This script is released under the GPL.                                     #</p>'# Selling the code for this program or any derivative work is expressly      #</p>'# forbidden. A full copy of the GPL can be found in the Code section of      #</p>'# http://evolt.org. In all cases copyright and this header must remain       #</p>'# intact.                                                                    #</p>'##############################################################################</p><p></p>Function BreadCrumb(FullPath)</p><p>Do Until instr(1,FullPath,&quot;/&quot;) = 0</p><p>	'## Create an array of letters in the alphabet.</p>	Letters = array(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;,&quot;i&quot;,&quot;j&quot;,&quot;k&quot;,&quot;l&quot;,&quot;m&quot;,&quot;n&quot;,&quot;o&quot;,&quot;p&quot;,&quot;q&quot;,&quot;r&quot;,&quot;s&quot;,&quot;t&quot;,&quot;u&quot;,&quot;v&quot;,&quot;w&quot;,&quot;x&quot;,&quot;y&quot;,&quot;z&quot;)</p><p>	'## split on the /</p>	tmpPath = mid(FullPath,1,instr(1,FullPath,&quot;/&quot;)-1)</p>	strTmpPath = Trim(tmpPath)</p>	DirPath = DirPath &amp; strTmpPath &amp; &quot;/&quot;</p><p>	'## upshift the first character</p>	firstLetter = ucase(mid(strTmpPath,1,1))</p>	strTmpPath = firstLetter &amp; mid(strTmpPath,2,len(strTmpPath))</p><p>	'## replace udnerscores with spaces and upshift the following character</p>	for each letter in letters</p>		strTmpPath = Replace(Trim(strTmpPath),&quot;_&quot; &amp; lcase(letter),&quot; &quot; &amp; UCase(letter))</p>	next</p><p>	'## split the next one out	</p>	FullPath = mid(FullPath,instr(1,FullPath,&quot;/&quot;)+1,Len(FullPath)-Len(tmpPath))</p><p>	'## separate them with &gt;&gt; symbols</p>	IF strTmpPath = &quot;&quot; THEN</p>		response.write &quot;&lt;a href=&quot;&quot;/&quot;&quot; style=&quot;&quot;text-decoration:none&quot;&quot;&gt;Home Page&lt;/a&gt;&quot;</p>	ELSEIF strTmpPath = &quot;Home&quot; THEN</p>	ELSE</p>		response.write &quot; &amp;gt; &lt;a href=&quot;&quot;&quot; &amp; DirPath &amp; &quot;&quot;&quot; style=&quot;&quot;text-decoration:none&quot;&quot;&gt;&quot; &amp; strTmpPath &amp; &quot;&lt;/a&gt;&quot;</p>	END IF</p>Loop</p><p>IF PageTitle = &quot;&quot; THEN</p>	response.write &quot; : Current Page&quot;</p>ELSE</p>	response.write &quot; : &quot; &amp; PageTitle</p>END IF</p><p>End Function %&gt;</p></pre></p><p><p></p>To call this code in your page, you need to call the include file and (if you want) set the variable <code>PageTitle</code> as something.  For example:</p></p></p><p><pre></p>&lt;% PageTitle = &quot;About Us&quot; %&gt;</p>&lt;!--#include virtual =&quot;/includes/breadcrumb.asp&quot;--&gt;</p>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;</p>                &quot;http://www.w3.org/TR/REC-html40/loose.dtd&quot;&gt;</p><p>&lt;html lang=&quot;en-us&quot;&gt;</p>&lt;head&gt;</p><p>&lt;title&gt;&lt;% = PageTitle %&gt;&lt;/title&gt;</p>[...]</p></pre></p><p><p></p>When you are ready to call the function on the page to display the breadcrumb trail, simply call it like this:</p></p></p><p><pre></p>&lt;% = BreadCrumb(Request.ServerVariables(&quot;PATH_INFO&quot;)) %&gt;</p></pre></p><p><p></p>The code can easily be tweaked, and some things changed or modified (like the <code>Letters</code> array, or setting the <code>PATH_INFO</code> server variable as a variable early in the script) depending on your needs.  You can modify the HTML that displays the breadcrumb in the include file so it matches your site styles as well.</p></p>