---
layout: post
permalink: node/28652
---
<p>In a similar vein to <a href="http://www.evolt.org/user/jesteruk/19107/index.html">Jesteruk's</a> <a href="http://www.evolt.org/article/Creating_a_Login_Script_with_PHP_4/17/19661/index.html" title="PHP Login Script part 1" target="_blank">login with</a> <a href="http://www.evolt.org/article/Creating_a_login_script_with_PHP_4_part_II/17/27093/index.html" title="PHP Login Script part 2" target="_blank">PHP articles</a>, this article will show you how to do the same thing but with ASP.</p></p><p><h2>So, how do you start?</h2></p><p><p>The first thing you need to do is create a simple login page, which can look something like this:<br>\nNote: This will create JUST a form with text boxes. You can pad it out yourself.</p></p><p><h3>Creating the login.asp page</h3>\n<pre>\n&lt;&#37; Sub ShowLogin &#37;&gt;\n&lt;form name=form1 action=login.asp method=post&gt;\nUser Name : &lt;input type=text name=username&gt;\nPassword : &lt;input type=password name=userpwd&gt;\n&lt;input type=hidden name=login value=true&gt;\n&lt;input type=submit value=&quot;Login&quot;&gt;\n&lt;/form&gt;\n&lt;&#37; End Sub &#37;&gt;\n</pre></p><p><p>The second input box has a type=password, what this does is cause the text typed in to be hidden (like *******). Also to note is that you want the action of the form to be the same page. This way we do not need a second page just to handle the checking of the password. I will talk about the hidden form element next. You will also see why we placed the form inside a subroutine later.</p></p><p><p>Before we add the code to check to see if the user name and password are correct we need to add some code to the top of login.asp to check to see if the form has been submitted.</p></p><p><pre>\nResponse.Expires = -1000 'Makes the browser not cache this page\nResponse.Buffer = True 'Buffers the content so our Response.Redirect will work\nSession(&quot;UserLoggedIn&quot;) = &quot;&quot;</p><p>If Request.Form(&quot;login&quot;) = &quot;true&quot; Then \n    CheckLogin \nElse\n    ShowLogin \nEnd If \n</pre></p><p><p>This code will go at the top of login.asp to see if the form was submitted. If it was, then we will check the login, if not then we will show the login form.</p></p><p><h3>Checking for correct login details</h3>\n<p>Next we will add the code for the CheckLogin subroutine to check to see if the username and password entered are correct. At this time there is no database connectivity, as there is only one user.</p></p><p><pre>\nSub CheckLogin\nIf LCase(Request.Form(&quot;username&quot;)) = &quot;guest&quot; And LCase(Request.Form(&quot;userpwd&quot;)) = &quot;guest&quot; Then \n    Session(&quot;UserLoggedIn&quot;) = &quot;true&quot;\n    Response.Redirect &quot;protectedpage.asp&quot;\nElse\n    Response.Write(&quot;Login Failed.&lt;br&gt;&lt;br&gt;&quot;)\n    ShowLogin\nEnd If\nEnd Sub\n</pre></p><p><p>The above code will check to make sure they have entered the login correctly. By setting the Session variable "UserLoggedIn" equal to "" we are basically logging the user out.</p></p><p><h3>The protected pages</h3>\n<p>The only thing left to do is write the code to put at the top of the protected page to check to see if the user is logged in. This will redirect the user to the login page if UserLogginIn is not set. </p></p><p><pre>\nResponse.Expires = -1000 'Makes the browser not cache this page\nResponse.Buffer = True 'Buffers the content so our Response.Redirect will work</p><p>If Session(&quot;UserLoggedIn&quot;) <> &quot;true&quot; Then \n    Response.Redirect(&quotlogin.asp&quot;) \nEnd If \n</pre></p><p>\n<h2>The Scripts in full</h2></p><p><h3>login.asp</h3></p><p><pre>\n&lt;&#37;\nResponse.Expires = -1000 'Makes the browser not cache this page\nResponse.Buffer = True 'Buffers the content so our Response.Redirect will work\nSession(&quot;UserLoggedIn&quot;) = &quot;&quot;\nIf Request.Form(&quot;login&quot;) = &quot;true&quot; Then\n    CheckLogin\nElse\n    ShowLogin\nEnd If</p><p>Sub ShowLogin\n&#37;&gt;</p><p>&lt;form name=form1 action=login.asp method=post&gt;\nUser Name : &lt;input type=text name=username&gt;&lt;br&gt;\nPassword : &lt;input type=password name=userpwd&gt;&lt;br&gt;\n&lt;input type=hidden name=login value=true&gt;\n&lt;input type=submit value=&quot;Login&quot;&gt;\n&lt;/form&gt;\n&gt;&#37;\nEnd Sub</p><p>Sub CheckLogin\nIf LCase(Request.Form(&quot;username&quot;)) = &quot;guest&quot; And LCase(Request.Form(&quot;userpwd&quot;)) = &quot;guest&quot; Then\n    Session(&quot;UserLoggedIn&quot) = &quot;true&quot;\n    Response.Redirect &quot;protectedpage.asp&quot;\nElse\n    Response.Write(&quot;Login Failed.&lt;br&gt;&lt;br&gt;&quot;)\n    ShowLogin\nEnd If\nEnd Sub\n&#37;&gt;\n</pre></p><p><h3>protectedpage.asp</h3></p><p><pre>\n&lt;&#37;\nResponse.Expires = -1000 'Makes the browser not cache this page\nResponse.Buffer = True 'Buffers the content so our Response.Redirect will work</p><p>If Session(&quot;UserLoggedIn&quot;) <> &quot;true&quot; Then\n    Response.Redirect(&quot;login.asp&quot;)\nEnd If\n&#37;&gt;</p><p>This page is full of password protected content.  If you are reading this you entered &lt;br&gt;\nthe correct name and password.</p><p></pre>