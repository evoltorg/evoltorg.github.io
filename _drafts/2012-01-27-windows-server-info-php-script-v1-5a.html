---
layout: post
permalink: node/63616
ratings: 0
avgrate: 
category: Code
user: Melinda_endv
real_name: "Melinda"
user_since: 27 Jan 2012
avatar: "/images/pictures/picture-98098.jpg"
article_count: 1
excerpt: "Working PHP system Info script for Windows Servers!"
---
This script consists of three files: style.css, wmi_classes.php, and sysinfo.php.<br></p>You can run it all together but its best to seperate them up.<br></p>This is a more in detail example of how to usw Microsofts WMI system on a webserver to fetch hardware info.<br></p>Icons used in this script are from the silk icon packages. Icon sizes are 16 X 16 and in png format.<br></p><p>Style.css</p><p><code></p>html{background:#000000;}</p>body{color:#F0FFFF;}</p>tr.spacer{margin:20px 0;width:600px;}</p>.tbl1{width:600px;}</p>/*Tabe content allignment*/</p>.query{</p>  width:290px;</p>  padding-right:5px;</p>  padding-left:5px;</p>  text-align:left;</p>  font-weight:normal;</p>  color:#228B22;</p>}</p>.result{</p>  width:300px;</p>  text-align:left;</p>  font-weight:bold;</p>  color:#7FFF00;</p>  padding-left:5px;</p>  padding-right:5px;</p>}</p>th.header{</p>  width:600px;</p>  padding-top:2px;</p>  padding-bottom:2px;</p>  color:#1E90FF;</p>  border-top:1px solid #444444;</p>  border-bottom:1px solid #444444;</p>}</p>.lighten{</p>  color:#00FFFF;</p>}</p>/*These are status message notifications; IE: <span class="alert">This is an Alert.</span>.</p>That spam setup will produce an orangish message bar with a 16X16 error icon to the left of the message text.</p>The icons are from silk icons pack mostly, others were found on other sites.*/</p><p>span.ok,span.alert,span.warn,span.help,</p>span.starting,span.stopping,span.attention,</p>span.removabledisk,span.logicaldisk,span.netdisk,</p>span.cddvd,span.ramdisk {display:block;margin:0;padding-left:35px;width:300px;}</p>span.ok {background:url('images/status/accept.png') 5px 50% no-repeat;</p>background-color: #006400;</p>background-color: rgba(0,100,0,0.25);</p>border-top: 1px dotted #00ff00;</p>border-bottom: 1px dotted #00ff00;</p>color:#7FFF00;</p>}</p>span.alert {background:url('images/status/error.png') 5px 50% no-repeat;</p>background-color: #FF8C00;</p>background-color: rgba(255,140,0,0.25);</p>border-top: 1px dotted #FFA500;</p>border-bottom: 1px dotted #FFA500;</p>color:#FFD700;</p>}</p>span.warn {background:url('images/status/warn.png') 5px 50% no-repeat;</p>background-color: #8B0000;</p>background-color: rgba(139,0,0,0.25);</p>border-top: 1px dotted #ff0000;</p>border-bottom: 1px dotted #ff0000;</p>color:#FF0000;</p>}</p>span.help {background:url('images/status/help.png') 5px 50% no-repeat;</p>background-color: #4169E1;</p>background-color: rgba(65,105,225,0.25);</p>border-top: 1px dotted #87CEEB;</p>border-bottom: 1px dotted #87CEEB;</p>color:#B0E0E6;</p>}</p>span.starting {background:url('images/status/starting.png') 5px 50% no-repeat;</p>background-color: #DAA520;</p>background-color: rgba(218,165,32,0.25);</p>border-top: 1px dotted #FFD700;</p>border-bottom: 1px dotted #FFD700;</p>color:#000000;</p>}</p>span.stopping {background:url('images/status/stopping.png') 5px 50% no-repeat;</p>background-color: #DAA520;</p>background-color: rgba(218,165,32,0.25);</p>border-top: 1px dotted #FFD700;</p>border-bottom: 1px dotted #FFD700;</p>color:#000000;</p>}</p>span.attention {background:url('images/status/exclamation.png') 5px 50% no-repeat;</p>background-color: #8B0000;</p>background-color: rgba(139,0,0,0.25);</p>border-top: 1px dotted #ff0000;</p>border-bottom: 1px dotted #ff0000;</p>color:#FF0000;</p>}</p>span.removabledisk {background:url('images/status/drive_disk.png') 5px 50% no-repeat;</p>background-color: #585858;</p>background-color: rgba(88,88,88,0.25);</p>border-top: 1px dotted #555555;</p>border-bottom: 1px dotted #555555;</p>color:#FFFFFF;</p>}</p>span.logicaldisk {background:url('images/status/drive.png') 5px 50% no-repeat;</p>background-color: #585858;</p>background-color: rgba(88,88,88,0.25);</p>border-top: 1px dotted #555555;</p>border-bottom: 1px dotted #555555;</p>color:#FFFFFF;</p>}</p>span.netdisk {background:url('images/status/drive_web.png') 5px 50% no-repeat;</p>background-color: #585858;</p>background-color: rgba(88,88,88,0.25);</p>border-top: 1px dotted #555555;</p>border-bottom: 1px dotted #555555;</p>color:#FFFFFF;</p>}</p>span.cddvd {background:url('images/status/drive_cd.png') 5px 50% no-repeat;</p>background-color: #585858;</p>background-color: rgba(88,88,88,0.25);</p>border-top: 1px dotted #555555;</p>border-bottom: 1px dotted #555555;</p>color:#FFFFFF;</p>}</p>span.ramdisk {background:url('images/status/drive_burn.png') 5px 50% no-repeat;</p>background-color: #585858;</p>background-color: rgba(88,88,88,0.25);</p>border-top: 1px dotted #555555;</p>border-bottom: 1px dotted #555555;</p>color:#FFFFFF;</p>}</p></code></p><p>wmi_classes.php</p><p><code></p><!--This is PHP5 script, you may need to adjust some parts of this section to match properly with your server. Refer to Microsoft.com and look up WMI classes to get info on a specific class and so forth.--></p><?php</p>//Execute the WMI commands and assign to objects</p>    $obj = new COM ( 'winmgmts://localhost/root/CIMV2' );</p>    $wmi_computersystem =   $obj->ExecQuery("Select * from Win32_ComputerSystem");</p>    $wmi_bios           =   $obj->ExecQuery("Select * from Win32_BIOS");</p>    $wmi_mobo           =   $obj->ExecQuery("Select * from Win32_BaseBoard");</p>    $wmi_opsys          =   $obj->ExecQuery("Select * from Win32_OperatingSystem");</p>    $wmi_cpu            =   $obj->ExecQuery("Select * from Win32_Processor");</p>    $wmi_net            =   $obj->ExecQuery("Select * from Win32_NetworkAdapter");</p>    $wmi_physical_mem_a0  =   $obj->ExecQuery("Select * from Win32_PhysicalMemory WHERE BankLabel='CHAN A DIMM 0'");</p>    $wmi_physical_mem_a1  =   $obj->ExecQuery("Select * from Win32_PhysicalMemory WHERE BankLabel='CHAN A DIMM 1'");</p>    $wmi_physical_mem_b0  =   $obj->ExecQuery("Select * from Win32_PhysicalMemory WHERE BankLabel='CHAN B DIMM 0'");</p>    $wmi_physical_mem_b1  =   $obj->ExecQuery("Select * from Win32_PhysicalMemory WHERE BankLabel='CHAN B DIMM 1'");</p>    $wmi_disk_drive     =   $obj->ExecQuery("SELECT * FROM Win32_LogicalDisk WHERE DeviceID='C:'");</p>//WMI Call for general system info</p>    foreach ( $wmi_computersystem as $wmi_call )</p>    {</p>        $comp_cap = $wmi_call->Caption;</p>        $comp_model = $wmi_call->Model;</p>        $comp_make = $wmi_call->Manufacturer;</p>        $comp_status = $wmi_call->Status;</p>        $comp_cpu_cnt = $wmi_call->NumberOfProcessors;</p>        $comp_tot_pmem = $wmi_call->TotalPhysicalMemory;</p>    }</p>//WMI Call for Bios info</p>    foreach ( $wmi_bios as $wmi_call )</p>    {</p>        $bios_name = $wmi_call->Name;</p>        $bios_version = $wmi_call->SMBIOSBIOSVersion;</p>        $bios_make = $wmi_call->Manufacturer;</p>        $bios_status = $wmi_call->Status;</p>    }</p>//WMI Call for motherboard info info</p>    foreach ( $wmi_mobo as $wmi_call )</p>    {</p>        $mobo_name = $wmi_call->Name;</p>        $mobo_make = $wmi_call->Manufacturer;</p>        $mobo_model = $wmi_call->Model;</p>        $mobo_serial = $wmi_call->SerialNumber ;</p>        $mobo_pwr = $wmi_call->PoweredOn;</p>        $mobo_version = $wmi_call->Version;</p>        $mobo_status = $wmi_call->Status;</p>    }</p>//WMI Call for Operating System info</p>    foreach ( $wmi_opsys as $wmi_call )</p>    {</p>        $opsys_caption = $wmi_call->Caption;</p>        $opsys_serv_pak  = $wmi_call->CSDVersion;</p>        $opsys_status  = $wmi_call->Status;</p>        $opsys_free_pmem  = $wmi_call->FreePhysicalMemory;</p>        $opsys_free_pfiles  = $wmi_call->FreeSpaceInPagingFiles;</p>        $opsys_free_vmem  = $wmi_call->FreeVirtualMemory;</p>        $opsys_lastboot  = $wmi_call->LastBootUpTime;</p>        $opsys_psuite  = $wmi_call->OSProductSuite;</p>        $opsys_type  = $wmi_call->OSType;</p>        $opsys_version  = $wmi_call->Version;</p>    }</p>//WMI Call for network adapter info</p>    foreach ( $wmi_net as $wmi_call )</p>    {</p>        $net_name = $wmi_call->Description;</p>        $net_state = $wmi_call->Manufacturer;</p>        $net_type = $wmi_call->AdapterType;</p>        $net_prod = $wmi_call->Speed;</p>        $net_address = $wmi_call->NetConnectionID;</p>    }</p>//WMI Call for system memory info Current banks are: mem_a0, mem_a1, mem_b0, and mem_b1</p><p>    foreach ( $wmi_physical_mem_a0 as $wmi_call )</p>    {</p>        $phymem_a0_name      = $wmi_call->Caption;</p>        $phymem_a0_capy     = $wmi_call->Capacity;</p>        $phymem_a0_speed    = $wmi_call->Speed;</p>        $phymem_a0_status    = $wmi_call->Status;</p>    }</p>    foreach ( $wmi_physical_mem_a1 as $wmi_call )</p>    {</p>        $phymem_a1_name      = $wmi_call->Caption;</p>        $phymem_a1_capy     = $wmi_call->Capacity;</p>        $phymem_a1_speed    = $wmi_call->Speed;</p>        $phymem_a1_status    = $wmi_call->Status;</p>    }</p>    foreach ( $wmi_physical_mem_b0 as $wmi_call )</p>    {</p>        $phymem_b0_name      = $wmi_call->Caption;</p>        $phymem_b0_capy     = $wmi_call->Capacity;</p>        $phymem_b0_speed    = $wmi_call->Speed;</p>        $phymem_b0_status    = $wmi_call->Status;</p>    }</p>//WMI Call for memory in bank B1 info</p>    foreach ( $wmi_physical_mem_b1 as $wmi_call )</p>    {</p>        $phymem_b1_name      = $wmi_call->Caption;</p>        $phymem_b1_capy     = $wmi_call->Capacity;</p>        $phymem_b1_speed    = $wmi_call->Speed;</p>        $phymem_b1_status    = $wmi_call->Status;</p>    }</p>//WMI Call for disk info</p>    foreach ( $wmi_disk_drive as $wmi_call )</p>    {</p>        $disk_drive_desc = $wmi_call->Description;</p>        $disk_drive_type = $wmi_call->DriveType;</p>        $disk_drive_free = $wmi_call->FreeSpace;</p>        $disk_drive_size = $wmi_call->Size;</p>    }</p>//WMI Call for processor info</p>    foreach ( $wmi_cpu as $wmi_call )</p>    {</p>        $cpu_cap = $wmi_call->Caption;</p>        $cpu_cur_clk  = $wmi_call->CurrentClockSpeed;</p>        $cpu_max_clk  = $wmi_call->MaxClockSpeed;</p>        $cpu_name  = $wmi_call->Name;</p>        $cpu_make  = $wmi_call->Manufacturer;</p>        $cpu_core_cnt  = $wmi_call->NumberOfCores;</p>        $cpu_lcpu_cnt  = $wmi_call->NumberOfLogicalProcessors;</p>        $cpu_id  = $wmi_call->ProcessorId;</p>        $cpu_type  = $wmi_call->ProcessorType;</p>        $cpu_revision  = $wmi_call->Revision;</p>        $cpu_skt_des  = $wmi_call->SocketDesignation;</p>        $cpu_status  = $wmi_call->Status;</p>        $cpu_version  = $wmi_call->Version;</p>        $cpu_volt_cap  = $wmi_call->VoltageCaps;</p>//Some string replacement and modifications</p>$cpus_pattern = array();</p>$cpus_pattern[0] = '/OK/';</p>$cpus_pattern[1] = '/Error/';</p>$cpus_pattern[2] = '/Degraded/';</p>$cpus_pattern[3] = '/Unknown/';</p>$cpus_pattern[4] = '/Pred Fail/';</p>$cpus_pattern[5] = '/Starting/';</p>$cpus_pattern[6] = '/Stopping/';</p>$cpus_pattern[7] = '/Service/';</p>$cpus_pattern[8] = '/Stressed/';</p>$cpus_pattern[9] = '/Non Recover/';</p>$cpus_pattern[10] = '/No Contact/';</p>$cpus_pattern[11] = '/Lost Comm/';</p>$cpus_replace = array();</p>$cpus_replace[0] = '<span class="ok">OK</span>';</p>$cpus_replace[1] = '<span class="warn">Error Detected</span>';</p>$cpus_replace[2] = '<span class="alert">Degraded</span>';</p>$cpus_replace[3] = '<span class="help">Unknown</span>';</p>$cpus_replace[4] = '<span class="warn">Pred Fail</span>';</p>$cpus_replace[5] = '<span class="starting">Starting</span>';</p>$cpus_replace[6] = '<span class="stopping">Stopping</span>';</p>$cpus_replace[7] = '<span class="alert">Service</span>';</p>$cpus_replace[8] = '<span class="alert">Stressed</span>';</p>$cpus_replace[9] = '<span class="warn">Non Recover</span>';</p>$cpus_replace[10] = '<span class="attention">No Contact</span>';</p>$cpus_replace[11] = '<span class="attention">Lost Comm</span>';</p>}</p>$type_pattern = array();</p>$type_pattern[0] = '/1/';</p>$type_pattern[1] = '/2/';</p>$type_pattern[2] = '/3/';</p>$type_pattern[3] = '/4/';</p>$type_pattern[4] = '/5/';</p>$type_pattern[5] = '/6/';</p>$type_replace = array();</p>$type_replace[0] = '<span class="alert">Other</span>';</p>$type_replace[1] = '<span class="help">Unknown</span>';</p>$type_replace[2] = '<span class="ok">Central Processor</span>';</p>$type_replace[3] = '<span class="ok">Math Processor</span>';</p>$type_replace[4] = '<span class="ok">DSP Processor</span>';</p>$type_replace[5] = '<span class="ok">Video Processor</span>';</p><p>$dtype_pattern = array();</p>$dtype_pattern[0] = '/0/';</p>$dtype_pattern[1] = '/1/';</p>$dtype_pattern[2] = '/2/';</p>$dtype_pattern[3] = '/3/';</p>$dtype_pattern[4] = '/4/';</p>$dtype_pattern[5] = '/5/';</p>$dtype_pattern[6] = '/6/';</p>$dtype_replace = array();</p>$dtype_replace[0] = '<span class="help">Unknown</span>';</p>$dtype_replace[1] = '<span class="alert">No Root Directory</span>';</p>$dtype_replace[2] = '<span class="removabledisk">Removable Disk</span>';</p>$dtype_replace[3] = '<span class="logicaldisk">Logical Fixed Disk</span>';</p>$dtype_replace[4] = '<span class="netdisk">Network Drive</span>';</p>$dtype_replace[5] = '<span class="cddvd">CD/DVD Disk</span>';</p>$dtype_replace[6] = '<span class="ramdisk">RAM Disk</span>';</p>$pwr_pattern = array();</p>$pwr_pattern[0] = '/0/';</p>$pwr_pattern[1] = '/1/';</p>$pwr_replace = array();</p>$pwr_replace[0] = '<span class="attention">Powered Off</span>';</p>$pwr_replace[1] = '<span class="ok">Powered On</span>';</p><p>//Format data sizes and add proper tags</p>function formatSize( $bytes ){</p>        $types = array( 'B', 'Kb', 'Mb', 'Gb', 'Tb', 'Pb' );</p>        for( $i = 0; $bytes >= 1024 && $i < ( count( $types ) -1 ); $bytes /= 1024, $i++ );</p>                return( round( $bytes, 2 ) . " " . $types[$i] );</p>}</p>?></p><p><?php</p>//Decimal point</p>function human_readable( $size )</p>{</p>   $count = 0;</p>   $format = array("MHz","GHz");</p>   while(($size/1000)>1 && $count<2)</p>   {</p>       $size=$size/1000;</p>       $count++;</p>   }</p>   if( $size < 10 ) $decimals = 2;</p>   else $decimals = 0;</p>   $return = number_format($size,$decimals,'.',' ')." ".$format[$count];</p>   return $return;</p>}</p>?></p></code></p><p>sysinfo.php</p><p><code></p><p><?php</p>include("wmi_classes.php");</p>?></p><!DOCTYPE html></p><html></p><head></p><title>System Information   Windows Server 2003 - SP2</title></p></head></p><body></p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">General Info</th></tr></p><tr><td class="query">Bios Name:</td><td class="result"><?php echo ($bios_name);?></td></tr></p><tr><td class="query">Bios Version:</td><td class="result"><?php echo ($bios_version);?></td></tr></p><tr><td class="query">Bios Manufacturer:</td><td class="result"><?php echo ($bios_make);?></td></tr></p><tr><td class="query">System Name:</td><td class="result"><?php echo ($comp_cap);?></td></tr></p><tr><td class="query">System Manufacturer:</td><td class="result"><?php echo ($mobo_make);?></td></tr></p><tr><td class="query">System Model Number:</td><td class="result"><?php echo ($comp_model);?></td></tr></p><tr><td class="query">System Serial Number:</td><td class="result"><?php echo ($mobo_serial);?></td></tr></p><tr><td class="query">Service Version:</td><td class="result"><?php echo ($mobo_version);?></td></tr></p><tr><td class="query">System Power State:</td><td class="result"><?php echo preg_replace($pwr_pattern, $pwr_replace, $mobo_pwr);?></td></tr></p><tr><td class="query">Operating System Last Boot:</td><td class="result"><?php echo date("D, M-j-Y @ G:i:s T", time($opsys_lastboot));?></td></tr></p></table></p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">Operating System Info</th></tr></p><tr><td class="query">Operating System:</td><td class="result"><?php echo "<img src=images/status/win1.png height=16 width=16 valign=center>&nbsp;" .($opsys_caption);?></td></tr></p><tr><td class="query">Service Pack Update:</td><td class="result"><?php echo ($opsys_serv_pak);?></td></tr></p><tr><td class="query">Operating System Version:</td><td class="result"><?php echo ($opsys_version);?></td></tr></p></table></p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">Disk Drive Info</th></tr></p><tr><td class="query">Drive Label:</td><td class="result"><?php echo ($disk_drive_desc);?></td></tr></p><tr><td class="query">Drive Type:</td><td class="result"><?php echo preg_replace($dtype_pattern, $dtype_replace, $disk_drive_type);?></td></tr></p><tr><td class="query">Drive Free Space:</td><td class="result"><?php echo formatSize($disk_drive_free);?></td></tr></p><tr><td class="query">Drive Size:</td><td class="result"><?php echo formatSize($disk_drive_size);?></td></tr></p></table></p><p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">Network Info</th></tr></p><tr><td class="query">Connection Name:</td><td class="result"><?php echo ($net_name);?></td></tr></p><tr><td class="query">Connection State:</td><td class="result"><?php echo ($net_state);?></td></tr></p><tr><td class="query">Connection Type:</td><td class="result"><?php echo ($net_type);?></td></tr></p><tr><td class="query">Connection Speed:</td><td class="result"><?php echo formatSize($net_prod);?></td></tr></p><tr><td class="query">Connection Address:</td><td class="result"><?php echo ($net_address);?></td></tr></p></table></p><p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">Processor Info</th></tr></p><tr><td class="query">Processor Name:</td><td class="result"><?php echo ($cpu_name);?></td></tr></p><tr><td class="query">Processor Current Clock:</td><td class="result"><?php echo human_readable($cpu_cur_clk);?></td></tr></p><tr><td class="query">Processor Max Clock:</td><td class="result"><?php echo human_readable($cpu_max_clk);?></td></tr></p><tr><td class="query">Processors Installed:</td><td class="result"><?php echo ($cpu_lcpu_cnt);?></td></tr></p><tr><td class="query">Cores per Processor:</td><td class="result"><?php echo ($cpu_core_cnt);?></td></tr></p><tr><td class="query">Processor Type:</td><td class="result"><?php echo preg_replace($type_pattern, $type_replace, $cpu_type);?></td></tr></p></table></p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">System Memory Info Bank A</th></tr></p><tr><td class="query">Memory Bank <b class="lighten">A Slot 0</b> Name:</td><td class="result"><?php echo ($phymem_a0_name);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">A Slot 0</b> Size:</td><td class="result"><?php echo formatSize($phymem_a0_capy);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">A Slot 0</b> Speed:</td><td class="result"><?php echo human_readable($phymem_a0_speed);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">A Slot 1</b> Name:</td><td class="result"><?php echo ($phymem_a1_name);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">A Slot 1</b> Size:</td><td class="result"><?php echo formatSize($phymem_a1_capy);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">A Slot 1</b> Speed:</td><td class="result"><?php echo human_readable($phymem_a1_speed);?></td></tr></p></table></p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">System Memory Info Bank B</th></tr></p><tr><td class="query">Memory Bank <b class="lighten">B Slot 0</b> Name:</td><td class="result"><?php echo ($phymem_b0_name);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">B Slot 0</b> Size:</td><td class="result"><?php echo formatSize($phymem_b0_capy);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">B Slot 0</b> Speed:</td><td class="result"><?php echo human_readable($phymem_b0_speed);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">B Slot 1</b> Name:</td><td class="result"><?php echo ($phymem_b1_name);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">B Slot 1</b> Size:</td><td class="result"><?php echo formatSize($phymem_b1_capy);?></td></tr></p><tr><td class="query">Memory Bank <b class="lighten">B Slot 1</b> Speed:</td><td class="result"><?php echo human_readable($phymem_b1_speed);?></td></tr></p></table></p><table class="tbl1" cellpadding="0"></p><tr class="spacer"><th class="header" colspan="2">System Health Status</th></tr></p><tr><td class="query">System Overall Status:</td><td class="result"><?php echo preg_replace($cpus_pattern, $cpus_replace, $comp_status);?></td></tr></p><tr><td class="query">System Bios Status:</td><td class="result"><?php echo preg_replace($cpus_pattern, $cpus_replace, $bios_status);?></td></tr></p><tr><td class="query">Motherboard Status:</td><td class="result"><?php echo preg_replace($cpus_pattern, $cpus_replace, $mobo_status);?></td></tr></p><tr><td class="query">Operating System Status:</td><td class="result"><?php echo preg_replace($cpus_pattern, $cpus_replace, $opsys_status);?></td></tr></p><tr><td class="query">System Processor Status:</td><td class="result"><?php echo preg_replace($cpus_pattern, $cpus_replace, $cpu_status);?></td></tr></p></table></p><!--I do not mind sharing but, Please leave the copyright tag in place.--></p><center></p><small>&copy Copyright 2010 - 2012 <a herf="http://www.elfnetdesigns.com">Elfnet Designs.</a><br/></p>WMI, Windows amd Microsoft are registered trademarks of <a href="http://www.mocrosoft.com">Microsoft Inc.</a><br/></p>Dell Poweredge is Copright 2012 <a href="http://www.dell.com">Dell Computer Co.</a></p></small></p><p></center></p></body></p></html></p><p></code></p><p>ElfNet Designs - http://www.elfnetdesigns.com