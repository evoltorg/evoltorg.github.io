<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Forms Javascript Living Together In Harmony</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Forms Javascript Living Together In Harmony</h2>
<p class="meta">02 Jun 2002</p>

<div class="post">
<script language="JavaScript" type="text/javascript">\n<!--\n  var openWin = null;\n    \n  function openWindow(title, href, target, width, height)\n  {\n    if(!window.open)\n      return true;\n    var openWinHTML = '<html><head><title>' + title + '</title></head><body marginheight="0" marginwidth="0" style="margin: 0px"><a href="JavaScript://" onclick="self.close(); return false"><img src="' + href + '" height="' + height + '" width="' + width + '" border="0" galleryimg="no" alt="' + title + ' (Click to close)"></a></body></html>';\n    var features = 'width=' + width + ',height=' + height;\n    if(openWin && !open.closed)\n      openWin.close();\n    openWin = window.open('', target, features);\n    openWin.document.open();\n    openWin.document.write(openWinHTML);\n    openWin.document.close();\n    if(openWin.focus)\n      openWin.focus();\n    return false;\n  }\n//-->\n</script></p><p><p>Most developers don't surf the web with JavaScript turned off on purpose (with the obvious exception of the <a href="/user/aardvark/88/index.html">aardvark</a>) so they probably aren't aware of the devastating effects caused by the irresponsible use of JavaScript when working with forms.  Fortunately, there are rarely instances where this lack of respect for the non-JavaScript users is necessary.  By exposing you to some of the common examples of forms that are hostile to non-JavaScript users and the ways these same forms can be implemented to be friendly to non-JavaScript users, I'm hoping you'll see the wisdom in carefully planning your use of JavaScript with forms.</p></p><p><h2>What are some examples of irresponsible use of JavaScript with forms?</h2></p><p><h3>Look Ma! No submit button!</h3></p><p><p>The first and most common is the use of a dropdown menu as navigation (See <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#figure1">Figure 1</a> below).  Aside from the obvious usability and accessibility concerns inherent in this design faux pas, some developers unnknowingly render the navigation useless to non-JavaScript users by omitting a submit button.  Often the argument for not including the submit button is that it uglies the design.  I'd argue that the dropdown menu isn't much prettier, even with lots of css styling applied to it.  However, most designers and some developers are vain and would rather sacrifice usability for the sake of &quot;the look&quot;.  So, non-JavaScript users suffer.</p></p><p><p class="side" style="padding-right: 5px;"><a href="images/15/forms_and_javascript/figure_1.jpg" target="_blank" onclick="return openWindow('Dropdown Navigation Nightmare &#8212; Chevrolet.com', this.href, this.target, 750, 450)"><img src="images/15/forms_and_javascript/figure_1_thumb.jpg" height="150" width="250" border="0" align="left" style="margin: 5px; border: 1px solid #000000" alt="Figure 1 &#8212; Example of using dropdown menus for navigation with reckless abandon at Chevrolet.com.  (click to see a larger version)"></a><a name="figure1" id="figure1"><strong>Figure 1:</strong></a> An example of a site that uses dropdown menus as navigation, with no apparent means for non-JavaScript users to get to the same content.  You might be thinking the blue square in the top-right of the figure is a submit button.  Don't let it fool ya.  Just because it's sitting next to a dropdown menu doesn't mean it has anything to do with it.  It's actually a link.  <a href="http://chevrolet.com/" target="_blank" title="Visit Chevrolet.com (link opens in a new window)">See what I mean</a>.<br clear="all"></p></p><p><h3>&lt;lisp&gt;The submit buttons <em>must</em> be purple and do that faaaabulous image swapping thingy like the navigation!&lt;/lisp&gt;</h3></p><p><p>The second is the gratuitous abuse of branding &#8212; colors and rollovers spilling over in to submit buttons (and all too often the form elements themselves, thanks to CSS).  As if graphical submit buttons aren't bad enough, some designers practically demand the graphical submit buttons rollover when the user mouses over them (<a href="/Forms_and_JavaScript_Living_Together_in_Harmony#figure2">Figure 2</a> below is a fine example of this).  Unfortunately, too many developers are stuck using <acronym title="What You Get Is What You Deserve (rudy.ca)">wygiwyd</acronym> software and/or are unaware of the possibilities available in the latest browsers that don't require neutering the form for non-JavaScript users in order to quell the unrelenting demands of the designer.  If they do seek help from other developers in finding a solution, the suggestion is almost always to wrap an image with a link that calls the <code>submit()</code> method.  Too bad that's not the solution.</p></p><p><p class="side" style="padding-left: 5px;"><a href="images/15/forms_and_javascript/figure_2.gif" target="_blank" onclick="return openWindow('Super Silly Submit Buttons &#8212; MBUSA.com', this.href, this.target, 750, 450)"><img src="images/15/forms_and_javascript/figure_2_thumb.gif" height="150" width="250" border="0" align="right" style="margin: 5px; border: 1px solid #000000" alt="Figure 2 &#8212; Example of castrating a form by forcing the user to have JavaScript enabled to submit it.  (click to see a larger version)"></a><a name="figure2" id="figure2"><strong>Figure 2:</strong></a> An example of a site that places design element behavior over usability and accessibility.  If I don't have JavaScript enabled, I can't submit the form by clicking on the &quot;Submit&quot; button.  In Mercedes-Benz USA's favor is that you can still submit the form by pressing the <code>ENTER</code> key on the keyboard when the cursor is in the Zip Code field. <a href="http://www.mbusa.com/brand/container.jsp?/locator/index.jsp" target="_blank" title="Visit MBUSA.com (link opens in a new window)">See what I mean</a>.<br clear="all"></p></p><p><h3>That's <em>not</em> how you validate a form?</h3></p><p><p>There are right ways to perform form validation with JavaScript and then there are wrong ones.  All too often, developers implement validation the wrong way.  For JavaScript enabled users, the result is the same.  However, done the wrong way, non-JavaScript users are left with a form that does absolutely nothing when they click the submit button.  If you read no further, take with you the knowledge that the only ways to properly perform form validation with JavaScript is to use the <code>onsubmit</code> event handler of the <code>&lt;form&gt;</code> tag or the <code>onclick</code> event handler of a non-graphical submit button to call a function that returns a boolean of <code>true</code> or <code>false</code>.</p></p><p><h2>So what's the solution?</h2></p><p><p>The most obvious solution is to not use JavaScript at all.  However, that usually negatively impacts a user's experience by forcing a round-trip to the server just to get the form back with error messages indicating required fields they didn't enter data or pattern-matched fields with syntactically invalid data.    Besides, this article is about using JavaScript responsibly with forms &#8212; not about not using JavaScript at all.</p></p><p><h3>Taming the dropdown menu</h3></p><p><p>If you insist on going against evidence that using dropdowns as navigation is a bad idea, at least include a mechanism to make them usable by your non-JavaScript users.  If you're at least marginally conscious of usability issues, you'll resign yourself to not using the <code>onchange</code> event handler to change the page.  That means you'll likely have some other mechanism like a button or link that finds the user's selection and changes the page to the one they selected.  Making this work for non-JavaScript users will require only a small amount of work.  You'll need to change that link or button to a regular submit button.  You can even use a graphical submit button if you prefer.  Rather than calling the function from the submit button though, you'll need to move the call to the <code>onsubmit</code> event handler so this will work with the most browsers possible (Some browsers &lt;cough&gt;Netscape Navigator 4.x&lt;/cough&gt; don't support onclick event handlers on graphical submit buttons). You'll also need to reference a server-side script in the <code>action</code> attribute that the non-JavaScript users will submit the form to.  This server-side script will take the value they selected from the dropdown menu and perform a simple redirect.  See <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing1">Listing 1</a> for some example JavaScript illustrating this technique.  <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing2">Listing 2</a> contains some example ColdFusion code that could be used to facilitate that server-side portion of this solution.</p></p><p><h4>Listing 1 &#8212; The HTML &amp; JavaScript for the client-side processing<a name="listing1" id="listing1">&nbsp;</a></h4></p><p><pre>&lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot;&gt;\n&lt;!--\n  function navigateForm(obj)\n  {\n    if(obj.selectedIndex != -1 && obj.options[obj.selectedIndex].value)\n      top.location.href = obj.options[obj.selectedIndex].value;\n    return false;\n  }\n//--&gt;\n&lt;/script&gt;</p><p>&lt;form action=&quot;navigate.cfm&quot; method=&quot;post&quot; onsubmit=&quot;return navigateForm(this.form.navigateSelect)&quot;&gt;\n  &lt;select name=&quot;navigateSelect&quot; id=&quot;navigateSelect&quot; size=&quot;1&quot;&gt;\n    &lt;option value=&quot;&quot;&gt;Choose One&lt;/option&gt;\n    &lt;option value=&quot;/&quot;&gt;Home&lt;/option&gt;\n    &lt;option value=&quot;/products/&quot;&gt;Products&lt;/option&gt;\n    &lt;option value=&quot;/faq/&quot;&gt;FAQ&lt;/option&gt;\n    &lt;option value=&quot;/about_us/&quot;&gt;About Us&lt;/option&gt;\n    &lt;option value=&quot;/contact_us/&quot;&gt;Contact Us&lt;/option&gt;\n  &lt;/select&gt;\n  &lt;input type=&quot;submit&quot; value=&quot;Go&quot; /&gt;\n&lt;/form&gt;</pre></p><p><h4>Listing 2 &#8212; The ColdFusion for the server-side processing<a name="listing2" id="listing2">&nbsp;</a></h4></p><p><pre>&lt;cfparam name=&quot;form.navigateSelect&quot; default=&quot;/&quot;&gt;\n&lt;cflocation url=&quot;#form.navigateSelect#&quot; addtoken=&quot;No&quot;&gt;</pre></p><p><p>If you just can't live with the submit button being visible to your JavaScript enabled users, leave some room in the design for it and only show it to non-JavaScript users by wrapping it in a <code>&lt;noscript&gt;</code> tags.  See <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing3">Listing 3</a> below for an example of the HTML.</p></p><p><h4>Listing 3 &#8212; Hiding the Submit button from JavaScript-enabled users<a name="listing3" id="listing3">&nbsp;</a></h4></p><p><pre>&lt;form action=&quot;navigate.cfm&quot; method=&quot;post&quot; onsubmit=&quot;return navigateForm(this.form.navigateSelect)&quot;&gt;\n  &lt;select name=&quot;navigateSelect&quot; id=&quot;navigateSelect&quot; size=&quot;1&quot;&gt;\n    &lt;option value=&quot;&quot;&gt;Choose One&lt;/option&gt;\n    &lt;option value=&quot;/&quot;&gt;Home&lt;/option&gt;\n    &lt;option value=&quot;/products/&quot;&gt;Products&lt;/option&gt;\n    &lt;option value=&quot;/faq/&quot;&gt;FAQ&lt;/option&gt;\n    &lt;option value=&quot;/about_us/&quot;&gt;About Us&lt;/option&gt;\n    &lt;option value=&quot;/contact_us/&quot;&gt;Contact Us&lt;/option&gt;\n  &lt;/select&gt;\n  &lt;noscript&gt;\n  &lt;input type=&quot;submit&quot; value=&quot;Go&quot; /&gt;\n  &lt;/noscript&gt;\n&lt;/form&gt;</pre></p><p><p>[<strong>Note:</strong> The <code>&lt;noscript&gt;</code> tags were introduced with JavaScript1.1.  Therefore, any browser that doesn't support JavaScript1.1 will ignore the <code>&lt;noscript&gt;</code> tags and attempt to display anything contained within them.  As the only browser this really affects is Netscape Navigator 2.x, you're not likely to experience this problem.]</p></p><p><h3>Appeasing The Demanding Designer</h3></p><p><p>Provided you're willing and able to make this functionality available for only a portion of your audience, you can give the design what he or she wants without crippling the form for non-JavaScript users.  Don't let this notion of some visitors missing out on the foofoo eye-candy stop you from doing the right thing.  Though the numbers could vary for your own site, I'm probably talking about 5% or less of your audience not getting the rollover effect the designer is so proud of.  However, all of your users, despite their support for JavaScript, should be able to use the form.</p></p><p><p>Before we charge off into some example code showing how to accomplish this, let's take a look how it's usually accomplished in a manner that makes it unusable for non-JavaScript users.  <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing4">Listing 4</a> below contains HTML for a very small form.</p></p><p><h4>Listing 4 &#8212; Snazzy but an obstacle for some<a name="listing4" id="listing4">&nbsp;</a></h4></p><p><pre>&lt;form action=&quot;/login.cfm&quot; name=&quot;loginForm&quot; method=&quot;post&quot;&gt;\n&lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;&quot; /&gt;&lt;br /&gt;\n&lt;input type=&quot;password&quot; name=&quot;password&quot; value=&quot;&quot; /&gt;&lt;br /&gt;\n&lt;a href=&quot;JavaScript:document.loginForm.submit()&quot;\n    onmouseover=&quot;rollOver('loginButton', 'on')&quot;\n    onmouseout=&quot;rollOver('loginButton', 'off')&quot;\n&gt;&lt;img name=&quot;loginButton&quot;\n    src=&quot;images/login_off.gif&quot;\n    width=&quot;88&quot;\n    height=&quot;31&quot;\n    border=&quot;0&quot;\n    alt=&quot;Login&quot;\n/&gt;&lt;/a&gt;\n&lt;/form&gt;</pre></p><p><p>So how do we remedy this situation so it's usable by all visitors to our site?  Simple &#8212; remove the <code>&lt;a&gt;</code> tag and use an image submit button instead of a regular image.  We'll also move the <code>onmouseover</code> and <code>onmouseout</code> event handlers to the image submit.  Most (like 95+%) of the browsers that will be visiting your site will support these event handlers on the image submit.  Those that don't will simply get a normal, &quot;boring&quot; image submit button.  See <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing5">Listing 5</a> below to see what the code in <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing4">Listing 4</a> looks like after this conversion.</p></p><p><h4>Listing 5 &#8212; Snazzy and usable too<a name="listing5" id="listing5">&nbsp;</a></h4></p><p><pre>&lt;form action=&quot;/login.cfm&quot; name=&quot;loginForm&quot; method=&quot;post&quot;&gt;\n&lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;&quot; /&gt;&lt;br /&gt;\n&lt;input type=&quot;password&quot; name=&quot;password&quot; value=&quot;&quot; /&gt;&lt;br /&gt;\n&lt;input type=&quot;image&quot;\n    src=&quot;images/login_off.gif&quot;\n    width=&quot;88&quot;\n    height=&quot;31&quot;\n    border=&quot;0&quot;\n    alt=&quot;Login&quot;\n    onmouseover=&quot;rollOver('loginButton', 'on')&quot;\n    onmouseout=&quot;rollOver('loginButton', 'off')&quot;&gt;\n&lt;/form&gt;</pre></p><p><h3>&quot;Are you an idiot?  Tell me you didn't just put that there.&quot; or Validating Form Data</h3></p><p><p>The last one that's so often funked up by irresponsible JavaScripters is form validation.  The sad thing is that they mess it up not out of spite, but because they don't understand the right way to do it.  The wrong way to do it almost always involves the use of the <code>submit()</code> method.  So, what exactly is the right way?</p></p><p><p>The right way involves building the form and its functionality from start to finish without any JavaScript.  Complete all your server-side checking and processing.  Then, come back and add your client-side checking to improve the user's experience.  It's as simple as adding an <code>onsubmit</code> event handler to your <code>&lt;form&gt;</code> tag.  Since this event is cancellable, we preface our validation function call with a <code>return</code> statement.  The validation function will return a boolean value of true or false finishing off this <code>return</code> statement.  A <code>return true</code> statement  will result in the default behavior &#8212; the form submitting.  Conversely, a <code>return false</code> statement will result in the form submission being aborted.  See <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing6">Listing 6</a> below for an example of how the function in the  <code>onsubmit</code> event handler is called.</p></p><p><h4>Listing 6 &#8212; How to call your validation function with the <code>onsubmit</code> event handler<a name="listing6" id="listing6">&nbsp;</a></h4></p><p><pre>&lt;form\n action=&quot;/login.cfm&quot;\n name=&quot;loginForm&quot;\n method=&quot;post&quot;\n onsubmit=&quot;return validateForm(this)&quot;\n&gt;</pre></p><p>[<strong>Note:</strong> See my article on event handlers and cancelling events called &quot;<a href="/article/forms_and_javascript/17/20938/">JavaScript: The Point of No Return!?</a>&quot; for an overview of these concepts.]</p><p><p>Let's take a look at our form validation function &#8212; <code>validateForm()</code> &#8212 to see how it works.  Before we do though, it'd be a good idea to see the form we'll be working with.  For simplicity, we'll be validating a simple login form with <code>username</code> and <code>password</code> fields.  See <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing7">Listing 7</a> below for the HTML for this login form.</p></p><p><h4>Listing 7 &#8212; Our Login Form<a name="listing7" id="listing7">&nbsp;</a></h4></p><p><pre>&lt;form\n action=&quot;/login.cfm&quot;\n name=&quot;loginForm&quot;\n method=&quot;post&quot;\n onsubmit=&quot;return validateForm(this)&quot;\n&gt;\n  &lt;label for=&quot;username&quot;\n  &gt;&lt;u&gt;U&lt;/u&gt;sername&lt;/label&gt; \n  &lt;input type=&quot;text&quot;\n         name=&quot;username&quot;\n         id=&quot;username&quot;\n         tabindex=&quot;1&quot;\n         accesskey=&quot;u&quot;\n         value=&quot;&quot; /&gt;&lt;br /&gt;\n  &lt;label for=&quot;password&quot;\n  &gt;&lt;u&gt;P&lt;/u&gt;assword&lt;/label&gt;\n  &lt;input type=&quot;password&quot;\n         name=&quot;password&quot;\n         id=&quot;password&quot;\n         tabindex=&quot;2&quot;\n         accesskey=&quot;p&quot;\n         value=&quot;&quot; /&gt;&lt;br /&gt;\n  &lt;input type=&quot;submit&quot;\n         tabindex=&quot;3&quot;\n         accesskey=&quot;l&quot;\n         value=&quot;Login&quot; /&gt;\n&lt;/form&gt;</pre></p><p><p>When the user submits the form our <code>validateForm()</code> function is called (Follow along with the code in <a href="/Forms_and_JavaScript_Living_Together_in_Harmony#listing8">Listing 8</a> below).  The function creates a couple of variables local to the function that it'll use for storing the return value (<code>returnValue</code>), the concatenated error message (<code>errorMessage</code>), and which field needs to receive focus if the form doesn't validate (<code>focusField</code>).  Then the function checks the username and password fields for values.  If either field is blank, it adds some text to the <code>errorMessage</code> variable, sets the <code>focusField</code> variable to the current field if it hasn't been set yet, and changes the <code>returnValue</code> variable to false.  If both fields have values then <code>returnValue</code> keeps its initial value of true.  This boolean is then returned to the calling event handler by the <code>return</code> statement on the last line of our function.  The event handler uses this boolean value that comes back from the function in combination with the <code>return</code> statement just before the function call and allows submission if the boolean is true or halts submission if it is false.</p></p><p><h4>Listing 8 &#8212; <code>validateForm()</code><a name="listing8" id="listing8">&nbsp;</a></h4></p><p><pre>\n&lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot;&gt;\n&lt;!--\n  function validateForm(form)\n  {\n    var returnValue = true;\n    var errorMessage = 'The following field(s) are required and do not contain any information:</p><p>';\n    var focusField = null;\n    if(!form.username.value)\n    {\n      errorMessage += ' - Username\n';\n      if(!focusField)\n        focusField = form.username;\n      returnValue = false;\n    }\n    if(!form.password.value)\n    {\n      errorMessage += ' - Password\n';\n      if(!focusField)\n        focusField = form.password;\n      returnValue = false;\n    }\n    if(!returnValue)\n    {\n      alert(errorMessage);\n      if(focusField)\n        focusField.focus();\n    }\n    return returnValue;\n  }\n//--&gt;\n&lt;/script&gt;</pre></p><p><h2>In conclusion</h2></p><p><p>I've only covered the most common JavaScript mistakes made when working with forms.  There are lots more out in the wild that frustrate non-Javascript users to no end.  I hope this article has shown that it doesn't have to be this way and encouraged you to be the best developer you can be.  After all, forms and JavaScript really <em>can</em> live together in harmony.</p></p><p><p><a href="/user/jeff/15/index.html">.jeff</a></p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
