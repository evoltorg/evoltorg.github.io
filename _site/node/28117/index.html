<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Make Your Php Code Portable</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Make Your Php Code Portable</h2>
<p class="meta">25 May 2002</p>

<div class="post">
<p>There's a lot of PHP code available for free on the net but also not all of it\ncan run on your system as it is. This article shows you how  to distribute a setup required by your program to run.\n</p></p><p><h2>Why should I care</h2></p><p><p>People are different and they use different PHP configurations so if you want \nto run a script on your system you have two choices:\n</p></p><p><ul>\n	<li>set your global configuration to something that allows the code to run</li>\n	<li>set a configuration specific to the program</li>\n</ul></p><p><p>If you go for the first one you're in trouble if you try to run two programs which\nrequire completely different setups. So the only choice seems to be the second one.\n</p></p><p><h2>Well then how do I do this</h2></p><p><p>There are four different ways to set a PHP configuration option:\n</p></p><p><ul>\n	<li>through php.ini</li>\n	<li>through httpd.conf</li>\n	<li>through a .htaccess file</li>\n	<li>or directly in PHP code</li>\n</ul></p><p><p>The first and second ones are only available to the system administrator of a website \nso you generally have to avoid them. Yes you may have access to those files but think \nabout the other people that may be using the code - do they have access to those files?\nUsually not.\n</p></p><p><p>The third method &#8212; via a <code>.htaccess</code> file is available only on Apache (and maybe on the NCSA httpd, I'm not sure about that) but since Apache is the most\npopular webserver that is usually not a problem. The other thing that you should know \nabout <code>.htaccess</code> files is that they <em>may</em> be disabled by the \nwebmaster. If this is the case your only chance is to use a globally included PHP file \nwhich configures the system.\n</p></p><p><p>Setting the options with PHP code is the <em>most</em> portable way to configure\na system. The only problem is the accessible options are less than available to a \n<code>.htaccess</code> file.\n</p></p><p><h3>I'll go for a <code>.htaccess</code> file</h3></p><p><p>The syntax for setting an option is:\n</p></p><p><pre>\nphp_value name value\nphp_flag name on or off\n</pre></p><p><p>Example:</p></p><p><pre>\nphp_flag register_globals off\nphp_value arg_separator.output &amp;amp;\n</pre></p><p><p>The example turns off <code>register_globals</code> and sets the value of\n<code>arg_separator.output</code> to &amp;amp; which is preferred rather than the default\n&amp;.\n</p></p><p><p><strong>Note</strong>: you can also set boolean options with the <code>php_value</code>\ndirective, the string will be converted to boolean before assignment.\n</p></p><p><h3>I'll go for PHP code</h3></p><p><p>There's only one function for setting an option and it is <code>ini_set()</code> \nit is also aliased as <code>ini_alter()</code>.\nThere is also a function that restores the original value and it is <code>ini_restore()</code>.\n</p></p><p><p>How to use these:</p></p><p><pre>\nini_set('display_errors', false);\nini_set('arg_separator.input', ';');\n...\nini_restore('display_errors');\n</pre></p><p><p><strong>Note</strong>: in the first call to <code>ini_set()</code> you can also use\nany type of variable it will be converted to boolean before setting the option.\n</p></p><p><h2>Very nice but I don't know my configuration</h2></p><p><p>I've got something for you too. This is a script that will detect common settings \nthat may prevent your code from executing properly on a different system.\n</p></p><p>\n<pre>\n&lt;?php</p><p>	define('boolean', 1);\n	define('string', 2);\n	define('integer', 3);</p><p>	$php_ini_all = Array(\n		Array(string, 'arg_separator.input'),\n		Array(string, 'arg_separator.output'),\n		Array(boolean, 'display_errors'),\n		Array(boolean, 'display_startup_errors'),\n		Array(boolean, 'magic_quotes_runtime'),\n		Array(integer, 'error_reporting'),\n		Array(string, 'variables_order'),\n		Array(string, 'gpc_order')\n	);\n		\n	$php_ini_perdir = Array(\n		Array(boolean, 'asp_tags'),\n		Array(boolean, 'magic_quotes_gpc'),\n		Array(string, 'output_buffering'),\n		Array(boolean, 'register_globals'),\n		Array(boolean, 'short_open_tag')\n	);\n?&gt;</p><p>&lt;?php\n	function display_php_conf() {\n		foreach ( $GLOBALS['php_ini_all'] as $option ) {\n			$value = ini_get($option[1]);\n			echo "ini_set('$option[1]', '$value');\n";\n		}\n	}</p><p>	function display_htaccess_conf() {\n		global $php_ini_all, $php_ini_perdir;</p><p>		foreach ( array_merge($php_ini_all, $php_ini_perdir) as $option ) {\n			$value = ini_get($option[1]);\n			\n			if ( $option[0] == boolean ) {\n				$value = $value ? 'on' : 'off';\n				$directive = 'php_flag';\n			} else {\n				$directive = 'php_value';\n			}</p><p>			echo "$directive $option[1] $value\n";\n		}\n	}\n?&gt;\n</pre></p><p><p>First we define these common options in two arrays for the different access levels, \nthe first one for options available to both PHP code and <code>.htaccess</code> files, \nand the second only for <code>.htaccess</code> files. You <em>may</em> need to modify\nthat in case you use non-default settings for other options too.\n</p></p><p><p>The two function <code>display_php_conf()</code> and \n<code>display_htaccess_conf()</code> print the PHP code \nand <code>.htaccess</code> directives for your config respectively.\n</p></p><p><h2>Show me the config</h2></p><p><pre>\n&lt;?php</p><p>	header('Content-type: text/plain');</p><p>	echo "PHP settings:\n";\n	display_php_conf();</p><p>	echo "\n.htaccess settings:\n";\n	display_htaccess_conf();\n?&gt;\n</pre></p><p><p>This will just call the functions defined above so you can easily copy &amp; paste \nit to a file or pipe it if you are using the CGI version of PHP.\n</p></p><p><h2>Example output from the script</h2></p><p><pre>\nPHP settings:\nini_set('arg_separator.input', ';&amp;');\nini_set('arg_separator.output', ';');\nini_set('display_errors', '1');\nini_set('display_startup_errors', '1');\nini_set('magic_quotes_runtime', '');\nini_set('error_reporting', '2047');\nini_set('variables_order', 'GPCS');\nini_set('gpc_order', 'GPC');</p><p>.htaccess settings:\nphp_value arg_separator.input ;&amp;\nphp_value arg_separator.output ;\nphp_flag display_errors on\nphp_flag display_startup_errors on\nphp_flag magic_quotes_runtime off\nphp_value error_reporting 2047\nphp_value variables_order GPCS\nphp_value gpc_order GPC\nphp_flag asp_tags off\nphp_flag magic_quotes_gpc off\nphp_value output_buffering 4096\nphp_flag register_globals off\nphp_flag short_open_tag off\n</pre></p><p><h2>Some general considerations</h2></p><p><p>The above code didn't mention <code>track_vars</code> even a single time \nbecause as of PHP 4.0.3 it is always on. The example output was run on PHP 4.2.1\nand <code>ini_get()</code> returns FALSE for <code>track_vars</code> as if it does\nnot even exist. If you have an earlier version of PHP it is recommended to set it to true\nand disable <code>register_globals</code> for security and performance issues.\n</p></p><p><p>If you want to find even more information you can always count on the\n<a href="http://www.php.net/manual/" target="_blank" title="Opens in new window">PHP manual</a>.\n</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
