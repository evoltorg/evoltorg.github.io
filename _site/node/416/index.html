<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Let The User Skip The Splash Page</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Let The User Skip The Splash Page</h2>
<p class="meta">04 Sep 1999</p>

<div class="post">
<p>\nThe proliferation of <em>splash</em> pages on web sites has been seen by many to be a hindrance to the user.  A splash page generally consists of a default home page that displays the company logo, or some other branding for the site and/or company, using everything from Flash movies to animated graphics.\n</p>\n<p>\nWhat most site designers forget is that while their desire to brand their site may be important, it slows down the user every time that user has to wait for it to download, and then click through (provided that option has been offered by the designer).  So instead of forcing the user to circumnavigate the page with bookmarks or directly typing the page address in to his or her browser, we assume that once is enough.  Or, in the case of this tutorial, once a month is enough.\n</p>\n<p>\nI am offering two solutions within this article.  One is for those of you who do not have access to server-side scripting and is written in JavaScript.  The other is writtin in VBScript for Active Server Pages, but the concept is simple enough and may be easily repurposed for other server-side scripting languages.\n</p>\n<h2>What We're Doing</h2>\n<p>\nWe will set a cookie on the user's computer indicating that the user has seen the splash page already.  The next time the user comes back, the script will look for the cookie.  If the cookie is there, the splash page is skipped, if the cookie is not there, the splash page is displayed.  The cookie expires after a pre-determined amount of time.\n</p>\n<h2>JavaScript Solution</h2>\n<p>\nYou should paste the following code block in the <code>&lt;HEAD&gt;</code> of your HTML page.  There are comments strewn about within it, so make sure you don't paste those in.\n</p>\n<pre>&lt;script language=&quot;JavaScript&quot;&gt;\n&lt;!--</p><p>function ReDirect (URL) {</p><p>GetCookie('SplashSkip');</p><p>if (Splash == 'TRUE') {\n  window.location=(URL);\n}\nelse {}\n}</p><p>var Splash = GetCookie('SplashSkip');</pre>\n<p>\nThe above block of script creates the redirect function that will kick the user out of the splash page when called.  The first thing the function does is look for a cookie called <code>SplashSkip</code>.  If that cookie has a value of <code>TRUE</code> then it changes the URL of the current page to whatever the value for <code>URL</code> is as defined below.\n</p>\n<p>\nSetting <code>Splash</code> equal to the <code>GetCookie</code> function with the <code>SplashSkip</code> variable allows us to look for the cookie named <code>SplashSkip</code> without having to hardcode the value into the <code>GetCookie</code> function.\n</p>\n<pre>function getCookieVal (offset) {\n  var endstr = document.cookie.indexOf (';', offset);\n  if (endstr == -1)\n    endstr = document.cookie.length;\n  return unescape(document.cookie.substring(offset, endstr));\n}</p><p>function GetCookie (name) {\n  var arg = name + '=';\n  var alen = arg.length;\n  var clen = document.cookie.length;\n  var i = 0;\n  while (i &lt; clen) {\n  var j = i + alen;\n  if (document.cookie.substring(i, j) == arg)\n    return getCookieVal (j);\n  i = document.cookie.indexOf(' ', i) + 1;\n  if (i == 0) break;\n  }\n  return null;\n}</pre>\n<p>\nThe two functions above actually retrieve the values of any cookies passed to them, while making sure the script doesn't fall apart on older browsers, or on a browser with no cookie(s) set.\n</p>\n<p>\n<code>ReDirect('http://foo.com/skipsplash.html');</code>\n</p>\n<p>\nThis piece of script above is the only function that is run as soon as the page begins to load.  The <code>ReDirect</code> function as defined above now kicks in, which checks for the specified cookie.  If that cookie doesn't exist then the function ends, as you can see in the <code>else {}</code> statement above.  The target URL is placed in the parentheses.\n</p>\n<pre>function SetCookie (name, value) {\n  // Enter number of days the cookie should persist\n  var expDays = 30;\n  var exp = new Date();\n  exp.setTime(exp.getTime() + (expDays * 24 * 60 * 60 * 1000));\n  expirationDate = exp.toGMTString();\n  // Set cookie with name and value provided\n  // in function call and date from above\n  document.cookie = name + '=' + escape(value)\n  document.cookie += '; expires=' + exp.toGMTString();\n}</p><p>// --&gt;\n&lt;/script&gt;</pre>\n<p>\nThis final snippet of code creates the function that sets the cookie.  This function is called after the page has loaded, and so only runs if the user wasn't moved to a new page by the redirection function that loaded as soon as the page opened.  You set the number of days the cookie lasts on the user's machine by changing the value of <code>expDays</code>.\n</p>\n<p>\n<code>&lt;body onload="SetCookie('SplashSkip','TRUE');"&gt;</code>\n</p>\n<p>\nFinally, you add the JavaScript <code>SetCookie</code> function to an <code>onLoad</code> event in your <code>&lt;body&gt;</code> tag.  The example above defines the cookie name and value, which is what the rest of the script checks against in order to skip the splash page.\n</p>\n<h2>ASP/VBScript Solution</h2>\n<p>\nThis script still sets a cookie, but all the work is done by the server.  Instead of the splash page flashing on screen for a moment, as it does with the JavaScript solution, this script just serves up a completely different page.  The first thing you need to do, before the <code>&lt;head&gt;</code> tag, or anything else in the ASP file, is paste the following code:\n</p>\n<pre>&lt;%\nIF Request.Cookies(&quot;ASPSplashSkip&quot;) = &quot;TRUE&quot; THEN\n  response.redirect &quot;http://foo.com/skipsplash.html&quot;\nELSE\n  SET_COOKIE\n  HTML\nEND IF\n%&gt;</pre>\n<p>\nThe first thing the script does is look for a cookie with the name <code>ASPSplashSkip</code> and value of <code>TRUE</code>.  If that cookie exists, you are immediately served up a different page, and the splash page has been skipped.\n</p>\n<p>\nIf the cookie is not there, it goes on to the next part, which consists of displaying two <code>SUB</code>s, which are just pieces of HTML and/or script wrapped in <code>&lt;% SUB %&gt;</code> containers.  In this case, the function that sets cookies is wrapped in one, and the actual HTML of the page is wrapped in another.  I tend to use <code>SUB</code>s since it helps me to quickly and easily modify what happens in my ASP scripts when I have pieces of logic driving what gets displayed -- as I do here.\n</p>\n<pre>&lt;% SUB SET_COOKIE %&gt;\n&lt;%\n'###############\n'## Date Setting</p><p>DayLater = DateAdd(&quot;d&quot;, 1, FormatDateTime(Now,vbGeneralDate))\nWeekLater = DateAdd(&quot;ww&quot;, 1, FormatDateTime(Now,vbGeneralDate))\nMonthLater = DateAdd(&quot;m&quot;, 1, FormatDateTime(Now,vbGeneralDate))</p><p>  '## Choose a timeframe from above and\n  '## make it equal to TargetDate\n  TargetDate = MonthLater</p><p>'##################\n'## Cookie Setting</p><p>  '## This sets the cookie so that the next time the\n  '## user comes back he/she will skip the splash page\n  Response.Cookies(&quot;ASPSplashSkip&quot;) = &quot;TRUE&quot;\n  Response.Cookies(&quot;ASPSplashSkip&quot;).expires = TargetDate</p><p>%&gt;\n&lt;% END SUB %&gt;</pre>\n<p>\nThe first part allows you to select a timeframe for the expiration of the cookie.  I have provided three timeframes to make it easy, since you can't just enter a number of days as you can with the JavaScript.  So if you decide you only want the cookie to last one week before expiring, set <code>TargetDate</code> equal to <code>WeekLater</code>.\n</p>\n<p>\nThe second part sets the cookie with the name/value pair you see in quotes.  In this example, the name is <code>ASPSplashSkip</code> and the value is <code>TRUE</code>.  It also sets the expiration date for the cookie based on the value you set for <code>TargetDate</code>.\n</p>\n<pre>&lt;% SUB HTML %&gt;\n&lt;HTML&gt;</p><p>&lt;!-- Insert splash page here --&gt;</p><p>&lt;/HTML&gt;\n&lt;% END SUB %&gt;</pre>\n<p>\nFinally, whatever is within the <code>&lt;% SUB HTML %&gt;</code> and <code>&lt;% END SUB %&gt;</code> containers is the actual content of your splash page.  The example above is trimmed to just the <code>&lt;HTML&gt;</code> tags, but you can have any HTML in there, including your Flash splash movie, or your DHTML effects, or whatever else goes on that splash page.\n</p>\n<h2>Samples</h2>\n<p>\nSee an example of these scripts work with an <a href="http://roselli.org/adrian/articles/sample_splash_asp.asp" title="Skip the Splash Page with ASP" target="_new">ASP page</a>, or see it work with a <a href="http://roselli.org/adrian/articles/sample_splash_js.asp" title="Skip the Splash Page with JavaScript" target="_new">plain HTML page using JavaScript</a>.\n</p>\n<h2>Finally</h2>\n<p>\nRemember that this doesn't guarantee a user won't see a splash page more than once a month (for this example), especially if they switch browsers or have cookies turned off, but it's a good start.  This also doesn't mean you shouldn't re-examine the utility of your splash pages.  They should still be functional, and should still offer a way to get to the real content of your site for the user who actually sees it.\n</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
