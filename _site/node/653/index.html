<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Dirty Shell Scripts Part 1 Virtual Hosting</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Dirty Shell Scripts Part 1 Virtual Hosting</h2>
<p class="meta">28 Dec 1999</p>

<div class="post">
<p>If you run any type of Web hosting service like me, you know what a pain in the ass it can be to have to add new virtual hosts to your Web server. If you have Linux and Apache, here's a quick'n'dirty little script that will save you a ton of time:\n</p>\n<pre>\nif [ -t 0 ] # Make sure stdio is a terminal\nthen\n        echo &quot;Enter the new hostname:&quot;;\n        read arg1\n        /usr/sbin/useradd -s /bin/false $arg1;\n        echo &quot;User added...&quot;;\n        sed -e &quot;s/name.com/$arg1/g&quot; virthost.conf &gt;&gt; httpd.conf;\n        /usr/local/apache/bin/apachectl restart;\n        echo &quot;$arg1 was added and Apache restarted. You're so sexy!&quot;;\n        chmod 755 /home/$arg1;\nelse\n        echo &quot;Houston, we had a problem!&quot;\nfi\n</pre>\n<p>\nStep by step:\n</p>\n<ul>\n<LI>Basically, the script takes input from the terminal, and makes whatever you typed in the variable 'arg1'.</LI>\n<LI>Next, we create a user account for the new domain.</LI>\n<LI>The line that does most of the work, 'sed -e ...' is next. We're simply doing a searching for <strong>name.com</strong> and replacing it with the name of our new domain. It does the search and replace on a file named <strong>virthost.conf</strong>, which simply contains the Apache &lt;VirtualHost&gt; directive. Here's what my virthost.conf looks like:<br /></p><p><pre>\n&lt;VirtualHost 10.10.10.10&gt;\nServerName www.name.com\nDocumentRoot /home/name.com/public_html\nCustomLog /home/name.com/web.log combined\nCustomLog /home/name.com/main.referer.log referer\n&lt;/VirtualHost&gt;\n</pre></p><p>Naturally, you'll replace the IP address 10.10.10.10 with the IP address of your webserver.\nThis step finishes up by appending what it replaced in virthost.conf to your httpd.conf(Apache config) file - while leaving the virthost.conf file intact.</LI>\n<LI>The script finishes up by restarting Apache, <B>chmod</B>'ing the users directory and letting you know how of your sexual prowess.</LI>\n<LI>To get everything to run, copy and paste the virthost.conf file above and save it in $your_apache_home/conf - same with the script itself, cut and paste it into $your_apache_home/conf and save it as newhost.sh(Don't forget to set it executable!). Everything should work pretty smurfy. If not, post a question below and I'll try to help ya out :)\n</LI>\n</UL></p><p><P>\nNow, this script is extremelly lacking in the error and exception checking department, so use at your own risk. Like I said, its quick'n'dirty :) However, if you are adding a couple virtual host's a day to your httpd.conf file, you'll soon be wonder where you would be without a script to do the grunt work for you..</P>\n<P>\nNext time we'll throw together a script that will make updating your DNS servers a snap. If you have any other ideas for shell scripts that would make your life easier, and like to see them here, <a href="mailto:djc@members.evolt.org">email me</a> or put your suggestion below!</p><p></P>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
