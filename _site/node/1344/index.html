<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Including Files In Asp</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Including Files In Asp</h2>
<p class="meta">15 Mar 2000</p>

<div class="post">
<p>\nAs more people use Active Server Pages, I've noticed a trend that newer users can't figure out how to include files into their scripts.  Part of the problem is that they expect an include directive to exist in the <code>'&lt;%'</code> and <code>'%&gt;'</code> script tags, but this isn't the case with Active Server Pages.  Instead, you'll notice the include directive is reminiscent of Apache, or other web servers that allow server-side includes.  As such, there are some rules to including files and keeping them from breaking your script that you have to keep in mind.  So let's jump right in...\n</p></p><p><p>\nTo include files in ASP pages:\n</p></p><p><pre>\n&lt;!--#include virtual   file =&quot;filename&quot;--&gt;\n</pre></p><p><p>\nThe <code>'virtual'</code> and <code>'file'</code> keywords indicate the type of path you are using to include the file, and 'filename' is the path and file name of the file you want to include.\n</p></p><p><p>\nIncluded files do not require a special file name extension; however, MS docs will recommend giving included files an <code>.inc</code> extension to distinguish them from other types of files.  I prefer to create a directory that contains all the files, and give them all an <code>.asp</code> extension.  If someone finds that directory and/or file name (which can happen if your ASP scripts break and it shows the offending code), then the ASP parser will execute the script within.  By default, the server will treat an <code>.inc</code> file as plain text and serve it as such.  Often my include files are functions or navigation, so the result is a blank screen or an odd HTML page if I use an <code>.asp</code> extension.  This prevents a user from seeing my code (which may include database connection information), and while it may generate an error, this is preferrable to showing all my script as plain text.\n</p></p><p><h2>Using the 'Virtual' Keyword</h2></p><p><p>\nUse the '<code>virtual</code>' keyword to indicate a path beginning with a virtual directory. For example, if a file named '<code>footer.inc</code>' resides in a virtual directory named '<code>/footer</code>,' the following line would insert the contents of '<code>footer.inc</code>' into the script containing the line:<br><br> <code>&nbsp;&nbsp;&lt;!--#include virtual ="/footer/footer.inc"--&gt;</code>\n</p></p><p><h2>Using the 'File' Keyword</h2></p><p><p>\nUse the '<code>file</code>' keyword to indicate a relative path. A relative path begins with the directory that contains the including file. For example, if you have a file in the directory '<code>headers</code>', and the file '<code>header.inc</code>' is in '<code>root\headers</code>', the following line would insert <code>'header.inc'</code> into your script:<br><br> <code>&nbsp;&nbsp;&lt;!--#include file ="headers/header.inc"--&gt;</code>\n</p></p><p><p>\nNote that the path to the included file, '<code>headers/header.inc</code>,' is relative to the including file; if the script containing this <code>#include</code> statement is not in the directory '<code>/root</code>', the statement would not work.\n</p></p><p><p>\nYou can also use the file keyword with '<code>../</code>' syntax to include a file from a parent, or higher-level, directory if the 'Enable Parent Paths' option is selected in Internet Service Manager.\n</p></p><p><h2>Other Notes:</h2></p><p><ul>\n <li>You can have one include file include another.  A file cannot include the file including it, nor can it include itself.  That would be bad.</li>\n <li>The include file must not have open control structures, nor can it be used to close control structures. You can't start an '<code>if</code>' statement in your main page and have the corresponding '<code>end if</code>' in the included file. The include file has to be able to stand on its own.</li>\n <li>The ASP parser includes a file <em>before</em> executing any script commands. This means you can't put a variable in the filename and include files dynamically based on that variable's value.  You can, however, load the include into a SUB and call the SUB only if certain criteria are met. For instance:<br>\n<pre>\n  &lt;% IF foo = &quot;bar&quot; THEN %&gt;\n    &lt;!--#include file =&quot;include/bar.inc&quot;--&gt;\n  &lt;% ELSE %&gt;\n    &lt;!--#include file =&quot;include/foo.inc&quot;--&gt;\n  &lt;% END IF %&gt;\n</pre>\nWill still load both include files into the ASP script, as opposed to only loading one of them.  However, a cleaner way to do this might be:<br>\n<pre>\n  &lt;% IF foo = &quot;bar&quot; THEN\n    BAR\n  ELSE\n    FOO\n  END IF %&gt;</p><p>  &lt;% SUB FOO %&gt;\n  &lt;!--#include file =&quot;include/foo.inc&quot;--&gt;\n  &lt;% END SUB %&gt;</p><p>  &lt;% SUB BAR %&gt;\n  &lt;!--#include file =&quot;include/bar.inc&quot;--&gt;\n  &lt;% END SUB %&gt;\n</pre></li>\n <li>You must close your script tags before including a file.  For instance:<br>\n<pre>\n  &lt;% SUB FOOTER %&gt;\n  &lt;!--#include file =&quot;footers/footer.inc&quot;--&gt;\n  &lt;% END SUB %&gt;\n</pre>\nWill work. However,<br>\n<pre>\n  &lt;% SUB FOOTER\n  &lt;!--#include file =&quot;footers/footer.inc&quot;--&gt;\n  END SUB %&gt;\n</pre>\nWill not.</li>\n</ul>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
