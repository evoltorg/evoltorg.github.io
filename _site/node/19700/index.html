<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Handy Little Perl Script</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Handy Little Perl Script</h2>
<p class="meta">24 Jan 2002</p>

<div class="post">
<p>In this article I'm just going to show you a little script that will make working with forms and cookies in Perl a little easier. The form information, and any cookies present will already be dumped into variables matching their names, like in PHP.</p>\n<h2>Time Saving</h2>\n<p>I don't know about you, but when I'm coding in Perl I used to get sick of breaking the query string, POST input, cookie information up so i could get at it. This little script can be included at the top of each of your perl script to make it just that little bit easier. I know a lot of people have probably already got something similar for web programs with Perl, but I'll put it up here anyway.</p>\n<h2>Here it is</h2>\n<h3>Process GET/Query String</h3>\n<pre>\n#!/usr/bin/perl</p><p># Process form variables for both POST and GET methods.\n# Below Will process all query string variables.</p><p>if ($ENV{'REQUEST_METHOD'} eq "GET"    $ENV{'QUERY_STRING'} ne "")\n{\n @pairs = split(/\&/, $ENV{'QUERY_STRING'});\n foreach $pair (@pairs)\n {\n  ($name, $value) = split(/=/, $pair); # Split into name and value.\n  $$name = $value; # Assign value to scalar matching name.\n  $$name =~ s/%(..)/chr(hex($1))/ge; # Decode encoded stuff.\n  $$name =~ s/\+/ /g; # substitute +'s for spaces.\n }\n}\n</pre>\n<p>If the request method is <strong>GET</strong> the variables will be in the query string, all query string information will be processed by this bit of code whether it's from a form or not. We split the query string at the <strong>&amp;</strong> and dump each pair into the <code>@pairs</code> array. Then we use the <code>foreach</code> function to go through each pair in the array, split them at the <strong>=</strong> and dump the first part into <code>$name</code> and the last part into <code>$value</code>. Then we assign the <code>$value</code> variable to a scalar variable matching the name of the <code>$name</code> variable. Say we had in the query string: <strong>?action=mail</strong>, we would now have a variable <code>$action</code> containing <code>&quot;mail&quot;</code>. Finally we decode anything that has been URL encoded, and replace any <strong>+</strong> signs with a space. Remember to format your query string correctly when using this script. Just <code>http://host.com/index.pl?mail</code> will cause weird things to happen. Assign &quot;mail&quot; to a handler <code>?action=mail</code>.</p>\n<h3>Process POST</h3>\n<pre>\n# Process POST form variables.</p><p>if ($ENV{'REQUEST_METHOD'} eq "POST")\n{\n read(STDIN, $stuff, $ENV{'CONTENT_LENGTH'});\n @pairs = split(/\&/, $stuff);\n foreach $pair (@pairs)\n {\n  ($name, $value) = split(/=/, $pair);\n  $$name = $value;\n  $$name =~ s/%(..)/chr(hex($1))/ge;\n  $$name =~ s/\+/ /g;\n }\n}\n</pre>\n<p>Reads the POST information into the variable <code>$stuff</code> and then processes them in the same way we did the query string, assigning the value to a scalar variable matching the form input name.</p>\n<h3>Process Cookies</h3>\n<pre>\n# Process cookies.</p><p>if ($ENV{'HTTP_COOKIE'} ne "")\n{\n @pairs = split(/\; /, $ENV{'HTTP_COOKIE'});\n foreach $pair (@pairs)\n {\n  ($name, $value) = split(/=/, $pair);\n  $$name = $value;\n  $$name =~ s/%(..)/chr(hex($1))/ge;\n  $$name =~ s/\+/ /g;\n }\n}\n</pre>\n<p>This time, if <code>$ENV{'HTTP_COOKIE'}</code> contains data we split the information at the <strong>;</strong> and then process it the same way we processed the POST and GET/query string information.</p>\n<h3>Include it</h3>\n<p>Just include the script at the top of each of your perl files.</p>\n<p><code>do &quot;$DOCUMENT_ROOT/script.pl&quot;;</code></p>\n<h3>The Full Script</h3>\n<pre>\n#!/usr/bin/perl</p><p># Process form variables for both POST and GET methods.\n# Below Will process all query string variables.</p><p>if ($ENV{'REQUEST_METHOD'} eq "GET"    $ENV{'QUERY_STRING'} ne "")\n{\n @pairs = split(/\&/, $ENV{'QUERY_STRING'});\n foreach $pair (@pairs)\n {\n  ($name, $value) = split(/=/, $pair); # Split into name and value.\n  $$name = $value; # Assign value to scalar matching name.\n  $$name =~ s/%(..)/chr(hex($1))/ge; # Decode encoded stuff.\n  $$name =~ s/\+/ /g; # substitute +'s for spaces.\n }\n}</p><p># Process POST form variables.</p><p>if ($ENV{'REQUEST_METHOD'} eq "POST")\n{\n read(STDIN, $stuff, $ENV{'CONTENT_LENGTH'});\n @pairs = split(/\&/, $stuff);\n foreach $pair (@pairs)\n {\n  ($name, $value) = split(/=/, $pair);\n  $$name = $value;\n  $$name =~ s/%(..)/chr(hex($1))/ge;\n  $$name =~ s/\+/ /g;\n }\n}</p><p># Process cookies.</p><p>if ($ENV{'HTTP_COOKIE'} ne "")\n{\n @pairs = split(/\; /, $ENV{'HTTP_COOKIE'});\n foreach $pair (@pairs)\n {\n  ($name, $value) = split(/=/, $pair);\n  $$name = $value;\n  $$name =~ s/%(..)/chr(hex($1))/ge;\n  $$name =~ s/\+/ /g;\n }\n}\n</pre>\n<h2>Expand It</h2>\n<p>If you're using Perl for CGI why not use this little script, and add to it some? Maybe you could define the content-type header in the script, as you'll probably be using HTML just add:</p>\n<p><code>print &quot;Content-type: text/html</p><p>&quot;;</code></p>\n<p>so you don't need to bother doing it in your scripts. Why not add a mailing subroutine into it (see <a href="/article/Simple_CGI_Email_Subroutine/17/398/index.html" title="MartinB: A simple CGI E-Mail Subroutine" target="_blank">MartinB's Article</a>, A Simple CGI E-Mail Subroutine). Be creative.</p>\n<h2>Bibliography</h2>\n<p>Well, there's no links i can point you to really. Hummm, how about some Perl stuff?</p>\n<ul>\n<li><a href="http://www.perl.com" title="perl.com" target="_blank">http://www.perl.com</a></li>\n<li><a href="http://www.activestate.com" title="Active State" target="_blank">http://www.activestate.com</a></li>\n<li><a href="http://www.cgi-resources.com" title="CGI Resources" target="_blank">http://www.cgi-resources.com</a></li>\n</ul>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
