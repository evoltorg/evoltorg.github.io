<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Simulating Apache Asis Feature With Very Simple Cgi</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Simulating Apache Asis Feature With Very Simple Cgi</h2>
<p class="meta">30 Oct 2007</p>

<div class="post">
<p>Apache's asis feature, provided by <a href="http://httpd.apache.org/docs/1.3/mod/mod_asis.html">mod-asis</a>, is a very simple way of sending static HTTP headers along with static content. Many installations of Apache have this disabled (the default) and those of us not on Apache are out of luck. This combination has led to this simple and useful feature being overlooked by most web developers.\n</p>\n<p>Following is a simple method of simulating the behavior of asis using CGI. While CGI does tend to be slower, the only speed loss here is how long it takes the server to launch a small program since the content itself is static. For performance and simplicity, we will be using the tail program, which is included in virtually all unix-like systems. Here is the shebang line you would add to the start of your asis file:\n</p>\n<pre>\n#!/usr/bin/tail --lines=+2\n</pre>\n<p>The above command executes tail and the --lines=+2 indicates that we want the first line to be skipped. This is needed because the first line is the shebang line. In other parsed CGI languages the # would be treated as a comment, but tail does not parse the text, it just outputs it. If this wasn't an issue then we could just use the cat command instead.\n</p>\n<p>Here is an example use of our simulated asis feature. Here we have this file at http://example.com/app/index.cgi\n</p>\n<pre>\n#!/usr/bin/tail --lines=+2\nContent-Type: text/html\nLocation: http://example.com/app/version2/\n</pre>\n<p>It serves as a redirect for us. Other uses for this feature include under construction pages that you do not want cached, refreshing pages that reference client side script that changes often or is somehow dynamic (like adverts or status page), and sending or clearing a cookie (and possibly redirecting or refreshing).\n</p>\n<p>Please note that we are not restricted to using tail. We could use dog (an enhanced replacement for cat) like so:\n<pre>\n#!/usr/bin/dog -l 2- -\n</pre></p><p><p>If you are on a Windows server, then you are likely out of luck because Windows doesn't have simple command-line tools like tail included (they might be found by searching the net, however). If you were on Windows this likely would not be ideal anyway because CGI is much more expensive on Windows than on unix-like systems, and because Windows doesn't parse the shebang line.\n</p>\n<p>So, we have a simple, fairly efficient way to transform dynamic pages that send headers while the rest is echo or print statements using a CGI solution that is not slow by any means.\n</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
