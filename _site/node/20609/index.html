<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Recovering From Anonymous Ftp Abuse</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Recovering From Anonymous Ftp Abuse</h2>
<p class="meta">29 Jan 2002</p>

<div class="post">
<p>Anonymous FTP is never a good idea anymore because it leaves you open to abuse from people who like nothing more than free sharing for their movies, MP3s or pr0n.  The best step you can take to avoid abuse, of course, is to never let it happen.  However, perhaps you inherited a project on a poorly-configured server, or there is a neglected server that you aren't yet using, or you just didn't know to turn off Anonymous FTP in the first place (IIS leaves it on by default).  This article will show you how to solve the problem.</p></p><p><p><em>Note: This tutorial assumes that the victim machine is running IIS.</em></p></p><p><h2>Stop the Bleeding</h2></p><p><p>The first step, of course, is to turn off Anonymous FTP immediately.  In Internet Services Manager in IIS, right-click on your affected FTP server, click the &quot;Security Accounts&quot; tab and uncheck &quot;Allow Anonymous Connections&quot;.  After this is accomplished, restart the FTP services to kick any current connections.</p></p><p><h2>Wash Area With Soap and Water</h2></p><p><p>Those who abuse Anonymous FTP on WinNT/2K boxes have learned lots of irritating little tricks to prevent you from being able to remove the contents they upload.  Sometimes they will use characters that are perfectly legitimate to the NTFS file system and/or on Unix-based systems, but that Windows will choke on (Carriage Returns, Tabs, Backspaces, Slashes, Semicolons, Colons, etc.).  This way, when Windows goes to delete the file, it insists that it can't because it doesn't understand the file name.  Sometimes even trying to open the directory in Windows Explorer will hang the machine.</p></p><p><p>Another trick that is used is to create directories that are reserved words in the Windows file system: AUX, COM, CON, LPT1, LPT2, NUL or PRN, for example.  Again, Windows will not permit you to delete these directories because it figures that they are system files and it knows how damaging that would be.</p></p><p><h2>Perform CPR</h2></p><p><p>You can't remove these files directly through Windows.  You will need to go through the command prompt to delete files.  From the command prompt, go to the affected directories.  Now, and here is the trick, use the <code>dir</code> command with the <code>/x</code> switch (<code>dir /x</code>).  The <code>/x</code> switch is rarely used, but it produces the 8.3 DOS name for every file and directory name longer than eight characters (like &quot;My Documents&quot; shows up as &quot;MYDOCU~1&quot;).</p></p><p><p>Now that you know the name of the directory that DOS understands, you can delete the directory.  I've had so-so success with doing a recursive directory delete (<code>rd /S WHATEVER</code>) as sometimes DOS will trip over the subdirectories.  If you cannot recursively delete the entire directory, you will have to manually traverse the entire directory tree and delete the contents manually (which can be <em>very</em> time-consuming, depending on how much junk the abusers put on your server).</p></p><p><h2>Call 911</h2></p><p><p>If you need more help, here are a few links you can use that provide more information about the problem and some additional suggestions.</p></p><p><ul>\n<li><a href="http://www.anetforums.com/thread.asp?Action=Read&ThreadIndex=233" title="A Thread on ActiveNetwork Forums (Opens in a New Window)" target="_new">http://www.anetforums.com/thread.asp?Action=Read&amp;ThreadIndex=233</a></li>\n<li><a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q120716" title="Microsoft Support Article (Opens in a New Window)" target="_new">http://support.microsoft.com/default.aspx?scid=kb;EN-US;q120716</a></li>\n</ul>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
