<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Dynamic Websites On A Cd</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Dynamic Websites On A Cd</h2>
<p class="meta">07 Jul 2003</p>

<div class="post">
<p>Many people have asked how to do this over the years. Most solutions involved\n  a static presentation, which any novice can produce. I will attempt to illustrate\n  what it takes to bring your favorite dynamic website to your system, without\n  the big WWW... at all. </p></p><p><h2>Stuff You Need</h2>\n<ul>\n  <li>A CD writable drive to make the CD</li>\n  <li>CD writing software</li>\n  <li>Microsoft Access Database (97 preferrably. I'll explain why later)</li>\n  <li>Notepad or any another web page authoring tool</li>\n  <li>Knowledge of VBScript/ASP will do you good here</li>\n</ul>\n<h2>Let's Get Started</h2>\nAssuming you, your computer, and any and all applications are ready to work...</p><p><ol>\n  <li><strong>Start off by creating a Microsoft Access 97/2000 database.</strong> <br>\n    You can use a MS Access 2000 database but if you want greater compatibility\n      to older systems such as Windows NT 4.0, 97 is the way to go. Just make\n      sure you convert your database to 97 when you've finished modifying the\n      2000 version.<br>\n  </li>\n  <li><strong>Next, you'll want to create your Dynamic HTML page.</strong><br>\n    That's right. I said dynamic html page; no need to blink and/or rub your\n      eyes. The following script will illustrate how to do so. <br>\n    \n    <pre>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;My First Dynamic HTML Page&lt;/title&gt;</pre>\n  </li>\n  <li><strong>Add CD-Rom detection script.</strong><br>\n    You'll need this to determine the exact path to the actual database (which\n      will be located on the CD-Rom). This information is vital for step 4. The\n      code below will pick out the correct CD-Rom drive regardless if you place\n      your CD in the 15th bay of a 31 bay CD-Rom drive tower. The code will break\n      if there is an identical database name as yours in another CD-Rom drive.\n      To avoid this, just name your database something completely unique.<br>\n    <br>\n    <pre>&lt;script language=&quot;VBScript&quot;&gt;\n    \n        'Declare variables used in this code\n      Dim CD_Rom, FilePath, DriveLetter, DriveType, FileSystemObject, Drives</p><p>        'Create a filesystem object</p><p>        Set FileSystemObject = CreateObject(&quot;Scripting.FileSystemObject&quot;) \n    Set Drives = FileSystemObject.Drives 'Create a drives collection </p><p>        For Each DiskDrive in Drives\n        &nbsp;&nbsp;&nbsp;DriveLetter = DiskDrive.DriveLetter\n&nbsp;&nbsp;&nbsp;DriveType = DiskDrive.DriveType</p><p>         &nbsp;&nbsp;&nbsp;if DiskDrive.DriveType = &quot;4&quot; then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CD_Rom = DiskDrive.DriveLetter\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FilePath = CD_Rom &amp; &quot;:\YourDataBase.mdb&quot;\n        \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set FileSys = CreateObject(&quot;Scripting.FileSystemObject&quot;)\n        \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If FileSys.FileExists(FilePath) then \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'This is the correct\n  CD-Rom drive.\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit For\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Keep trying\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if\n        \n&nbsp;&nbsp;&nbsp;end if\n        \n      Next</p><p>        'Clean up data usage</em>\n        Set Drives = nothing\n        Set FileSystemObject = nothing\n      Set FileSys = nothing\n</pre>\n  </li>\n  <li><strong>Add the DSN script</strong><br>\n  If you want to connect to any database, you'll need a &quot;vehicle&quot; to\n    do so. A DSN (Data Source Name) is just want the doctor ordered.<br>\n    <pre>\n    'Declare variables used in this code\n    Dim Recordset1\n    \n    Recordset1 = CreateObject(&quot;ADODB.Recordset&quot;)\n    Recordset1.ActiveConnection = &quot;Driver={Microsoft Access Driver (*.mdb)};Dbq=&quot; &amp; FilePath &amp; &quot;;Uid=admin;Pwd=&quot;\n    Recordset1.Source = &quot;SELECT * FROM YourTable WHERE Conditions=Exist&quot;\n    Recordset1.CursorType = 0\n    Recordset1.CursorLocation = 2\n    Recordset1.LockType = 3\n    Recordset1.Open() \n&nbsp; </pre></li>\n  <li><strong>Finish off the script</strong><br>\n    <pre>\n    &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&nbsp;    </pre></li>\n  <li><strong>Write your dynamic code</strong><br>\n    Use this script as often as you need throughout your newly created dynamic\n      HTML page.<br>\n    \n    <pre>&lt;script language=&quot;VBScript&quot;&gt;\n&nbsp;&nbsp;&nbsp;if not Recordset1.Fields.Item(&quot;ColumnName&quot;).Value\n= &quot;&quot; then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.write(Recordset1.Fields.Item(&quot;ColumnName&quot;).Value)\n&nbsp;&nbsp;&nbsp;end if\n&lt;/script&gt;\n&nbsp;    </pre></li>\n  <li><strong>Finish your HTML page</strong><br>\n    You'll also want to close your database connection as good housekeeping practice.<br>\n    \n    <pre>&lt;/body&gt;\n&lt;/html&gt;\n&lt;script language=&quot;VBScript&quot;&gt;\n    Recordset1.Close()\n&lt;/script&gt;</pre>\n&nbsp;    </li>\n  <li><strong>Other Things to Add If Needed</strong><p>\n    You're probably thinking, ok so all this does is display information from\n      a database. I want to use this page as a template for lots and lots of\n      information. What if I want to send this page a Product ID number or other\n      variables that should help me determine what information to display from\n      my new database. Here's how...<br>\n    </p>\n     <p>\n    Add this somewhere before your database call in your &lt;script&gt;&lt;/script&gt; tags:<br>\n        <pre> Dim ProductID\n        ProductID = split(Location.href, &quot;=&quot;)\n        \n        </pre> Then down in your database call add as part of your where clause:\n    <br>\n        <pre> &quot;... WHERE ProductID = &quot; &amp; ProductID(1) \n        \n        </pre></p>\n<p>When you used the split function above, you in essense created\n        an array of variables. Product(0) contains your variable name like <code>&quot;ProductID&quot;</code>.\n    Product(1) should contain the actual number you wanted. For example, if you\n    wanted to reference this page by:<br>\n    <pre>\n    thispage.htm?ProductID=123\n    </pre>\n    ProductID(1) will contain the number 123. Since everything starts numbering\n    at 0 :-) you can reference all your variables in your query string by referencing\n    the odd numbers (i.e. ProductID(1), ProductID(3), etc.)</p>\n&nbsp;  </li>\n  <li><strong>Burn Away!</strong><br>\n    Pay close attention to Step 3 in regards to where you should place your database\n      on the CD-Rom. Currently the code should work if the database is on the\n      root directory of the CD-Rom. If it resides elsehwere, just change the\n      code to parallel your changes.</li>\n</ol>\n<p>If you see anything wrong or need help with something in this tutorial, give\n  me a <a href="mailto:rob.smith@thermon.com">shout</a>.</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
