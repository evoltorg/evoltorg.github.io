<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>A Touch Of Class   Skinable Javascript</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>A Touch Of Class   Skinable Javascript</h2>
<p class="meta">01 Jun 2004</p>

<div class="post">
<p>Ok, let's repeat the trinity of web standards: Markup is the structure, \nStyle Sheets are the presentation and Javascript is the behaviour. That much \nshould be common sense by now. New starters in web development have the \nchance to follow these rules easily - no more annoying IE4s and Netscape \nCommunicators to worry about - modern browsers can do the CSS and xHTML dance \nquite well. The separation of markup and presentation is practised a lot, and \nloads of tutorials and templates help the developer to do so.</p> \n<p>With Javascript, it is still a bit dodgy, as too many good resources get lost \nin the mass of bad or outdated ones.</p>\n<h2>Look - new Javascript!</h2>\n<p>2004's state-of-the-art Javascript should be unobtrusive and easily maintainable. \nIn essence, this means:</p>\n<ul>\n	<li>Only apply itself when it is possible to do so.</li>\n	<li>Use the markup as it is without the need to add inline event calls.</li>\n	<li>Be independent of the input device (insofar this is possible).</li>\n	<li>Play along well with other Javascripts (no common global variables, no event hijacking).</li>\n	<li>Keep the visuals to the CSS, to avoid double maintenance.</li>\n</ul>\n<p>The last item is what this article is about. Many a time, \nyou encounter scripts that are nice in themselves, but fail to completely \nseparate the presentation from the behaviour. We cannot assume that every web \ndeveloper knows Javascript - and its syntax. To avoid frustration using a \nscript, we need to find a way to allow the developer to skin the outcome of this behaviour with \nCSS. This also makes maintenance easier, as you don't need to check in two \nplaces, if you have to change the visiual outcome - all it needs is a change of \nthe CSS.</p>\n<h2>We want clickable headlines - now!</h2>\n<p>Let's take a look at an example. Say we want to make every second level headline \nin a document clickable. What it should do is collapse and expand an adjacent element.</p>\n<p>Headers as they are are not clickable elements, so we need to make the user \naware that ours are. We do this by adding a &#62; and a hover state.</p>\n<p>In the world of non-Internet Explorer, the hover could be done via CSS, but \nin the real world, we do it via Javascript to ensure that the majority of users \nwill see the effect.</p>\n<p>When the header was clicked, we want to give it a selected state.</p>\n<p>Now, if we kept the design in the Javascript, this could be done like this:</p>\n<pre>\n// Define colours\nvar hovercolour='#ffc';\nvar normalcolour='#fff';\nvar highlight='#69c';\nfunction init()\n{\n var h2s,i,tohide,tohideobj,isexpanded;\n// grab all second level headlines and loop over them \n h2s=document.getElementsByTagName('h2');\n for (i=0;i&#60;h2s.length;i++)\n {\n// get next sibling (the element to hide, check that it is an element\n  tohide=h2s[i].nextSibling;\n  while(tohide.nodeType!=1)\n  {\n   tohide=tohide.nextSibling;\n  }\n  h2s[i].tohideobj=tohide;\n// add the hover function onmouseover and onmouseout \n  h2s[i].onmouseover=function(){hover(this,this.tohideobj,1);}\n  h2s[i].onmouseout=function(){hover(this,this.tohideobj,0);}\n// hide next element and add onclick event to show and hide it\n  tohide.style.display='none';\n  h2s[i].onclick=function(){collapse(this,this.tohideobj);return false}\n  h2s[i].insertBefore(document.createTextNode('>'),h2s[i].firstChild);\n }\n   }\n// hover function, adds the hover colour \n// unless the headline is an active trigger\nfunction hover(o,ho,state)\n{\n if(ho.style.display=='none')\n {\n  o.style.background=state==1?hovercolour:normalcolour;\n }\n}\n// collapse function, shows and hides the element and sets the highlight \n// colour of the headline\nfunction collapse(o,ho)\n{\n ho.style.display=ho.style.display=='none'?'block':'none';\n o.style.background=highlight;\n}\nwindow.onload=init;\n</pre>\n<p>It does <a href="http://www.icant.co.uk/articleassets/h2test.html" target="_blank">work</a>, but has some disadvantages:</p>\n<ul>\n	<li>We need to know javascript (at least how to set variables) to change \n	the look and feel.</li>\n	<li>We can only change backgrounds, if we also wanted to change the colour, \n	we'd need to set more variables and extend the hover and the collapse \n	functions.</li>\n</ul>\n<h2>Becoming classy</h2>\n<p>What to do? Easy - put all the presentation in style sheet classes, and \nuse the className attribute to change them.</p>\n<p>This also means we won't have to add the &#62; any longer, as that can be \ndone in a background image.</p>\n<pre>\n.hover{\n padding-left:30px;\n background:url(arrow.gif) 5px 5px no-repeat #ffc;\n color:#000;\n}\n.highlight{\n padding-left:30px;\n background:url(arrowon.gif) 5px 5px no-repeat #69c;\n color:#fff;\n}\n.normal{\n padding-left:30px;\n background:url(arrow.gif) 5px 5px no-repeat #fff;\n color:#000;\n}\n.hidden{\n display:none;\n}\n</pre>\n<p>Then we change the functions accordingly:</p>\n<pre>\nfunction init()\n{\n[...]\n// hide next element and add onclick event to show and hide it\n  tohide.className='hidden';\n  h2s[i].className='normal';\n[...]\n}\n// hover function, adds the hover colour \n// unless the headline is an active trigger\nfunction hover(o,ho,state)\n{\n if(ho.className=='hidden')\n {\n  o.className=state==1?'hover':'normal';\n }\n}\n// collapse function, shows and hides the element and sets the highlight \n// colour of the headline\nfunction collapse(o,ho)\n{\n ho.className=ho.className=='hidden'?'':'hidden';\n o.className='highlight';\n}\n</pre>\n<p><a href="http://www.icant.co.uk/articleassets/h2test2.html" target="_blank">Works a treat</a>, but still has one problem:</p>\n<p>If I already have a class on the headline, the script will remove that one,\nwhich means once again Javascript meddling with presentation</p>\n<h2>Becoming even classier</h2>\n<p>One thing that is amazingly enough still not too commonly known:</p>\n<p>Elements can have more than one class. Something like \n<code><h2 class="normal enhanced"></code> is <a href="http://www.w3.org/TR/REC-html40/struct/global.html#h-7.5.2" target="_blank">perfectly valid \nHTML</a> and is <a href="http://www.pixelsurge.com/experiment/multiplestyles.htm" target="_blank">supported by modern browsers</a>.</p>\n<p>Bearing this in mind, we can add our classes to the existing ones or remove \nthem. For this, we can use two small functions.</p>\n<pre>\nfunction juggleClass(o,c,s)\n{\n o.className=s==1?o.className+' '+c:o.className.replace(' '+c,'');	\n}\nfunction checkClass(o,c)\n{\n var isClassInObj=o.className.indexOf(c)!=-1?true:false;\n return isClassInObj;\n}\n</pre>\n<p>juggleClass adds the class c to the object o when s is 1, otherwise it removes the class \nc from the object o.</p>\n<p>checkClass checks if the class c is one of the classes of the object o.</p>\n<p>If we add that feature, our final function looks like this:</p>\n<pre>\nfunction init()\n{\n var h2s,i,tohide,tohideobj,isexpanded;\n// grab all second level headlines and loop over them \n h2s=document.getElementsByTagName('h2');\n for (i=0;i&#60;h2s.length;i++)\n {\n// get next sibling (the element to hide, check that it is an element\n  tohide=h2s[i].nextSibling;\n  while(tohide.nodeType!=1)\n  {\n   tohide=tohide.nextSibling;\n  }\n  h2s[i].tohideobj=tohide;\n// add the hover function onmouseover and onmouseout \n  h2s[i].onmouseover=function(){hover(this,this.tohideobj,1);}\n  h2s[i].onmouseout=function(){hover(this,this.tohideobj,0);}\n// hide next element and add onclick event to the header to show and hide it\n  juggleClass(tohide,'hidden',1);\n  juggleClass(h2s[i],'normal',1);\n  h2s[i].onclick=function(){collapse(this,this.tohideobj);return false}\n }\n}\n// hover function, adds the hover colour \n// unless the headline is an active trigger\nfunction hover(o,ho,state)\n{\n if(checkClass(ho,'hidden'))\n {\n  if(state==1)\n  {\n   juggleClass(o,'normal',0);\n   juggleClass(o,'hover',1);\n  } else {\n   juggleClass(o,'normal',1);\n   juggleClass(o,'hover',0);\n  }\n }\n}\n// collapse function, shows and hides the element and sets the highlight \n// colour of the headline\nfunction collapse(o,ho)\n{\n if(checkClass(ho,'hidden'))\n {\n  juggleClass(ho,'hidden',0);\n  juggleClass(o,'normal',0);\n  juggleClass(o,'highlight',1);\n }else{\n  juggleClass(ho,'hidden',1);\n  juggleClass(o,'highlight',0);\n  juggleClass(o,'normal',1);\n }\n}\nfunction juggleClass(o,c,s)\n{\n o.className=s==1?o.className+' '+c:o.className.replace(' '+c,''); \n}\nfunction checkClass(o,c)\n{\n var isClassInObj=o.className.indexOf(c)!=-1?true:false;\n return isClassInObj;\n}\nwindow.onload=init;\n</pre>\n<p><a href="http://www.icant.co.uk/articleassets/h2test3.html" target="_blank">Works the same</a>, but now features a full separation of \nbehaviour and presentation. Storing the class names in global variables would \nalso enable us to change them easily.</p>\n<p>If we want to be independent of other Javascripts, we cannot use window.onload \nof course but should use a \n<a href="http://www.scottandrew.com/weblog/articles/cbs-events" target="_blank">more clever \nfunction</a> instead that adds our function to the overall window.onload.</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
