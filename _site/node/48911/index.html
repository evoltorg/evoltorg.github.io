<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Php Intro To Objects And Classes</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Php Intro To Objects And Classes</h2>
<p class="meta">27 Nov 2002</p>

<div class="post">
<p>PHP's Object Oriented capabilities may not be complete, but the benefits of \n  convenience and code re-use from using Objects and Classes are here now. If \n  you are already dabbling in PHP, but haven't yet checked out Classes, have a \n  look at this simple (yet useful) example of an Error Message Class.</p>\n<h2>Beginners Guide to Object Oriented Terminology</h2>\n<p>When I first came across <abbr title="Object Oriented Programming">OOP</abbr>, the terminology served as a barrier - partly \n  because the people explaining it were trying to stress what is different about \n  OOP, rather than saying what is the same. I was a tad disappointed when I discovered \n  that OOP was mainly a way of packaging existing good ideas and practices, but \n  cheered up when it transpired that a lot of languages now include OOP constructs \n  that make it much easier to code in this way.</p>\n<p>There are four terms that you should feel comfortable with: <em>Class, Object, \n  Property and Method</em>. </p>\n<p>A <em>Class</em> is a blueprint for creating an <em>Object</em>. It tells you what variables \n  (a.k.a. <em>Properties</em>) the <em>Object</em> can have, and what functions (a.k.a. <em>Methods</em>) \n  can be used to manipulate the <em>Object's</em> Properties.</p>\n<p>None the wiser? I don't pretend that the previous couple of sentences constitute \n  a proper definition of anything - but it was definitions that created the barrier \n  for me when I first looked at OOP. Don't get hung up on it - take a look at \n  this non-computing example:</p>\n<h3>A Real-World Example</h3>\n<p>Consider an old-fashioned radio, with an on/off switch, and a tuning dial.</p>\n<p>The <em>Class</em> is the circuit diagram and assembly instructions that enable the \n  worker to build the radio, and also the User Manual.</p>\n<p>Each and every such radio built is an <em>Object</em>.</p>\n<p>The <em>methods</em> would be something like:</p>\n<p><strong>Build Radio ( )<br>\n  Turn Radio On ( )<br>\n  Turn Radio Off ( )<br>\n  Tune Radio ( )<br></strong>\n</p>\n<p>The Properties might be:</p>\n<p><strong>serial_number</strong> - to uniquely identify the radio.<br>\n<strong>status</strong> - whether the radio is currently on or off.<br>\n<strong>current frequency</strong> - to which the radio is tuned.<br>\n</p>\n<p>Every Object has the same methods available. Every Object has values for the \n  same Properties - but these values may be different. Indeed in our radio example, \n  the serial number should always be different.<br>\n</p>\n<p>Still none the wiser? Well try working through the following example, and see \n  if things click into place.</p>\n<h2>A Problem to Solve</h2></p><p><p>If you have any complexity at all in your PHP pages, then you will most likely \n  have run into this irritating little scenario: You have just found a database \n  error perhaps, or a user input error, but you cannot immediately output an error \n  message. What do you do? Set a flag and check it later on when you are ready \n  to show the error message? OK, that should work. Might get a bit messy if you \n  find a lot of errors. You could stick all the error messages in an array, then \n  print out the array when you are ready. Yeah, that sounds good. Lets do that \n  - but lets do it using a Class, which we will call ErrorMessages.</p>\n<h2>So What Does This Class Need to Look Like?</h2>\n<p>Well what do we want to do with it? Let me suggest the following:</p>\n<p>We want to be able to identify errors and store error messages for outputting \n  later, when we are ready.</p>\n<p>We might have different types of errors - e.g. System errors such as unavailable \n  databases, or User errors such as invalid data put in input fields on forms. \n  It would be nice to report these separately.</p>\n<p>The output should fit in with the look and feel of the rest of the website.</p>\n<p>No doubt you are already concocting more complicated requirements, but lets \n  leave it at that for the purposes of this article. What you do in the privacy \n  of your own room is up to you.</p>\n<p>Right then. That doesn't look too complicated. Seems to me like we want three \n  Methods here. One to create a bucket which we can keep error messages in. Another \n  to drop an error message into the bucket, and a final one to tip all the error \n  messages out of the bucket and onto the screen.</p>\n<p>I'm anticipating output that will look something like this:</p>\n<p>*** System Errors ***<br>\n  1. Missing Table - could not locate database table 'awol'.<br>\n  2. Database error - no such column 'fifth' in table 'usa'.</p>\n<p>If we stick a few [CSS] class names in the HTML tags that we output, then we \n  should be able to use a stylesheet to format the output to fit in with whatever \n  site we use it on.</p>\n<h2>The Class Framework</h2>\n<p>It ain't obligatory, but most PHP developers put their classes in separate \n  files that they can include in whichever pages it is needed. You can put as \n  many Classes as you like inside one include file, but for this example we will \n  just have the one.</p>\n<p>OK - so create a new file to use as an include: say error_class.inc. </p>\n<p>Open the include file and type in:</p>\n<pre>\n&lt;?php\nclass ErrorMessages\n{</p><p>}\n?&gt;\n</pre>\n<p>This is just the framework that tells PHP that it is dealing with a Class definition.</p>\n<p>Now we need to tell PHP what the variables are that we may choose to populate \n  for each Object. Now what was it that they were called again? Properties. OK, \n  between the curly wurlies, add this:</p>\n<pre>\n  var $errorMsgBlockLabel;\n  var $errorCount;\n  var $errorMsg;\n</pre>\n<p>$errorMsgBlockLabel is the 'title' that we will show on the screen above the \n  errors that have occured.</p>\n<p>$errorCount is just going to keep track of the number of errors. </p>\n<p>$errorMsg is going to be an array of errors that have occured. Each array element \n  will itself be an array (containing a label and a message) but we don't need \n  to be that specific at this stage.</p>\n<h3>The Constructor</h3>\n<p>We now need to add the only Method that a Class MUST have. It has the same \n  name as the Class itself (in this case ErrorMessages) and is refered to as the \n  'Constructor'. This Method will do whatever is necessary to create a new instance \n  of an ErrorMessages Object.</p>\n<p>So what do we need to do to create our new Object? Not a lot, really. We need \n  to give it a 'title' (i.e. specify a value for $errorMsgBlockLabel) and initialise \n  the $errorCount to 0. </p>\n<p>OK - so after your var definitions, before the final curlie wurlie, insert \n  this Constructor function:</p>\n<pre>\nfunction ErrorMessages($x)\n{\n  $this-&gt;errorCount = 0;\n  $this-&gt;errorMsgBlockLabel = $x;\n}\n</pre>\n<p>$x, rather obviously, is the 'title' string, which we will pass when we request \n  a new ErrorMessages Object.</p>\n<h3>$this</h3>\n<p>Whats all this <code>$this-&gt;errorCount</code> business? </p>\n<p>In normal PHP you would refer to a variable as something like <code>$errorCount</code>, \n  and a function as something like <code>addError($label,$message)</code>. </p>\n<p>When we are dealing with Properties and Methods we must use a slightly different \n  notation. e.g. <code>$SysErrs-&gt;errorCount</code> and <code>$SysErrs-&gt;addError($label,$message)</code> \n  where $SysErrs is the name of the Object that we are interested in.</p>\n<p>Inside the Class definition we have absolutely no idea what the Objects based \n  on this Class are going to be called, so we use the special pseudo-variable \n  <code>$this</code> to mean the current Object. It just allows us to use a similar notation \n  inside and outside the Class definition.</p>\n<p>The exception to this <code>object name-&gt;method name( )</code> rule \n  is the Constructor. When we want to create a new Object we use the following \n  syntax:</p>\n<p><code>object name = new class name&(<em>params</em>)</code></p>\n<p>e.g. <code>$UserErrs = new ErrorMessages("User Bloopers");</code></p>\n<h3>Can't wait to use your class?</h3>\n<p>Create a php file - say 'error_class_test.php'. I'll assume you create it in \n  the same directory as the include file. Type this in:</p>\n<pre>\n&lt;?php\ninclude (&quot;error_class.inc&quot;);\n$UserErrs = new ErrorMessages(&quot;User Bloopers&quot;);\necho (&quot;&lt;P&gt;We have $UserErrs-&gt;errorCount user errors&lt;/P&gt;&quot;);\n?&gt;\n</pre>\n<p>Load up both files to your webserver, then run the php file. It should just \n  say &quot;We have 0 user errors&quot;.</p>\n<p>Not very exciting, but as it stands that is the limit of our Classes functionality. \n  Lets change that.</p>\n<h2>Now some Methods</h2>\n<p>First, a method to add an error message. Immediately after the Constructor, \n  before the last curlie wurlie, add this:</p>\n<pre>\nfunction addError($label, $message)\n{\n  $this-&gt;errorCount ++;\n  $this-&gt;errorMsg[$this->errorCount][&quot;label&quot;] = $label;\n  $this-&gt;errorMsg[$this->errorCount][&quot;message&quot;] = $message;\n}\n</pre>\n<p>This Method increments the errorCount, then creates an element errorMsg[n] \n  where [n] is the current errorCount. This element is itself an associative array \n  (&quot;label&quot; =&gt; $label , "message" =&gt; $message).</p>\n<p>Now we can add an error, e.g.</p>\n<p><code>$UserErrs-&gt;addError(&quot;Dodgy Input&quot;,&quot;This does not appear \n  to be a valid email address&quot;);</code></p>\n<p>and we could even show that error using something like <code>print_r</code> - but even if \n  we remembered to put <code>&lt;pre&gt;&lt;/pre&gt;</code> tags around it, that \n  would still look naff. No, we definitely need a Method to output these error \n  messages in a decent format. So add this immediately before the last curlie \n  wurlie:</p>\n<pre>\nfunction showErrors()\n{\n  if ($this-&gt;errorCount &gt;0) {\n    ?&gt;\n    &lt;div class=&quot;errorblock&quot;&gt;\n    &lt;span class=&quot;errorblocklabel&quot;&gt;&lt;?php echo $this-&gt;errorMsgBlockLabel ?&gt;&lt;/span&gt;\n    &lt;?php\n    for ( $i = 1; $i &lt;= $this-&gt;errorCount; $i++ ) {\n      ?&gt;\n      &lt;p&gt;\n      &lt;span class=&quot;errornumber&quot;&gt;&lt;?php	echo &quot;$i:&quot;?&gt;&lt;/span&gt;\n      &lt;span class=&quot;errorlabel&quot;&gt;&lt;?php echo $this-&gt;errorMsg[$i][&quot;label&quot;] . &quot; - &quot; ?&gt;&lt;/span&gt;\n      &lt;span class=&quot;errormessage&quot;&gt;&lt;?php echo $this-&gt;errorMsg[$i][&quot;message&quot;] ?&gt;&lt;/span&gt;\n      &lt;/p&gt;\n      &lt;?php\n    }\n    ?&gt;\n    &lt;/div&gt;\n    &lt;?php\n  }\n}	\n</pre>\n<p>Nothing too tricky here. The <code>if</code> statement ensures we only get any output \n  if we have any errors. Then we print out the label for the block of errors, \n  and then loop through each error.</p>\n<p>To test it, you can add a couple of lines to your php file, so it looks like \n  this:</p>\n<pre> \n&lt;?php\ninclude (&quot;error_class.inc&quot;);\n$UserErrs = new ErrorMessages(&quot;User Bloopers&quot;);\n$UserErrs-&gt;addError(&quot;Invalid Input&quot;,&quot;This does not appear to be a valid email address&quot;);\n$UserErrs-&gt;addError(&quot;Careless&quot;,&quot;You appear to have forgotten something.&quot;);\n$UserErrs-&gt;showErrors();\necho (&quot;&lt;P&gt;We have $UserErrs->errorCount user errors&lt;/P&gt;&quot;);\n?&gt; \n</pre>\n<h2>Eye Candy</h2>\n<p>OK so far? But it doesn't look very nice. We could just put a bit of formatting \n  into the showErrors() function - but being a CSS fan, I reckon its better to \n  use styles. I'm not going to explain it, 'cos this article is about Classes \n  not CSS.</p>\n<p>Stick the following stylesheet in (right at the start of your php file, before \n  the opening php tag). It should really go in the &lt;head&gt; section - but \n  if you've been following the instructions you won't have one!</p>\n<pre>&lt;style type=&quot;text/css&quot;&gt;\n.errorblock {\n	border: 1px solid #900 ;\n	margin-bottom: 5px; \n	margin-top: 5px; \n	font-size: 10pts; \n	background: #fee;\n	}\n.errornumber {\n	background: #fff; \n	color: #900;\n	padding-left: 3px; \n	padding-right: 1px; \n	border: 1px solid #900 ;\n	}\n.errorlabel {\n	font-weight: bold; \n	color: #900;\n	padding-left: 3px; \n	}\n.errormessage {\n	color: #090;\n	}\n.errorblock p {\n	display: block;\n	padding: 3px; \n	margin-bottom: 0; \n	margin-top: 0; \n	padding-top: 2px; \n	padding-bottom: 2px;\n	}\n.errorblocklabel {\n	display: block;\n	padding: 3px; \n	background: #900;\n	font-weight: bold; \n	font-size: 12pts; \n	color: #fff;\n	}\n&lt;/style&gt;\n</pre>\n<h2>Did I mention Re-usability?</h2>\n<p>Well if I didn't, shame on me. I'm certainly not going to claim that Classes \n  are the only way of writing reusable code - but they certainly make it an attractive \n  proposition.</p>\n<p>Suppose we might encounter System errors and/or User Errors while running our \n  PHP code. We might not want to lump all our errors in together. No problem. \n  Instead of just creating one ErrorMessages Object, we can create as many as \n  we want (but two will do for us). </p>\n<p>Add a few extra lines to the php part of your .php page, so it looks like this:</p>\n<pre>&lt;style type=&quot;text/css&quot;&gt;\n... snip ...\n&lt;/style&gt;\n&lt;?php\ninclude (&quot;error_class.inc&quot;);\n$UserErrs = new ErrorMessages(&quot;User Bloopers&quot;);\n$SysErrs = new ErrorMessages(&quot;*** System Errors ***&quot;);</p><p>$UserErrs-&gt;addError(&quot;Invalid Input&quot;,&quot;This does not appear to be a valid email address&quot;);\n$UserErrs-&gt;addError(&quot;Careless&quot;,&quot;You appear to have forgotten something.&quot;);\n$SysErrs-&gt;addError(&quot;Missing Table&quot;,&quot;could not locate database table 'awol'&quot;);\n$SysErrs-&gt;addError(&quot;Database error&quot;,&quot;no such column 'fifth' in table 'usa'.&quot;);</p><p>$UserErrs-&gt;showErrors();\n$SysErrs-&gt;showErrors();</p><p>echo (&quot;&lt;P&gt;We have $UserErrs-&gt;errorCount user errors&lt;/P&gt;&quot;);\necho (&quot;&lt;P&gt;We have $SysErrs-&gt;errorCount system errors&lt;/P&gt;&quot;);\n?&gt; \n</pre>\n<p>Stick that on your server and give it a whirl. </p>\n<p>Neat?</p>\n<p>But the real re-use comes when you use the Class in another project. All you \n  need to do is copy the Class definition include file and include it wherever \n  you need it.</p>\n<h2>Using our Objects within Functions and other Objects</h2>\n<p>Right then, but what if you already have lots of functions or even other Classes, \n  within which you might generate error messages? Can you still use the ErrorMessages \n  Class?</p>\n<p>Of course. The Object you create can be treated much like a variable. If you \n  want to use it in a function (or Method in another Class) you can declare it \n  as global. Note that it is the Object not the Class that is declared as global \n  - so you must know its name. e.g.</p>\n<pre>\nfunction fooBar() {\n  global $SysErrs;\n  ... do something that goes wrong ...\n  if (error has occured) {\n    $SysErrs-&gt;addError(&quot;Woopsie&quot;,&quot;Function fooBar failed&quot;);\n  }\n}\n</pre>\n<p>But what would happen if you hadn't already created the $SysErrs Object? You \n  would get an error. Ironic really.</p>\n<p>What can you do about it? Test for the existence of the Object. If it exists, \n  fine. If not, handle it some other way - maybe by creating the object - but \n  you can only do that if the Class definition itself exists.</p>\n<p>So we have a few conditions to test for before we know exactly how we are going \n  to deal with our error. How you deal with each failure depends on your situation, \n  and the anticipated situations where your code might be used. So I'll just give \n  you the syntax for checking whether the ErrorMessages Class exists: </p>\n<p> <code>if (class_exists(&quot;ErrorMessages&quot;)) { ..... }</code></p>\n<p>and for checking if the Object $SysErrs exists:</p>\n<p><code>if($SysErrs) { ..... }</code></p>\n<p>If the Class doesn't exist, then you could include the Class definition file \n  - as long as you are sure where it is!</p>\n<p>If the Object doesn't exist, then you could create it, or you could cop out \n  and handle the error some other way.</p>\n<p>Of course - if you create an ErrorMessages Object, you would be wasting your \n  time if the showErrors() method was never called for that Object. Crikey, in \n  my crystal ball I can see a routine that looks through all the Objects in your \n  script, and calls showErrors() for every Object with a Class of ErrorMessages. \n  Stop now, I've woffled enough.</p>\n<h2>Possible advantages of Classes over Procedural Code</h2>\n<p>Treading very carefully now, as some folks seem awfully touchy about this. \n  The scribblings that follow are definitely IMHO. So please don't give me a kicking. \n  And if you must give me a kicking, then please, not the face - not the face!</p>\n<p>Nothing in this example could not be done with a set of functions in an include \n  file. Hey, it is an easy example, because it gets hard to write articles when \n  the examples are big and complex.</p>\n<p>Quite probably, even with big, complex Classes, you could still do everything \n  with a set of functions instead.</p>\n<p>So why do I like Classes?</p>\n<p>Keeping variables as Object Properties saves you from having to use global \n  variables. Good for security. It also avoids accidentally using the same variable \n  across two different sets of functions.</p>\n<p>All Object Properties are available to all functions (a.k.a. Methods) within \n  the Class. So you are not having to specify lots of variables as global within \n  each function, or pass them in as parameters.</p>\n<p>Class definitions make me keep everything to do with the Class in one place. \n  With collections of functions it is easier to write code that is harder to maintain.</p>\n<p>Just thinking in terms of Classes, Properties and Methods seems to help get \n  my mind around the problem.</p>\n<p>If you are using Sessions, by registering the Object with the Session, all \n  the Object's Properties are automatically serialized, stored in the session \n  and then unserialized for you on the next page. Handy.</p>\n<h2>Want to know more?</h2>\n<p>Here is a list of useful <a href="http://www.faqts.com/knowledge_base/view.phtml/aid/7569/fid/39" target="_blank" title="Useful links to find out more about PHP Classes and Objects">links</a>. \n  Enjoy.</p>\n<h2>Feeling Lazy?</h2>\n<p>Personally, I often get benefit from actually typing things in - particularly \n  when dealing with some new notation such as that used by PHP for classes and \n  objects. If that doesn't float your boat, here is a <a href="http://www.wolfridge.co.uk/evolt/error_class.zip" title="Zipfile containing the 2 files in this article">zip \n  file</a> with the class definition and the test page.</p>\n<p>Even less effort would be to look at the <a href="http://www.wolfridge.co.uk/evolt/error_class_demo.htm" target="_blank" title="A demo of the error class">demo \n  page</a>.</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
