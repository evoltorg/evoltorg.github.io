<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Asp Application Level Html Caching</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Asp Application Level Html Caching</h2>
<p class="meta">11 Dec 1999</p>

<div class="post">
<p>\nToday, I received this email in my otherwise barren Inbox:\n</p></p><p><blockquote>\n<i>Hey I saw this post and thought "this could work on my site". \nBasically I have an ASP which queries an Access database.. but this wouldn't change much. How can I implement this into my page? The design will stay the same.. </i>\n</blockquote></p><p><p>\nMy original post was why a certain list member shouldn't rule out ASP and CF. Chris was responding to my comments about ASP. The following was my reply to him:\n</p></p><p><blockquote>\nWell, Chris, you'll probably find it quite trivial and redundant work, but to prepare your scripts to be able to use Application-level page caching, you should convert all <code>Response.Write</code>'s to variable stuffs. For instance:\n</blockquote></p><p> <pre>\n Response.Write &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;&quot;\n Response.Write &quot;&lt;body bgcolor=&quot;&quot;#ffffff&quot;&quot; text=&quot;&quot;#000000&quot;&quot; link=&quot;&quot;#0000ff&quot;&quot;&gt;&quot;\n Response.Write &quot;&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;&quot;\n Response.Write &quot;&lt;/body&gt;&quot;\n Response.Write &quot;&lt;/html&gt;&quot;\n </pre></p><p> <blockquote>\nWould need to become...\n</blockquote></p><p><pre>\n Dim HTML  'As String\n HTML = "&lt;html&gt;"\n HTML = HTML & "&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;"\n HTML = HTML & "&lt;body bgcolor=""#ffffff"" text=""#000000"" link=""#0000ff""&gt;"\n HTML = HTML & "&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;"\n HTML = HTML & "&lt;/body&gt;&lt;/html&gt;"\n Response.Write HTML\n </pre></p><p><blockquote>\nThese two code snipplets do EXACTLY the same thing. Note that the latter is also quicker and less resource intensive because you are only writing to the response object once, rather than multiple times. So, to set up the actual page caching, you would use this code:\n</blockquote> </p><p><pre>\n &lt;%\n Dim thisPageID, thisPageHTML\n  ' find the value o thisPageID\n  ' this will have to correspond with the naming convension you choose\n \n  ' stuff the value of Application(thisPageID) into a variable\n  ' because otherwise, you will be accessing it multiple times\n  ' which is unnecessarily resource intensive\n thisPageHTML = Application(thisPageID)\n \n IF NOT thisPageHTML=&quot;&quot; THEN\n     Response.Write thisPageHTML\n ELSE\n     HTML = &quot;&lt;html&gt;&quot;\n     HTML = HTML & &quot;&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;&quot;\n     HTML = HTML & &quot;&lt;body bgcolor=&quot;&quot;#ffffff&quot;&quot; text=&quot;&quot;#000000&quot;&quot; link=&quot;&quot;#0000ff&quot;&quot;&gt;&quot;\n     HTML = HTML & &quot;&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;&quot;\n     HTML = HTML & &quot;&lt;/body&gt;&lt;/html&gt;&quot;\n     Response.Write HTML\n     Application(thisPageID) = HTML\n END IF\n %&gt;\n </pre></p><p><blockquote>\nOf course, stick you access query(ies) in anywhere you want.\n</blockquote></p><p><blockquote>\nNow, all you have to do is force a reconstruction of the page whenever the database is modified.\n</blockquote></p><p><blockquote>\nI've found that the best way to do this is to create a function/sub called <code>ResetVars()</code> or whatever in an include file and include it on all pages. This file will hold all the page caching variables and code for setting them to "". Then, when you update the database, just call <code>ResetVars()</code>. Make sure that you keep this file updated, though.\n</blockquote></p><p><blockquote>\nWell, say that you need to use <code>Response.Flush</code> some time to let the user know that the page hasn't just hung up. Just change the HTML <code>var</code> segment to this:\n</blockquote> </p><p> <pre>\n Dim HTML  'As String\n HTML = &quot;&lt;html&gt;&quot;\n HTML = HTML & &quot;&lt;head&gt;&lt;title&gt;My Cool Access Query Page&lt;/title&gt;&lt;/head&gt;&quot;\n HTML = HTML & &quot;&lt;body bgcolor=&quot;&quot;#ffffff&quot;&quot; text=&quot;&quot;#000000&quot;&quot; link=&quot;&quot;#0000ff&quot;&quot;&gt;&quot;\n Response.Write HTML\n Response.Flush\n HTML2 = HTML2 & &quot;&lt;p&gt;Hello, welcome to my cool Access query page!&lt;/p&gt;&quot;\n HTML2 = HTML2 & &quot;&lt;/body&gt;&lt;/html&gt;&quot;\n Response.Write HTML2\n Application(thisPageID) = HTML & HTML2\n </pre></p><p><blockquote>\nGet the idea? Hope this has cleared things up. Let me know if it hasn't.\n</blockquote></p><p><p>\nNow, what I neglected to mention to Chris is that you can also cache certain things that will almost never change. How many of you have an ASP script which populates a select box with state names? Hmmmm... how often have you had to update the database for this state box? Well, then. Store it in an application-level variable. Best thing is that this can be used for <strong>all</strong> ASP pages (in that Application scope) that need it. Think about it <br> Contact: <a href="mailto:evolt_article@mattwarden.com">evolt_article@mattwarden.com</a>\n</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
