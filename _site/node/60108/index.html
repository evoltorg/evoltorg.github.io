<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Socket Programming In Perl</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Socket Programming In Perl</h2>
<p class="meta">20 Apr 2003</p>

<div class="post">
<br>Using sockets in Perl, it is possible to communicate to a server using a client program. Here, I will explain how using sockets a client program can communicate to a server. The client program is run at the client-side while the server program runs in the Internet. For testing the program, you can run it on a local server.\n<br>\n<br>For this example, I will use the IO::Socket::INET Perl module which is included with most Perl distributions. If you don't have the module, get it from <a href="http://www.cpan.org/modules/index.html" target="_blank">http://www.cpan.org/modules/index.html</a>.\n<br>We will use the User Datagram Protocol (UDP) to connect to the server. The module also supports the TCP protocol.\n<br>\n<br><b>Client Program :</b>\n<br>\n<br>First of all we need to create the socket. The socket is created easily by initializing a new instance of the IO::Socket::INET object like this :\n<br>\n<pre>\nuse IO::Socket::INET;\n$MySocket=new IO::Socket::INET-&gt;new(PeerPort=&gt;1234,\n        Proto=&gt;'udp',\n        PeerAddr=&gt;'localhost');\n</pre>\nMySocket, thus inherits all the properties and methods of the IO::Socket::INET object.\n<br>The various key-value pairs we have passed to the newly created object are as follows :\n<ul>\n	<li>PeerPort = 1234; The PeerPort can be a number or symbolic service name.</li>\n	<li>Proto = 'udp'; We use the UDP protocol. The TCP protocol is also supported. If Proto is not provided, it will try to derive it from the service name (PeerPort). If this fails, 'tcp' is assumed as the Proto.</li>\n	<li>PeerAddr = 'localhost'. The PeerAddr can be a host name or an IP address. Here we are tesing the programs locally so we have used 'localhost'. If the server program is running in the Internet then you must use it's IP address or domain name.</li>\n</ul>\nApart from the key-value pairs we have passed, there are many other parameters that can be passed to the object. We are not concerned of them here. You can find details of accepted key-value pairs in the module's documentation.\n<br>\n<br>Now that we have created the socket, we can now send a message to the server using the object's send() method :\n<br>\n<pre>\n$msg="This is the message";\n$MySocket-&gt;send($msg);\n</pre>\nThus we have created the client program. Now let us create the server program, that will display the messages that the client has sent.\n<br>\n<br><b>Server Program :</b>\n<br>\n<br>In the server program also, we create the socket in a similar manner :\n<br>\n<pre>\nuse IO::Socket::INET;\n$MySocket=new IO::Socket::INET-&gt;new(LocalPort=&gt;1234,\n        Proto=&gt;'udp')\n</pre>\nNotice that in the server program we have passed only two key-value pairs :\n<ul>\n	<li>LocalPort = 1234; this is the local host bind port and should be same as the PeerPort value passed in the client program.</li>\n	<li>Proto = 'udp'; Protocol used in communication with client, it should be same as the Proto value passed in the client program.</li>\n</ul>\nNow after creating the socket, we can now receive messages sent by the client using the object's recv() method :\n<br>\n<pre>\n$MySocket-&gt;recv($text,128);\nprint "\nReceived message '", $text,"'\n";\n</pre>\nHere the first argument passed to the recv() method must be '$text', the second argument passed indicates the maximum number of bytes the server should receive.\n<br>After receiving the message, it can be easily displayed using the $text variable.\n<br>\n<br>Thus we have created the server program. Now the client can communicate with server using a socket. Note that for the server to receive messages from the client, it (the server) should be running while the message is being sent by the client.\n<br>\n<br><b>Client program code :</b>\n<br>\n<pre>\n# Client Program\nuse IO::Socket::INET;\nprint "&gt;&gt; Client Program &lt;&lt;";</p><p># Create a new socket\n$MySocket=new IO::Socket::INET-&gt;new(PeerPort=&gt;1234,Proto=&gt;'udp',PeerAddr=&gt;'localhost');</p><p># Send messages\n$def_msg="Enter message to send to server : ";\nprint "\n",$def_msg;\nwhile($msg=&lt;STDIN&gt;)\n{\n	chomp $msg;\n	if($msg ne '')\n	{\n		print "\nSending message '",$msg,"'";\n		if($MySocket-&gt;send($msg))\n		{\n			print ".....&lt;done&gt;","\n";\n			print $def_msg;\n		}\n	}\n	else\n	{\n		# Send an empty message to server and exit\n		$MySocket-&gt;send('');\n		exit 1;\n	}\n}\n</pre>\nWe have refined the client program so that it accept inputs from the keyboard which is transmitted to the server. A double return (pressing enter/return twice) will exit the client program.\n<br>\n<br><b>Server program code :</b>\n<br>\n<pre>\n# Server Program\nuse IO::Socket::INET;\nprint "&gt;&gt; Server Program &lt;&lt;\n";</p><p># Create a new socket\n$MySocket=new IO::Socket::INET-&gt;new(LocalPort=&gt;1234,Proto=&gt;'udp');</p><p># Keep receiving messages from client\n$def_msg="\nReceiving message from client.....\n";\nwhile(1)\n{\n	$MySocket-&gt;recv($text,128);\n	if($text ne '')\n	{\n		print "\nReceived message '", $text,"'\n";\n	}\n	# If client message is empty exit\n	else\n	{\n		print "Cilent has exited!";\n		exit 1;\n	}\n}\n</pre>\nWe have refined the server program so that as and when the client sends a message, the server keeps displaying it. When the client sends a blank message, the server program terminates.\n<br>\n<br>Thus we have learned how to communicate to a server from a client using sockets.\n<br>\n<br><b>&#169; 2002 <a href="http://premshree.resource-locator.com/cgi-bin/contact.pl"><font color="#3366CC">Premshree Pillai</font></a>.
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
