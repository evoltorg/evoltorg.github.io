<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>An Explorer Script With No Need For Id</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>An Explorer Script With No Need For Id</h2>
<p class="meta">16 Oct 2003</p>

<div class="post">
<p>From the emails I got after publishing the \n<a href="http://www.evolt.org/collapsible_page_elements/" \ntitle="Collapsible page elements with DOM" target="_blank">collapsible page elements</a> article\nI realised that what the world needs now (apart from love, sweet love) is a \nclean explorer-like collapsing and expanding nested list script.</p> \n<p>Check <a href="http://www.onlinetools.org/puredom/example1.html" \ntarget="_blank" title="example of a dynamic explorer navigation">this example \npage</a> to see what we are talking about.</p>\n<p>If you <a href="http://www.google.com/search?hl=en&lr=&ie=UTF-8&oe=UTF-8&q=dynamic+explorer+menu+script" target="_blank" title="google search for dynamic explorer scripts">google</a> for these you \nfind a lot, and most likely all of them fail in one way or another. They might \nbe browser dependent, need horrid markup, are not backward compatible, whatever, \nfor some reason most will just not do.</p>\n<p>So let's see how we can do it better...</p>\n<h2>Step one: collect underwear</h2>\n<p>Without a solid foundation, a house shows cracks (mine does), and without a \nsolid HTML markup to enhance, a script is likely to fail.</p>\n<p>That is why the HTML to be turned into the fancy collapse and expand script \nshould be a HTML list. If you haven't heard about the merits of navigations\nas lists yet, read the ravings on <a href="http://www.listamatic.com/about-why.htm" \ntarget="_blank" title="why lists are a good markup idea for navigations">listamatic</a>.</p>\n<p>This is what it might look like:</p>\n<pre>\n&#60;ul&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link1&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2&#60;/a&#62;\n  &#60;ul&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_1&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_2&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_3&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_4&#60;/a&#62;&#60;/li&#62;\n  &#60;/ul&#62;\n &#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link3&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link4&#60;/a&#62;&#60;/li&#62;\n&#60;/ul&#62;\n</pre>\n<p>And we want to be able to nest as many levels as necessary.</p>\n<h3>Ponderings: script or no script?</h3>\n<p>You don't necessarily need Javascript to achieve the functionality of a\nfile explorer menu, you could use CSS and some clever :hover statements.</p>\n<p>However collapsing and expanding an explorer menu when you touch it with a \nmouse means you need neurosurgical skills to navigate into nested items.</p>\n<p>Furthermore you cannot keep the nested items visible once you move away from \nthe link.</p>\n<p>Hence, no CSS for us this time, let's do a Javascript instead.</p>\n<p>Let us also focus on accessibility and &#34;graceful degradation&#34;.\nPeople with the inability to use a mouse should be able to use the script with \nthe keyboard. People without Javascript should see the menu as a totally expanded \nlist without bells and whistles.</p>\n<p>Mouse independence is easy: Simply add an &#34;onkeypress&#34; event handler\nto each link you enhanced with your &#34;onclick&#34; one.</p>\n<p>This is common practise and a <a href="http://www.w3.org/WAI/wcag-curric/sam70-0.htm" \ntitle="information about event handlers and accessibility">recommendation by the \nW3C Web Accessibility Initiative(WAI)</a>.</p>\n<p>Some browsers (like some builds of Mozilla and IE on mac) have problems with\nthe keyboard implementation, but it is not our job to work around them. Keyboard\nusers that need to use it won't use these browsers anyway.</p>\n<p>There are loads of ways to collapse and expand elements on a page, let's take\na peek at a common one.</p></p><p><h2>Hey, I got an ID</h2>\n<p>Collapsing nested elements is easy, once you give them an ID.</p>\n<p>Let's create one of these solutions, and, as this is not the real thing, \nwe won't worry about the onkeypress for the moment.</p>\n<pre>\n&#60;ul&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link1&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;\n onclick=&#34;d=document.getElementById('nest1');d.style.display=d.style.display=='none'?'block':'none'; return false&#34;&#62;Link2&#60;/a&#62;\n  &#60;ul id=&#34;nest1&#34; style=&#34;display:none&#34;&#62; \n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_1&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_2&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_3&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_4&#60;/a&#62;&#60;/li&#62;\n  &#60;/ul&#62;\n &#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link3&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link4&#60;/a&#62;&#60;/li&#62;\n&#60;/ul&#62;\n</pre>\n<p>Does the job, but is dependent on too many things. First of all you need an \nID for each nested element, and that could interfere with existing IDs (whoever \ndid an ASP.NET project and has seen its way of deliberately scattering obscure IDs \nall over the document will have faced that problem). Secondly, if I turn\noff Javascript, the nested element is hidden (unless I also turn off CSS). </p>\n<p>What we need to do is to find a function that checks for us \nif there is something to collapse and does so if it exists. And that without \nknowing its name (ID in this case).</p>\n<h2>Forget me node</h2>\n<p>The answer: DOM. This handy thing (Document Object Model) allows you to \nnavigate through your HTML document and access each bit of it. This can be done\nvia ID or tag name. And tag name is what we will use here.</p>\n<pre>\n&#60;ul&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link1&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34; \n onclick=&#34;d=this.parentNode.getElementsByTagName('ul')[0];d.style.display=d.style.display=='none'?'block':'none';\n return false&#34;&#62;Link2&#60;/a&#62;\n  &#60;ul style=&#34;display:none&#34;&#62; \n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_1&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_2&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_3&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_4&#60;/a&#62;&#60;/li&#62;\n  &#60;/ul&#62;\n &#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link3&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link4&#60;/a&#62;&#60;/li&#62;\n&#60;/ul&#62;\n</pre>\n<p>What?</p>\n<p>Ok, let's go through this one bit by bit:</p>\n<p><code>d.style.display=='none'?'block':'none';return false"</code> is the same\nas above, we take an object(d) and check its display value. If that value is none, we set it \nto block and vice versa.</p>\n<p>More challenging is the first part, <code>d=this.parentNode.getElementsByTagName('ul')[0];</code>, \nespecially when you haven't used DOM before, or anything that also works with \ntraversing through node trees (XSLT for example).</p>\n<p>We define d, and it is defined as something starting from &#34;this&#34;. &#34;this&#34;\nis handy, as it always is what we clicked on. In our case, &#34;this&#34; is \nthe link element with the text &#34;Link2&#34; in it.</p>\n<p>&#34;parentNode&#34; is the node our link is in, in our case the LI element. If we\nhad nested the link in a STRONG tag, that would be parentNode. This DOM variable always \ngets the parent element of the one we are dealing with. (Much like a &#34;cd ..&#34; command gets \nyou up one level in DOS or on a unix bash).</p>\n<p>Now that we are at the LI level, we get all the UL elements nested in it via\n<code>getElementsByTagName('ul')</code> and choose the first one \n<code>getElementsByTagName('ul')[0]</code> (computers start counting at 0, not 1, most\nprobably because they don't have any fingers).</p>\n<p>Now all we need to make this work for every link on the page,\nis to check for our &#34;d&#34; before we tell the browser to change its display value.</p>\n<p>Let's create the fully reusable function that also checks if our browser can \ndo what we want it to do:</p>\n<pre>\n&#60;script type=&#34;text/javascript&#34;&#62;\nif (document.getElementById &#38;&#38; \ndocument.createTextNode &#38;&#38; document.createElement){canDOM=true}\nfunction ex(n){\n if(canDOM){\n  u=n.parentNode.getElementsByTagName('ul')[0];\n  if(u){u.style.display=(u.style.display=='none'  u.style.display=='')?'block':'none';}\n }\n}\n&#60;/script&#62;\n&#60;ul&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link1&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34; onclick=&#34;ex(this);return false;&#34; \n onkeypress=&#34;ex(this);return false;&#34;&#62;Link2&#60;/a&#62;\n  &#60;ul style=&#34;display:none&#34;&#62; \n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_1&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_2&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_3&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_4&#60;/a&#62;&#60;/li&#62;\n  &#60;/ul&#62;\n &#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link3&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link4&#60;/a&#62;&#60;/li&#62;\n&#60;/ul&#62;\n</pre>\n<h2>Gotta hide 'em all</h2>\n<p>Ok, that still leaves the non Javascript users with CSS enabled with a collapsed\nlist though. We need to find a way to collapse all nested ULs in the document. \ngetElementsByTagName helps us there.</p>\n<pre>\n&#60;script type=&#34;text/javascript&#34;&#62;\nfunction expinit(){\n if (canDOM){\n  alluls=document.getElementsByTagName('UL');\n  for(i=0;i&#60;alluls.length;i++){\n   subul=alluls[i];\n   if(subul.parentNode.tagName=='LI'){\n    subul.style.display='none';\n   }\n  }\n }\n}\nwindow.onload=expinit;\n&#60;/script&#62;\n&#60;ul&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link1&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34; onclick=&#34;ex(this);return false;&#34; \n onkeypress=&#34;ex(this);return false;&#34;&#62;Link2&#60;/a&#62;\n  &#60;ul&#62; \n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_1&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_2&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_3&#60;/a&#62;&#60;/li&#62;\n   &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link2_4&#60;/a&#62;&#60;/li&#62;\n  &#60;/ul&#62;\n &#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link3&#60;/a&#62;&#60;/li&#62;\n &#60;li&#62;&#60;a href=&#34;#&#34;&#62;Link4&#60;/a&#62;&#60;/li&#62;\n&#60;/ul&#62;\n</pre>\n<p>We check if the browser supports DOM, then we get all the UL objects in the \ndocument and store them in an array called &#34;alluls&#34;. We then loop \nthrough this array, and check if the parentNode of the UL we are currently \nlooking at is an LI (which defines a nested UL). If this is the case, we \nset the display of the UL to none. We call this script when the document is \nloaded and, hey, all nested lists get hidden.</p>\n<p>Two more problems though: First, all nested lists get hidden, and second, how\ndo I know that some of the links have sub elements and some not?</p>\n<h2>Indicate left, take over</h2>\n<p>We want an indicator left of the link that tells us that there is something to \nexpand, and we want only lists in LIs with links in them to be hidden.</p>\n<pre>\n&#60;script type=&#34;text/javascript&#34;&#62;\nfunction expinit(){\n if (canDOM){\n  alluls=document.getElementsByTagName('UL');\n  for(i=0;i&#60;alluls.length;i++){\n   subul=alluls[i];\n   if(subul.parentNode.tagName=='LI'){\n    mom=subul.parentNode.getElementsByTagName('A')[0]\n    if(mom){\n     momlink=mom.childNodes[0];\n     momlink.nodeValue='+'+momlink.nodeValue;\n     subul.style.display='none';\n    }\n   }\n  }\n }\n}\nwindow.onload=expinit;\n&#60;/script&#62;\n</pre>\n<p>We define &#34;mom&#34; as the first link within the parent node of the ul we\nare in. (We are at the UL level, one up is the LI, the first A is actually the \nlink that gets clicked to expand or collapse this UL). We check if &#34;mom&#34; exists\nand if that is the case we take the first child node of the A (which is the text),\nand read its value via &#34;nodeValue&#34. Then we add a + in front of it. Voila, \nall links with nested elements have a + in front of them.</p>\n<p>The nice thing is that non Javascript browsers don't even see this, and it \ndoesn't confuse them.</p>\n<p>Now we need to change the function that does the actual collapsing to change\nthis + into a - when the display change happens:</p>\n<pre>\n&#60;script type=&#34;text/javascript&#34;&#62;\nfunction ex(n){\n if(canDOM){\n  u=n.parentNode.getElementsByTagName(&#34;ul&#34;)[0];\n  if(u){\n   u.style.display=(u.style.display=='none'  u.style.display=='')?'block':'none';\n   str=n.firstChild.nodeValue;\n   sign=str.substr(0,1)=='+'?'&#173;':'+';     \n   n.firstChild.nodeValue= sign + str.substr(1,str.length);\n  }\n }   \n}\n&#60;/script&#62;\n</pre>\n<p>We define &#34;str&#34 as the text of the link we just clicked (firstChild is \nthe text, nodeValue is the text data). Then we check if the first character \n(substr(0,1)) is a + and define &#34;sign&#34; as a - or a + accordingly. Remember \nwe added this + via the expinit() function.</p>\n<p>Then we set the nodeValue of the link's text to our new sign followed by the rest \nof the text in the link (substr 1 until the end of the string).</p>\n<h2>You have taken your first step into a larger world...</h2>\n<p>Now we have the script we wanted. We don't need to enhance our HTML with \nany IDs or extra Javascript in the document body. The functionality (and the \nextra text, namely the + and -) only shows up when the browser is capable of \nsupporting it. And it works! Where to go next?</p>\n<p>It might be a bad idea to collapse all nested lists in one document. If \nyou want to prevent that happening, you'll have to either nest the \nnavigation list in a DIV with an ID or to make sure you know the location of the \nlist in the document node tree.</p>\n<p>For the ID solution, replace <code>alluls=document.getElementsByTagName('UL');</code> \nin expinit() with <code>alluls=document.getElementById('yourid').getElementsByTagName('UL');</code>.</p>\n<p>For the known location solution, replace <code>alluls=document.getElementsByTagName('UL');</code> \nin expinit() with <code>alluls=document.getElementsByTagName('UL')[1].getElementsByTagName('UL');</code> \nwhere &#34;1&#34; is the number of the location.</p>\n<p>Also, you might want to add an image as the indicator for collapsed elements,\nor nest the indicator in some other element to add some extra styles.</p>\n<p>If you want a readymade script using this techniques here with some of these\nenhancements, go and download.</p>\n<p><a href="http://www.onlinetools.org/tools/puredom/" title="readymade script using the tricks explained here" target="_blank">pureDom explorer</a></p>\n<p>And look at the source code to see how these changes were implemented.</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
