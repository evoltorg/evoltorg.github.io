<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Asp Breadcrumb Class</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">evolt.org</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Asp Breadcrumb Class</h2>
<p class="meta">02 Sep 2005</p>

<div class="post">
  <h2>Background</h2></p><p><p>\nMy current employer Etelesolv (<a href='http://www.etelesolv.com' target="_blank">www.etelesolv.com</a>) had a client that, as part of their new website, required that required breadcrumb nav.  The project was to use ASP . </p>\n<p>\nI had used the <a href="http://www.baskettcase.com/classes/breadcrumb/" target="_blank"> BreadCrumbs PHP Class</a>, by Richard Baskitt,  for a couple of projects and I wanted to have a class similar to it that would easily implement this type of navigation. The closest thing I could find on the web was <a href='http://www.roselli.org' target="_blank">Adrian Roselli's</a>   <a href="http://www.evolt.org/article/Breadcrumbs_for_Those_Using_ASP/17/4438/" target="_blank"> "Breadcrumbs for Those Using ASP"</a> evolt.org article.\n</p>\n<p>\nSo I proceded to use the Breadcrumb PHP Class model and implement some of Adrien's string manipulation methods with a touch of <a href="http://www.asp101.com" target="_blank">ASP 101</a> for the PCase method, \n to create a reusable piece of code that our developers could use on any of their projects. I now share it with you.... (dramatic reverberation)</p><p></p>\n<p>\nHere is the code:\n<pre>\n&lt;%\n'BreadCrumb Class v1.0\n'Created by Jason Irving Copyright 2005 - pittster@hotmail.com\n'Last Update January 24, 2005\n'This class was heavily influenced by Breadcrumbs PHP Class @ http://www.baskettcase.com/classes/breadcrumb/\n'the build method was inspired by breadcrumb.asp  Version 1.0 by  Adrian Roselli  adrian@roselli.org  @ http://www.evolt.org/article/Breadcrumbs_for_Those_Using_ASP/17/4438/</p><p>'********Properties\n'cssClass : string - css stylesheet class for the &lt;a&gt; tag\n'to separate the style for the delimiter, use the following css syntax example\n' mystyle { color: blue; }\n' mystyle a {color: red; }\n' the delimiter will be in the first style, the link in the second\n'Homepage : string - name of the homepage\n'Uscore2Space : boolean string (1, yes, true) - replace underscores with " " space\n'wordCase : string (mixed, upper, lower) - \n'Delimiter : string - the text delimiter between elements\n'showFiles : boolean string (1, yes, true) - append the name of the viewed file to menu\n'showFilesNoExt: boolean string (1, yes, true) - append the name of the viewed file to menu without extension, overrides showFiles\n'</p><p>'*********Methods\n'build() - print the menu\n'changeName : string tag, string, str - Hashtable of elements and replacement words</p><p>class clsBreadCrumb</p><p>	Private strDelimiter\n	Private dictReplaceWords\n	Private strPath\n	Private strCSSClass\n	Private strHomePage \n	Private bolUscore2Space\n	Private bolShowFiles\n	Private bolShowFilesNoExt\n	Private strCaseFormat\n	\n	Private Sub Class_Initialize()\n	strCSSClass = "" \n	strHomePage = "home" \n	strPath = Request.ServerVariables("PATH_INFO")\n	bolUscore2Space = "1" \n	strCaseFormat = "mixed"\n	bolShowFiles = "1"\n	bolShowFilesNoExt = "0"\n	strDelimiter = ">"\n	set dictReplaceWords = Server.CreateObject("Scripting.Dictionary")\n	End Sub</p><p>	\n	Private Sub Class_Terminate()\n	dictReplaceWords = nothing\n	End Sub</p><p>	'*********Properties*************\n	\n	'*****SET\n	Public Property Let cssClass(str)\n		strCSSClass = " class='" & str & "'"\n	End Property\n	\n	Public Property Let Homepage(str)\n		strHomePage = str\n	End Property\n	\n	Public Property Let showFiles(str)\n		if lcase(trim(str)) = "1" or lcase(trim(str)) = "yes" or lcase(trim(str)) = "true" then\n			bolShowFiles = 1\n		else\n			bolShowFiles = 0\n		end if\n	End Property\n	\n	Public Property Let showFilesNoExt(str)\n		if lcase(trim(str)) = "1" or lcase(trim(str)) = "yes" or lcase(trim(str)) = "true" then\n			bolShowFilesNoExt = 1\n		else\n			bolShowFilesNoExt = 0\n		end if\n	End Property\n	\n	Public Property Let Uscore2Space(str)\n		if lcase(trim(str)) = "1" or lcase(trim(str)) = "yes" or lcase(trim(str)) = "true" then\n			bolUscore2Space = 1\n		else\n			bolUscore2Space = 0\n		end if\n	End Property\n	\n	Public Property Let wordCase(str)\n		if lcase(trim(str)) = "mixed" or lcase(trim(str)) = "upper" or lcase(trim(str)) = "lower" then\n			strCaseFormat = lcase(trim(str))\n		else\n			strCaseFormat = "mixed"\n		end if\n	End Property\n	\n	Public Property Let Delimiter(str)\n		strDelimiter = Server.HTMLEncode(trim(str))\n	End Property\n	</p><p>\n'*********Methods*************</p><p>	Public Function changeName(tag,str)\n		dictReplaceWords.add lcase(tag), lcase(str)\n	End Function\n	\nPublic Function Build()\ndim tmpPath\ndim strTmpPath\ndim DirPath\ndim FullPath\ndim strContent</p><p>FullPath = strPath\nresponse.write ("<span  & strCSSClass & >")</p><p>Do Until instr(1,FullPath,"/") = 0</p><p>	'Split the string on the "/"\n	strTmpPath = Trim(mid(FullPath,1,instr(1,FullPath,"/")-1))\n	DirPath = DirPath & strTmpPath & "/"</p><p>	'Replace the underscore with a space if the option is set\n	\n	if bolUscore2Space = 1 then\n	strTmpPath = Replace(Trim(strTmpPath),"_"," ")\n	end if\n	\n	\n	if dictReplaceWords.exists(lcase(strTmpPath)) then\n	strTmpPath = dictReplaceWords.item(strTmpPath)\n	end if\n	\n	'Apply the appropriate case to the entry\n	\n	'get the next directory	\n	FullPath = mid(FullPath,instr(1,FullPath,"/")+1,Len(FullPath)-Len(tmpPath))\n	\n	'create the filename entry if applicable\n	dim tmpFileName\n	dim tmpFileNameLabel\n	\n	tmpFileName = FullPath\n	\n	if instr(1,tmpFileName,"/") = 0 then\n		if bolShowFilesNoExt = "1" then\n			dim intPos\n			intPos = InStrRev(tmpFileName , ".", -1, 1)\n	    	if intPos > 0 Then\n		        tmpFileNameLabel = Left(tmpFileName , intPos - 1)\n			end if\n		else\n			tmpFileNameLabel = tmpFileName\n		end if\n	else\n		tmpFileName = ""\n	end if\n	\n	select case lcase(strCaseFormat)\n	case "mixed"\n	strTmpPath = PCase(strTmpPath)\n	strHomePage = PCase(strHomePage)\n	case "upper"\n	strTmpPath = UCase(strTmpPath)\n	strHomePage = UCase(strHomePage)\n	case "lower"\n	strTmpPath = LCase(strTmpPath)\n	strHomePage = LCase(strHomePage)\n	case else\n	strTmpPath = PCase(strTmpPath)\n	strHomePage = PCase(strHomePage)\n	end select</p><p>	\n	'add home page link\n	if strTmpPath = "" then\n	response.write "<a href='/'  & strCSSClass & >" & strHomePage & "</a>"\n	else\n		response.write " " & strDelimiter & " <a href="" & DirPath &   & strCSSClass & >" & strTmpPath & "</a>"\n	end if\n	\n	if tmpFileName <> "" then\n		if bolShowFiles = "1" or bolShowFilesNoExt = "1" then\n		response.write " " & strDelimiter & " <a href="" & DirPath & tmpFileName &   & strCSSClass & >" & tmpFileNameLabel & "</a>"\n		end if\n	end if\n	\nLoop\nresponse.write ("</span>")\nEnd Function</p><p></p><p>'************************************************************\n' This function takes a string and converts to Proper Case.\n' Prototyped by: Brian Shamblen on 3/18/99\n' This version by: Us... naturally! - ASP 101\n'************************************************************</p><p>private Function PCase(strInput)\n	Dim iPosition  ' Our current position in the string (First character = 1)\n	Dim iSpace     ' The position of the next space after our iPosition\n	Dim strOutput  ' Our temporary string used to build the function's output</p><p>	' Set our position variable to the start of the string.\n	iPosition = 1\n	\n	' We loop through the string checking for spaces.\n	' If there are unhandled spaces left, we handle them...\n	Do While InStr(iPosition, strInput, " ", 1) <> 0\n		' To begin with, we find the position of the offending space.\n		iSpace = InStr(iPosition, strInput, " ", 1)\n		\n		' We uppercase (and append to our output) the first character after\n		' the space which was handled by the previous run through the loop.\n		strOutput = strOutput & UCase(Mid(strInput, iPosition, 1))\n		\n		' We lowercase (and append to our output) the rest of the string\n		' up to and including the current space.\n		strOutput = strOutput & LCase(Mid(strInput, iPosition + 1, iSpace - iPosition))</p><p>		' Note:\n		' The above line is something you may wish to change to not convert\n		' everything to lowercase.  Currently things like "McCarthy" end up\n		' as "Mccarthy", but if you do change it, it won't fix things like\n		' ALL CAPS.  I don't see an easy compromise so I simply did it the\n		' way I'd expect it to work and the way the VB command\n		' StrConv(string, vbProperCase) works.  Any other functionality is\n		' left "as an exercise for the reader!"\n		\n		' Set our location to start looking for spaces to the\n		' position immediately after the last space.\n		iPosition = iSpace + 1\n	Loop</p><p>	' Because we loop until there are no more spaces, it leaves us\n	' with the last word uncapitalized so we handle that here.\n	' This also takes care of capitalizing single word strings.\n	' It's the same as the two lines inside the loop except the\n	' second line LCase's to the end and not to the next space.\n	strOutput = strOutput & UCase(Mid(strInput, iPosition, 1))\n	strOutput = strOutput & LCase(Mid(strInput, iPosition + 1))</p><p>	' That's it - Set our return value and exit\n	PCase = strOutput\nEnd Function</p><p>end class %&gt;\n</pre></p><p><p>To implement it on a page, simply do the following</p>\n<pre>\n&lt;%\ndim objBreadCrumb\nset objBreadCrumb = new clsBreadCrumb</p><p>'Set a property\nobjBreadCrumb.wordCase = "upper" </p><p>' Changes the instance of a directory called "about" to "about this site"</p><p>objBreadCrumb.changeName("about", "about this site") \nobjBreadCrumb.Build()\n%&gt;\n</pre></p><p><p>Use the guides at the top of the class source code and VOILA! a breadcrumb nav.</p></p><p><p>Enjoy,<br />Jason Irving</p>
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
